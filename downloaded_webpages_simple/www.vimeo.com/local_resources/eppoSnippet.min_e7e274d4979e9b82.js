(()=>{var s,r={135:(e,t,r)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageAssignmentShim=void 0;let n=r(1552);class a{constructor(e){if(this.size=this.getCache().size,this[i]=this.getCache()[Symbol.toStringTag],!(0,n.hasWindowLocalStorage)())throw new Error("LocalStorage is not available");this.localStorageKey="eppo-assignment"+(e?"-"+e:"")}clear(){this.getCache().clear()}delete(e){return this.getCache().delete(e)}forEach(e,t){this.getCache().forEach(e,t)}entries(){return this.getCache().entries()}keys(){return this.getCache().keys()}values(){return this.getCache().values()}[Symbol.iterator](){return this.getCache()[Symbol.iterator]()}has(e){return this.getCache().has(e)}get(e){return null!=(e=this.getCache().get(e))?e:void 0}set(e,t){return this.setCache(this.getCache().set(e,t))}getCache(){var e=window.localStorage.getItem(this.localStorageKey);return e?new Map(JSON.parse(e)):new Map}setCache(e){return window.localStorage.setItem(this.localStorageKey,JSON.stringify(Array.from(e.entries()))),this}}t.LocalStorageAssignmentShim=a,i=Symbol.toStringTag},136:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(2975),n=r(9721);class a{constructor(e){this.name=e,this.eventKeys=[],this.localStorageKey="eventQueue:"+this.name,this.loadStateFromLocalStorage()}splice(e){e=Array.from({length:e},()=>this.shift());return(0,n.takeWhile)(e,e=>void 0!==e)}isEmpty(){return 0===this.length}get length(){return this.eventKeys.length}push(e){var t=this.generateEventKey(e),e=JSON.stringify(e);localStorage.setItem(t,e),this.eventKeys.push(t),this.saveStateToLocalStorage()}*[Symbol.iterator](){for(var e of this.eventKeys){e=localStorage.getItem(e);e&&(yield JSON.parse(e))}}shift(){if(0!==this.eventKeys.length){var e,t=this.eventKeys.shift();if(t)return(e=localStorage.getItem(t))?(localStorage.removeItem(t),this.saveStateToLocalStorage(),JSON.parse(e)):void 0;throw new Error("Unexpected undefined event key")}}loadStateFromLocalStorage(){var e=localStorage.getItem(this.localStorageKey);if(e)try{this.eventKeys=JSON.parse(e)}catch(e){window.EppoVisualEditor.setHideOverlay(!0),i.applicationLogger.error(`Failed to parse event queue ${this.name} state. Initializing empty queue.`),this.eventKeys=[]}}saveStateToLocalStorage(){var e=JSON.stringify(this.eventKeys);localStorage.setItem(this.localStorageKey,e)}generateEventKey(e){e=this.hashEvent(e);return`eventQueue:${this.name}:`+e}hashEvent(e){var t=JSON.stringify(e);let r=0;for(let e=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;return r.toString(36)}}t.default=a},182:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.validate=t.v7=t.v6ToV1=t.v6=t.v5=t.v4=t.v3=t.v1ToV6=t.v1=t.stringify=t.parse=t.NIL=t.MAX=void 0;var i=r(2196),n=(Object.defineProperty(t,"MAX",{enumerable:!0,get:function(){return i.default}}),r(3465)),a=(Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return n.default}}),r(1797)),o=(Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return a.default}}),r(6011)),s=(Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return o.default}}),r(1425)),l=(Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return s.default}}),r(6568)),u=(Object.defineProperty(t,"v1ToV6",{enumerable:!0,get:function(){return l.default}}),r(591)),c=(Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return u.default}}),r(8286)),g=(Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return c.default}}),r(4557)),d=(Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return g.default}}),r(6356)),h=(Object.defineProperty(t,"v6",{enumerable:!0,get:function(){return d.default}}),r(268)),f=(Object.defineProperty(t,"v6ToV1",{enumerable:!0,get:function(){return h.default}}),r(4299)),p=(Object.defineProperty(t,"v7",{enumerable:!0,get:function(){return f.default}}),r(9746)),m=(Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return p.default}}),r(2770));Object.defineProperty(t,"version",{enumerable:!0,get:function(){return m.default}})},204:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OverrideValidator=t.sendValidationRequest=void 0;let i=r(1902);t.sendValidationRequest=async e=>{e=await fetch("https://eppo.cloud/api/flag-overrides/v1/validate-key",{method:"POST",body:JSON.stringify({key:e}),headers:{"Content-Type":"application/json"}});if(200!==e.status)throw new Error("Unable to authorize key: "+e.statusText)},t.OverrideValidator=class{constructor(){this.validKeyCache=new i.TLRUCache(100,18e6)}parseOverridePayload(e){try{var t=JSON.parse(e);return this.validateParsedOverridePayload(t),t}catch(e){throw window.EppoVisualEditor.setHideOverlay(!0),new Error("Unable to parse overridePayload: "+(e?.message??"unknown error"))}}validateParsedOverridePayload(e){if("object"!=typeof e)throw new Error("Expected object, but received "+typeof e);var t=Object.keys(e);if(!t.includes("browserExtensionKey"))throw new Error("Missing required field: 'browserExtensionKey'");if(!t.includes("overrides"))throw new Error("Missing required field: 'overrides'");if("string"!=typeof e.browserExtensionKey)throw new Error("Invalid type for 'browserExtensionKey'. Expected string, but received "+typeof e.browserExtensionKey);if("object"!=typeof e.overrides)throw new Error(`Invalid type for 'overrides'. Expected object, but received ${typeof e.overrides}.`)}async validateKey(e){if("true"===this.validKeyCache.get(e))return!0;await(0,t.sendValidationRequest)(e),this.validKeyCache.set(e,"true")}}},268:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(1797),n=r(6011);t.default=function(e){t="string"==typeof e?(0,i.default)(e):e;var t=Uint8Array.of((15&t[3])<<4|t[4]>>4&15,(15&t[4])<<4|(240&t[5])>>4,(15&t[5])<<4|15&t[6],t[7],(15&t[1])<<4|(240&t[2])>>4,(15&t[2])<<4|(240&t[3])>>4,16|(240&t[0])>>4,(15&t[0])<<4|(240&t[1])>>4,t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]);return"string"==typeof e?(0,n.unsafeStringify)(t):t}},299:e=>{e.exports=JSON.parse('{"name":"@eppo/js-client-sdk","version":"3.13.1","description":"Eppo SDK for client-side JavaScript applications","main":"dist/index.js","files":["/dist","/src","!*.spec.ts"],"types":"dist/index.d.ts","scripts":{"lint":"eslint \'**/*.ts\' --cache","lint:fix":"eslint --fix \'**/*.ts\' --cache","lint:fix-pre-commit":"eslint -c .eslintrc.pre-commit.js --fix \'**/*.ts\' --no-eslintrc --cache","prepare":"make prepare","pre-commit":"lint-staged && tsc && yarn docs","typecheck":"tsc","test":"yarn test:unit","test:unit":"NODE_ENV=test jest \'.*\\\\.spec\\\\.ts\'","docs":"api-documenter markdown -i ./temp -o ./docs"},"jsdelivr":"dist/eppo-sdk.js","repository":{"type":"git","url":"git+https://github.com/Eppo-exp/js-client-sdk.git"},"author":"","license":"MIT","bugs":{"url":"https://github.com/Eppo-exp/js-client-sdk/issues"},"homepage":"https://github.com/Eppo-exp/js-client-sdk#readme","devDependencies":{"@microsoft/api-documenter":"^7.26.3","@microsoft/api-extractor":"^7.48.1","@types/chrome":"^0.0.268","@types/jest":"^29.5.11","@types/spark-md5":"^3.0.5","@typescript-eslint/eslint-plugin":"^5.13.0","@typescript-eslint/parser":"^5.13.0","eslint":"^8.17.0","eslint-config-prettier":"^9.1.0","eslint-import-resolver-typescript":"^3.6.3","eslint-plugin-import":"^2.25.4","eslint-plugin-prettier":"^5.2.1","eslint-plugin-promise":"^7.2.1","husky":"^9.1.7","jest":"^29.7.0","jest-environment-jsdom":"^29.7.0","lint-staged":"^15.4.1","prettier":"^3.4.2","terser-webpack-plugin":"^5.3.3","testdouble":"^3.20.2","ts-jest":"^29.1.1","ts-loader":"^9.3.1","ts-node":"^10.9.2","typescript":"^4.7.4","webpack":"^5.73.0","webpack-cli":"^6.0.1"},"dependencies":{"@eppo/js-client-sdk-common":"4.13.2"},"packageManager":"yarn@1.22.22+sha512.a6b2f7906b721bba3d67d4aff083df04dad64c399707841b7acf00f6b133b7ac24255f2652fa22ae3534329dc6180534e98d17432037ff6fd140556e2bb3137e"}')},318:(e,t)=>{function i(e){return Boolean("object"==typeof e&&e&&"numericAttributes"in e&&"categoricalAttributes"in e)}function n(e){let r={numericAttributes:{},categoricalAttributes:{}};return Object.entries(e).forEach(([e,t])=>{"number"==typeof t?r.numericAttributes[e]=t:r.categoricalAttributes[e]=t}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.isInstanceOfContextualAttributes=i,t.ensureNonContextualSubjectAttributes=function(t){let r;if(i(t)){let e=t;r={...e.numericAttributes,...e.categoricalAttributes}}else r=t;return r},t.ensureContextualSubjectAttributes=function(e){return i(e)?e:n(e)},t.deduceAttributeContext=n,t.ensureActionsWithContextualAttributes=function(e){let r={};return Array.isArray(e)?e.forEach(e=>{r[e]={numericAttributes:{},categoricalAttributes:{}}}):Object.values(e).every(i)?r=e:Object.entries(e).forEach(([e,t])=>{r[e]=n(t)}),r}},338:(e,t)=>{function i(e){return 14+(e+64>>>9<<4)+1}function c(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function s(e,t,r,i,n,a){return c((t=c(c(t,e),c(i,a)))<<n|t>>>32-n,r)}function g(e,t,r,i,n,a,o){return s(t&r|~t&i,e,t,n,a,o)}function d(e,t,r,i,n,a,o){return s(t&i|r&~i,e,t,n,a,o)}function h(e,t,r,i,n,a,o){return s(t^r^i,e,t,n,a,o)}function f(e,t,r,i,n,a,o){return s(r^(t|~i),e,t,n,a,o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=((a,e)=>{let t=new Uint32Array(i(e)).fill(0),o=(t.set(a),t[e>>5]|=128<<e%32,t[t.length-1]=e,a=t,1732584193),s=-271733879,l=-1732584194,u=271733878;for(let n=0;n<a.length;n+=16){let e=o,t=s,r=l,i=u;o=g(o,s,l,u,a[n],7,-680876936),u=g(u,o,s,l,a[n+1],12,-389564586),l=g(l,u,o,s,a[n+2],17,606105819),s=g(s,l,u,o,a[n+3],22,-1044525330),o=g(o,s,l,u,a[n+4],7,-176418897),u=g(u,o,s,l,a[n+5],12,1200080426),l=g(l,u,o,s,a[n+6],17,-1473231341),s=g(s,l,u,o,a[n+7],22,-45705983),o=g(o,s,l,u,a[n+8],7,1770035416),u=g(u,o,s,l,a[n+9],12,-1958414417),l=g(l,u,o,s,a[n+10],17,-42063),s=g(s,l,u,o,a[n+11],22,-1990404162),o=g(o,s,l,u,a[n+12],7,1804603682),u=g(u,o,s,l,a[n+13],12,-40341101),l=g(l,u,o,s,a[n+14],17,-1502002290),s=g(s,l,u,o,a[n+15],22,1236535329),o=d(o,s,l,u,a[n+1],5,-165796510),u=d(u,o,s,l,a[n+6],9,-1069501632),l=d(l,u,o,s,a[n+11],14,643717713),s=d(s,l,u,o,a[n],20,-373897302),o=d(o,s,l,u,a[n+5],5,-701558691),u=d(u,o,s,l,a[n+10],9,38016083),l=d(l,u,o,s,a[n+15],14,-660478335),s=d(s,l,u,o,a[n+4],20,-405537848),o=d(o,s,l,u,a[n+9],5,568446438),u=d(u,o,s,l,a[n+14],9,-1019803690),l=d(l,u,o,s,a[n+3],14,-187363961),s=d(s,l,u,o,a[n+8],20,1163531501),o=d(o,s,l,u,a[n+13],5,-1444681467),u=d(u,o,s,l,a[n+2],9,-51403784),l=d(l,u,o,s,a[n+7],14,1735328473),s=d(s,l,u,o,a[n+12],20,-1926607734),o=h(o,s,l,u,a[n+5],4,-378558),u=h(u,o,s,l,a[n+8],11,-2022574463),l=h(l,u,o,s,a[n+11],16,1839030562),s=h(s,l,u,o,a[n+14],23,-35309556),o=h(o,s,l,u,a[n+1],4,-1530992060),u=h(u,o,s,l,a[n+4],11,1272893353),l=h(l,u,o,s,a[n+7],16,-155497632),s=h(s,l,u,o,a[n+10],23,-1094730640),o=h(o,s,l,u,a[n+13],4,681279174),u=h(u,o,s,l,a[n],11,-358537222),l=h(l,u,o,s,a[n+3],16,-722521979),s=h(s,l,u,o,a[n+6],23,76029189),o=h(o,s,l,u,a[n+9],4,-640364487),u=h(u,o,s,l,a[n+12],11,-421815835),l=h(l,u,o,s,a[n+15],16,530742520),s=h(s,l,u,o,a[n+2],23,-995338651),o=f(o,s,l,u,a[n],6,-198630844),u=f(u,o,s,l,a[n+7],10,1126891415),l=f(l,u,o,s,a[n+14],15,-1416354905),s=f(s,l,u,o,a[n+5],21,-57434055),o=f(o,s,l,u,a[n+12],6,1700485571),u=f(u,o,s,l,a[n+3],10,-1894986606),l=f(l,u,o,s,a[n+10],15,-1051523),s=f(s,l,u,o,a[n+1],21,-2054922799),o=f(o,s,l,u,a[n+8],6,1873313359),u=f(u,o,s,l,a[n+15],10,-30611744),l=f(l,u,o,s,a[n+6],15,-1560198380),s=f(s,l,u,o,a[n+13],21,1309151649),o=f(o,s,l,u,a[n+4],6,-145523070),u=f(u,o,s,l,a[n+11],10,-1120210379),l=f(l,u,o,s,a[n+2],15,718787259),s=f(s,l,u,o,a[n+9],21,-343485551),o=c(o,e),s=c(s,t),l=c(l,r),u=c(u,i)}return Uint32Array.of(o,s,l,u)})((t=>{if(0===t.length)return new Uint32Array;var r=new Uint32Array(i(8*t.length)).fill(0);for(let e=0;e<t.length;e++)r[e>>2]|=(255&t[e])<<e%4*8;return r})(e),8*e.length),r=new Uint8Array(4*t.length);for(let e=0;e<4*t.length;e++)r[e]=t[e>>2]>>>e%4*8&255;return r}},375:(e,t,r)=>{let o=r(4605),s=r(3708);e.exports=(e,t,r)=>{let i=null,n=null,a=null;try{a=new s(t,r)}catch(e){return window.EppoVisualEditor.setHideOverlay(!0),null}return e.forEach(e=>{!a.test(e)||i&&-1!==n.compare(e)||(i=e,n=new o(i,r))}),i}},391:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{attachContext(e,t){}dispatch(e){}}},591:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;let n=r(338),a=r(2988);var i=r(2988);function o(e,t,r,i){return(0,a.default)(48,n.default,e,t,r,i)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return i.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return i.URL}}),o.DNS=a.DNS,o.URL=a.URL,t.default=o},653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HybridConfigurationStore=void 0;let i=r(4742);t.HybridConfigurationStore=class{constructor(e,t){this.servingStore=e,this.persistentStore=t,this.environment=null,this.configFetchedAt=null,this.configPublishedAt=null,this.format=null}async init(){var e;this.persistentStore&&(this.persistentStore.isInitialized()||i.logger.warn(i.loggerPrefix+" Persistent store is not initialized from remote configuration. Serving assignments that may be stale."),e=await this.persistentStore.entries(),this.servingStore.setEntries(e))}isInitialized(){return this.servingStore.isInitialized()&&(this.persistentStore?.isInitialized()??!0)}async isExpired(){return await this.persistentStore?.isExpired()??!0}get(e){return this.servingStore.isInitialized()||i.logger.warn(i.loggerPrefix+" getting a value from a ServingStore that is not initialized."),this.servingStore.get(e)}entries(){return this.servingStore.entries()}getKeys(){return this.servingStore.getKeys()}async setEntries(e){return this.persistentStore&&await this.persistentStore.setEntries(e),this.servingStore.setEntries(e),!0}setEnvironment(e){this.environment=e}getEnvironment(){return this.environment}getConfigFetchedAt(){return this.configFetchedAt}setConfigFetchedAt(e){this.configFetchedAt=e}getConfigPublishedAt(){return this.configPublishedAt}setConfigPublishedAt(e){this.configPublishedAt=e}getFormat(){return this.format}setFormat(e){this.format=e}}},664:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TLRUInMemoryAssignmentCache=void 0;let i=r(6882),n=r(7989),a=r(1902);class o extends n.AbstractAssignmentCache{constructor(e,t=i.DEFAULT_TLRU_TTL_MS){super(new a.TLRUCache(e,t))}}t.TLRUInMemoryAssignmentCache=o},793:e=>{function f(e){try{return JSON.stringify(e)}catch(e){return window.EppoVisualEditor.setHideOverlay(!0),'"[Circular]"'}}e.exports=function(e,t,r){var i=r&&r.stringify||f;if("object"==typeof e&&null!==e){var n=t.length+1;if(1===n)return e;var a=new Array(n);a[0]=i(e);for(var o=1;o<n;o++)a[o]=i(t[o]);return a.join(" ")}if("string"!=typeof e)return e;var s=t.length;if(0===s)return e;for(var l,u="",c=0,g=-1,d=e&&e.length||0,h=0;h<d;){if(37===e.charCodeAt(h)&&h+1<d){switch(g=-1<g?g:0,e.charCodeAt(h+1)){case 100:case 102:s<=c||null!=t[c]&&(g<h&&(u+=e.slice(g,h)),u+=Number(t[c]),g=h+2,h++);break;case 105:s<=c||null!=t[c]&&(g<h&&(u+=e.slice(g,h)),u+=Math.floor(Number(t[c])),g=h+2,h++);break;case 79:case 111:case 106:s<=c||void 0!==t[c]&&(g<h&&(u+=e.slice(g,h)),u+="string"==(l=typeof t[c])?"'"+t[c]+"'":"function"==l?t[c].name||"<anonymous>":i(t[c]),g=h+2,h++);break;case 115:s<=c||(g<h&&(u+=e.slice(g,h)),u+=String(t[c]),g=h+2,h++);break;case 37:g<h&&(u+=e.slice(g,h)),u+="%",g=h+2,h++,c--}++c}++h}return-1===g?e:(g<d&&(u+=e.slice(g)),u)}},802:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.storage=e}async has(e){return!!await this.get(e)}async get(e){var t=await this.storage.get(e);return null!=(t=null==t?void 0:t[e])?t:void 0}async entries(){return this.storage.get(null)}async set(e,t){await this.storage.set({[e]:t})}}},831:e=>{var t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},922:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(8127);t.default=class{decodeEventIngestionUrl(e){var e=e.split(".")[1];return e&&(e=i.Base64.decode(e),e=new URLSearchParams(e).get("eh"))?(e=e.endsWith("/")?e+"v0/i":e+"/v0/i").startsWith("http://")||e.startsWith("https://")?e:"https://"+e:null}}},962:(e,t,r)=>{let i=r(5822);e.exports=(e,t,r)=>i(e,t,">",r)},1103:(e,t,r)=>{let i=r(9043);e.exports=(e,t,r)=>i(e,t,r)<=0},1112:(e,t,r)=>{let i=r(9043);e.exports=(e,t,r)=>0===i(e,t,r)},1147:(e,t,r)=>{let i=r(4605);e.exports=(e,t,r=!1)=>{if(e instanceof i)return e;try{return new i(e,t)}catch(e){if(window.EppoVisualEditor.setHideOverlay(!0),r)throw e;return null}}},1265:(e,_,t)=>{_.ge=_.LR=void 0;let N=t(2975),L=t(7043),R=t(4035),P=t(3983),M=t(1552),D=t(1684),F=t(136),j=t(3142);t(2975),t(6814);var t=(0,M.configurationStorageFactory)({forceMemoryOnly:!0}),r=(0,M.precomputedFlagsStorageFactory)();(0,M.precomputedBanditStoreFactory)(),_.LR={attachContext:()=>{},dispatch:()=>{}};class i extends N.EppoClient{constructor(){super(...arguments),this.initialized=!1}getStringAssignment(e,t,r,i){return this.ensureInitialized(),super.getStringAssignment(e,t,r,i)}getStringAssignmentDetails(e,t,r,i){return this.ensureInitialized(),super.getStringAssignmentDetails(e,t,r,i)}getBoolAssignment(e,t,r,i){return this.getBooleanAssignment(e,t,r,i)}getBooleanAssignment(e,t,r,i){return this.ensureInitialized(),super.getBooleanAssignment(e,t,r,i)}getBooleanAssignmentDetails(e,t,r,i){return this.ensureInitialized(),super.getBooleanAssignmentDetails(e,t,r,i)}getIntegerAssignment(e,t,r,i){return this.ensureInitialized(),super.getIntegerAssignment(e,t,r,i)}getIntegerAssignmentDetails(e,t,r,i){return this.ensureInitialized(),super.getIntegerAssignmentDetails(e,t,r,i)}getNumericAssignment(e,t,r,i){return this.ensureInitialized(),super.getNumericAssignment(e,t,r,i)}getNumericAssignmentDetails(e,t,r,i){return this.ensureInitialized(),super.getNumericAssignmentDetails(e,t,r,i)}getJSONAssignment(e,t,r,i){return this.ensureInitialized(),super.getJSONAssignment(e,t,r,i)}getJSONAssignmentDetails(e,t,r,i){return this.ensureInitialized(),super.getJSONAssignmentDetails(e,t,r,i)}getBanditAction(e,t,r,i,n){return this.ensureInitialized(),super.getBanditAction(e,t,r,i,n)}getBanditActionDetails(e,t,r,i,n){return this.ensureInitialized(),super.getBanditActionDetails(e,t,r,i,n)}getExperimentContainerEntry(e,t,r){return this.ensureInitialized(),super.getExperimentContainerEntry(e,t,r)}ensureInitialized(){this.initialized||N.applicationLogger.warn("Eppo SDK assignment requested before init() completed")}async init(a){var e;let o;N.validation.validateNotBlank(a.apiKey,"API key required");var{apiKey:s,persistentStore:l,baseUrl:u,maxCacheAgeSeconds:c,updateOnFetch:g,requestTimeoutMs:d,numInitialRequestRetries:h,numPollRequestRetries:f,pollingIntervalMs:p,pollAfterSuccessfulInitialization:m=!1,pollAfterFailedInitialization:E=!1,skipInitialRequest:v=!1,eventIngestionConfig:y,enableOverrides:b=!1}=a;try{this.stopPolling(),this.setAssignmentLogger(a.assignmentLogger),a.banditLogger&&this.setBanditLogger(a.banditLogger),this.setIsObfuscated(!0);let e=s.replace(/\W/g,"").substring(0,8),t=(0,M.configurationStorageFactory)({maxAgeSeconds:c,servingStoreUpdateStrategy:g,persistentStore:l,hasChromeStorage:(0,M.hasChromeStorage)(),hasWindowLocalStorage:(0,M.hasWindowLocalStorage)()},{chromeStorage:(0,M.chromeStorageIfAvailable)(),windowLocalStorage:(0,M.localStorageIfAvailable)(),storageKeySuffix:e});if(this.setIsObfuscated(!0),t.setFormat(N.FormatEnum.CLIENT),this.setFlagConfigurationStore(t),b){let e=(0,M.overrideStorageFactory)({hasWindowLocalStorage:(0,M.hasWindowLocalStorage)()},{windowLocalStorage:(0,M.localStorageIfAvailable)(),storageKey:a.overridesStorageKey});this.setOverrideStore(e)}else this.unsetOverrideStore();var S=(0,L.assignmentCacheFactory)({chromeStorage:(0,M.chromeStorageIfAvailable)(),storageKeySuffix:e}),A=(S instanceof R.default&&await S.init(),this.useCustomAssignmentCache(S),{apiKey:s,sdkName:j.sdkName,sdkVersion:j.sdkVersion,baseUrl:u,requestTimeoutMs:d,numInitialRequestRetries:h,numPollRequestRetries:f,pollAfterSuccessfulInitialization:m,pollAfterFailedInitialization:E,pollingIntervalMs:p,throwOnFailedInitialization:!0,skipInitialPoll:v});let r,i;this.setConfigurationRequestParameters(A),this.setEventDispatcher(((e,t={})=>{var{batchSize:t=1e3,deliveryIntervalMs:r=1e4,disabled:i=!1,maxQueueSize:n=1e4,maxRetries:a=3,maxRetryDelayMs:o=3e4,retryIntervalMs:s=5e3}=t;return i?_.LR:(i=(0,M.hasWindowLocalStorage)()?new F.default("events"):new N.BoundedEventQueue("events",[],n),n="undefined"!=typeof window?new D.default:{isOffline:()=>!1,onNetworkStatusChange:()=>{}},(0,N.newDefaultEventDispatcher)(i,n,e,t,{deliveryIntervalMs:r,retryIntervalMs:s,maxRetryDelayMs:o,maxRetries:a}))})(s,y));var O=t.init().then(async()=>{var e;return t.getKeys().length?(e=await t.isExpired())&&!a.useExpiredCache?(N.applicationLogger.warn("Eppo SDK set not to use expired cached configuration"),r=new Error("Configuration store was expired"),P.ConfigLoaderStatus.DID_NOT_PRODUCE):(e&&a.useExpiredCache&&N.applicationLogger.warn("Eppo SDK config.useExpiredCache is true; using expired cache"),P.ConfigLoaderStatus.COMPLETED):(N.applicationLogger.warn("Eppo SDK cached configuration is empty"),r=new Error("Configuration store was empty"),P.ConfigLoaderStatus.DID_NOT_PRODUCE)}).catch(e=>(N.applicationLogger.warn("Eppo SDK encountered an error initializing from the configuration store",e),r=e,P.ConfigLoaderStatus.FAILED)).then(e=>({source:P.ConfigSource.CONFIG_STORE,result:e})),C=this.fetchFlagConfigurations().then(()=>t.isInitialized()?P.ConfigLoaderStatus.COMPLETED:P.ConfigLoaderStatus.DID_NOT_PRODUCE).catch(e=>(N.applicationLogger.warn("Eppo SDK encountered an error initializing from fetching",e),i=e,P.ConfigLoaderStatus.FAILED)).then(e=>({source:P.ConfigSource.FETCH,result:e})),w=[O];let n;a.skipInitialRequest||w.push(C);var{source:I,result:T}=await Promise.race(w);if(T===P.ConfigLoaderStatus.COMPLETED)n=I;else{let e=I===P.ConfigSource.FETCH?O:C;n=await e.then(e=>{var{source:e,result:t}=e;return t===P.ConfigLoaderStatus.COMPLETED?e:P.ConfigSource.NONE})}n===P.ConfigSource.NONE&&(o=i||r||new Error("Eppo SDK: No configuration source produced a valid configuration")),N.applicationLogger.debug("Initialization source",n)}catch(a){o=a instanceof Error?a:new Error(String(a))}if(o&&(N.applicationLogger.warn("Eppo SDK was unable to initialize with a configuration, assignment calls will return the default value and not be logged"+(a.pollAfterFailedInitialization?" until an experiment configuration is successfully retrieved":"")),null==(e=a.throwOnFailedInitialization)||e))throw o;return this.initialized=!0,this}offlineInit(r){var e,t,i=null!=(n=r.isObfuscated)&&n,n=null==(e=r.throwOnFailedInitialization)||e,a=null!=(t=r.enableOverrides)&&t;try{let e=(0,M.configurationStorageFactory)({forceMemoryOnly:!0});if(e.setFormat(i?N.FormatEnum.CLIENT:N.FormatEnum.SERVER),e.setEntries(r.flagsConfiguration).catch(e=>N.applicationLogger.warn("Error setting flags for memory-only configuration store",e)),this.setFlagConfigurationStore(e),a){let e=(0,M.overrideStorageFactory)({hasWindowLocalStorage:(0,M.hasWindowLocalStorage)()},{windowLocalStorage:(0,M.localStorageIfAvailable)(),storageKey:r.overridesStorageKey});this.setOverrideStore(e)}else this.unsetOverrideStore();this.setIsObfuscated(i),r.assignmentLogger&&this.setAssignmentLogger(r.assignmentLogger),r.banditLogger&&this.setBanditLogger(r.banditLogger);let t=(0,L.assignmentCacheFactory)({storageKeySuffix:"offline",forceMemoryOnly:!0});this.useCustomAssignmentCache(t)}catch(r){if(N.applicationLogger.warn("Eppo SDK encountered an error initializing, assignment calls will return the default value and not be logged"),n)throw r}this.initialized=!0}}i.instance=new i({flagConfigurationStore:t,isObfuscated:!0}),i.initialized=!1,_.ge=function(e){var t=i.instance;return t.offlineInit(e),i.initialized=!0,t};class n extends N.EppoPrecomputedClient{getStringAssignment(e,t){return n.getAssignmentInitializationCheck(),super.getStringAssignment(e,t)}getBooleanAssignment(e,t){return n.getAssignmentInitializationCheck(),super.getBooleanAssignment(e,t)}getIntegerAssignment(e,t){return n.getAssignmentInitializationCheck(),super.getIntegerAssignment(e,t)}getNumericAssignment(e,t){return n.getAssignmentInitializationCheck(),super.getNumericAssignment(e,t)}getJSONAssignment(e,t){return n.getAssignmentInitializationCheck(),super.getJSONAssignment(e,t)}getBanditAction(e,t){return n.getAssignmentInitializationCheck(),super.getBanditAction(e,t)}static getAssignmentInitializationCheck(){i.initialized||N.applicationLogger.warn("Eppo SDK assignment requested before init() completed")}}n.instance=new n({precomputedFlagStore:r,subject:{subjectKey:"",subjectAttributes:{}}}),n.initialized=!1},1291:(e,t,r)=>{let i=r(9043);e.exports=(e,t,r)=>i(t,e,r)},1425:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateV1State=void 0;let o=r(2291),s=r(6011),l={};function u(e,t,r){return e.msecs??=-1/0,e.nsecs??=0,t===e.msecs?(e.nsecs++,1e4<=e.nsecs&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=r.slice(10,16),e.node[0]|=1,e.clockseq=16383&(r[8]<<8|r[9])),e.msecs=t,e}function c(e,t,r,i,n,a,o=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(a){if(o<0||o+16>a.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`)}else a=new Uint8Array(16),o=0;t??=Date.now(),r??=0,i??=16383&(e[8]<<8|e[9]),n??=e.slice(10,16);e=(1e4*(268435455&(t+=122192928e5))+r)%4294967296,a[o++]=e>>>24&255,a[o++]=e>>>16&255,a[o++]=e>>>8&255,a[o++]=255&e,r=t/4294967296*1e4&268435455;a[o++]=r>>>8&255,a[o++]=255&r,a[o++]=r>>>24&15|16,a[o++]=r>>>16&255,a[o++]=i>>>8|128,a[o++]=255&i;for(let e=0;e<6;++e)a[o++]=n[e];return a}t.updateV1State=u,t.default=function(t,r,i){let n;var a=t?._v6??!1;if(t){let e=Object.keys(t);1===e.length&&"_v6"===e[0]&&(t=void 0)}if(t)n=c(t.random??t.rng?.()??(0,o.default)(),t.msecs,t.nsecs,t.clockseq,t.node,r,i);else{let e=Date.now(),t=(0,o.default)();u(l,e,t),n=c(t,l.msecs,l.nsecs,a?void 0:l.clockseq,a?void 0:l.node,r,i)}return r??(0,s.unsafeStringify)(n)}},1461:e=>{e.exports=JSON.parse('{"name":"@eppo/js-client-sdk-common","version":"4.13.2","description":"Common library for Eppo JavaScript SDKs (web, react native, and node)","main":"dist/index.js","files":["/dist","/src","!*.spec.ts"],"types":"./dist/index.d.ts","engines":{"node":">=18.x"},"exports":{".":{"types":"./dist/index.d.ts","default":"./dist/index.js"}},"scripts":{"lint":"eslint \'**/*.{ts,tsx}\' --cache","lint:fix":"eslint --fix \'**/*.{ts,tsx}\' --cache","lint:fix-pre-commit":"eslint -c .eslintrc.pre-commit.js --fix \'**/*.{ts,tsx}\' --no-eslintrc --cache","prepare":"make prepare","pre-commit":"lint-staged && tsc","typecheck":"tsc","test":"yarn test:unit","test:unit":"NODE_ENV=test jest \'.*\\\\.spec\\\\.ts\'","obfuscate-mock-ufc":"ts-node test/writeObfuscatedMockUFC"},"jsdelivr":"dist/eppo-sdk.js","repository":{"type":"git","url":"git+https://github.com/Eppo-exp/js-client-sdk-common.git"},"author":"","license":"MIT","bugs":{"url":"https://github.com/Eppo-exp/js-client-sdk-common/issues"},"homepage":"https://github.com/Eppo-exp/js-client-sdk-common#readme","devDependencies":{"@types/jest":"^29.5.11","@types/js-base64":"^3.3.1","@types/lodash":"^4.17.5","@types/semver":"^7.5.6","@types/spark-md5":"^3.0.5","@types/uuid":"^10.0.0","@typescript-eslint/eslint-plugin":"^5.13.0","@typescript-eslint/parser":"^5.13.0","eslint":"^8.17.0","eslint-config-prettier":"^10.0.1","eslint-import-resolver-typescript":"^3.7.0","eslint-plugin-import":"^2.25.4","eslint-plugin-prettier":"5.2.3","eslint-plugin-promise":"^7.2.1","eslint-plugin-unused-imports":"^4.1.4","jest":"^29.7.0","jest-environment-jsdom":"^29.7.0","lodash":"^4.17.21","prettier":"^3.4.2","prettier-eslint":"^16.3.0","terser-webpack-plugin":"^5.3.3","testdouble":"^3.20.1","ts-jest":"^29.1.1","ts-loader":"^9.3.1","ts-node":"^10.9.1","typescript":"^5.7.2","webpack":"^5.73.0","webpack-cli":"^6.0.1"},"dependencies":{"buffer":"npm:@eppo/buffer@6.2.0","js-base64":"^3.7.7","pino":"^9.5.0","semver":"^7.5.4","spark-md5":"^3.0.2","uuid":"^11.0.5"},"packageManager":"yarn@1.22.22+sha512.a6b2f7906b721bba3d67d4aff083df04dad64c399707841b7acf00f6b133b7ac24255f2652fa22ae3534329dc6180534e98d17432037ff6fd140556e2bb3137e"}')},1479:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(2975);t.default=class{constructor(){this.store=new Map,this.cache=new i.NonExpiringInMemoryAssignmentCache(this.store)}set(e){this.cache.set(e)}has(e){return this.cache.has(e)}setEntries(e){let r=this.store;e.forEach(([e,t])=>r.set(e,t))}getEntries(){return Promise.resolve(Array.from(this.cache.entries()))}}},1552:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.localStorageIfAvailable=t.hasWindowLocalStorage=t.chromeStorageIfAvailable=t.hasChromeStorage=t.overrideStorageFactory=t.configurationStorageFactory=t.precomputedBanditStoreFactory=t.precomputedFlagsStorageFactory=void 0;let u=r(2975),c=r(802),g=r(6814),d=r(2557),h=r(7309),a=r(4406),f=r(7029);function i(){return"undefined"!=typeof chrome&&!!chrome.storage}function n(){try{return"undefined"!=typeof window&&!!window.localStorage}catch(e){return!1}}t.precomputedFlagsStorageFactory=function(){return new u.MemoryOnlyConfigurationStore},t.precomputedBanditStoreFactory=function(){return new u.MemoryOnlyConfigurationStore},t.configurationStorageFactory=function({maxAgeSeconds:t=0,servingStoreUpdateStrategy:r="always",hasChromeStorage:e=!1,hasWindowLocalStorage:i=!1,persistentStore:n,forceMemoryOnly:a=!1},{chromeStorage:o,windowLocalStorage:s,storageKeySuffix:l}={}){if(!a){if(n)return new d.IsolatableHybridConfigurationStore(new u.MemoryStore,n,r);if(e&&o){let e=new g.ChromeStorageEngine(new c.default(o),null!=l?l:"");return new d.IsolatableHybridConfigurationStore(new u.MemoryStore,new f.StringValuedAsyncStore(e,t),r)}if(i&&s){let e=new h.LocalStorageEngine(s,null!=l?l:"");return new d.IsolatableHybridConfigurationStore(new u.MemoryStore,new f.StringValuedAsyncStore(e,t),r)}}return new u.MemoryOnlyConfigurationStore},t.overrideStorageFactory=function({hasWindowLocalStorage:e=!1,forceMemoryOnly:t=!1},{windowLocalStorage:r,storageKey:i=a.OVERRIDES_KEY}={}){var n=new u.MemoryStore;if(!t&&e&&r){let t=r.getItem(i);if(t){let e=JSON.parse(t);n.setEntries(e)}}return n},t.hasChromeStorage=i,t.chromeStorageIfAvailable=function(){return i()?chrome.storage.local:void 0},t.hasWindowLocalStorage=n,t.localStorageIfAvailable=function(){return n()?window.localStorage:void 0}},1565:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.eventQueue=e,this.batchSize=Math.max(100,Math.min(1e4,t))}nextBatch(){return this.eventQueue.splice(this.batchSize)}push(...e){this.eventQueue.push(...e)}isEmpty(){return this.eventQueue.isEmpty()}}},1650:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decodeFlag=function(e){return{...e,variations:a(e.variations,e.variationType),allocations:e.allocations.map(s)}},t.decodeVariations=a,t.decodeValue=o,t.decodeAllocation=s,t.decodeSplit=l,t.decodeShard=u,t.decodeObject=c,t.decodeObjectTo=g,t.decodePrecomputedFlag=function(e){return{...e,allocationKey:(0,n.decodeBase64)(e.allocationKey??""),variationKey:(0,n.decodeBase64)(e.variationKey??""),variationValue:o(e.variationValue,e.variationType),extraLogging:c(e.extraLogging??{})}},t.decodePrecomputedBandit=function(e){return{...e,banditKey:(0,n.decodeBase64)(e.banditKey),action:(0,n.decodeBase64)(e.action),modelVersion:(0,n.decodeBase64)(e.modelVersion),actionNumericAttributes:g(e.actionNumericAttributes??{},e=>+e),actionCategoricalAttributes:c(e.actionCategoricalAttributes??{})}};let i=r(4619),n=r(6092);function a(e,r){return Object.fromEntries(Object.entries(e).map(([,e])=>{var t=(0,n.decodeBase64)(e.key);return[t,{key:t,value:o(e.value,r)}]}))}function o(e,t){switch(t){case i.VariationType.INTEGER:case i.VariationType.NUMERIC:return Number((0,n.decodeBase64)(e));case i.VariationType.BOOLEAN:return"true"===(0,n.decodeBase64)(e);default:return(0,n.decodeBase64)(e)}}function s(e){return{...e,key:(0,n.decodeBase64)(e.key),splits:e.splits.map(l),startAt:e.startAt?new Date((0,n.decodeBase64)(e.startAt)).toISOString():void 0,endAt:e.endAt?new Date((0,n.decodeBase64)(e.endAt)).toISOString():void 0}}function l(e){return{extraLogging:e.extraLogging?c(e.extraLogging):void 0,variationKey:(0,n.decodeBase64)(e.variationKey),shards:e.shards.map(u)}}function u(e){return{...e,salt:(0,n.decodeBase64)(e.salt)}}function c(e){return g(e,e=>e)}function g(e,r){return Object.fromEntries(Object.entries(e).map(([e,t])=>[(0,n.decodeBase64)(e),r((0,n.decodeBase64)(t))]))}},1684:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){if(this.listeners=[],this.debounceTimer=null,"undefined"==typeof window)throw new Error("BrowserNetworkStatusListener can only be used in a browser environment");this._isOffline="boolean"==typeof navigator.onLine&&!navigator.onLine,window.addEventListener("offline",()=>this.notifyListeners(!0)),window.addEventListener("online",()=>this.notifyListeners(!1))}isOffline(){return this._isOffline}onNetworkStatusChange(e){this.listeners.push(e)}removeNetworkStatusChange(e){e=this.listeners.indexOf(e);-1!==e&&this.listeners.splice(e,1)}notifyListeners(t){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this._isOffline=t,[...this.listeners].forEach(e=>e(t))},200)}}},1721:(e,t,r)=>{r=r(5606),r="object"==typeof r&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=r},1726:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageAssignmentCache=void 0;let i=r(2975),n=r(135);class a extends i.AbstractAssignmentCache{constructor(e){super(new n.LocalStorageAssignmentShim(e))}setEntries(e){e.forEach(([e,t])=>{e&&t&&this.delegate.set(e,t)})}getEntries(){return Promise.resolve(Array.from(this.entries()))}}t.LocalStorageAssignmentCache=a},1797:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(9746);t.default=function(e){var t;if((0,i.default)(e))return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,255&t,(t=parseInt(e.slice(9,13),16))>>>8,255&t,(t=parseInt(e.slice(14,18),16))>>>8,255&t,(t=parseInt(e.slice(19,23),16))>>>8,255&t,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,255&t);throw TypeError("Invalid UUID")}},1902:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TLRUCache=void 0;r=r(3040);class i extends r.LRUCache{constructor(e,t){super(e),this.maxSize=e,this.ttl=t,this.cacheEntriesTTLRegistry=new Map}getCacheEntryEvictionTime(){return new Date(Date.now()+this.ttl)}clearCacheEntryEvictionTimeIfExists(e){this.cacheEntriesTTLRegistry.has(e)&&this.cacheEntriesTTLRegistry.delete(e)}isCacheEntryValid(e){var t=new Date(Date.now()),e=this.cacheEntriesTTLRegistry.get(e);return void 0!==e&&t<e}setCacheEntryEvictionTime(e){this.cacheEntriesTTLRegistry.set(e,this.getCacheEntryEvictionTime())}resetCacheEntryEvictionTime(e){this.clearCacheEntryEvictionTimeIfExists(e),this.setCacheEntryEvictionTime(e)}evictExpiredCacheEntries(){let e;for(e of this.cache.keys()){if(this.isCacheEntryValid(e))break;this.delete(e)}}entries(){return this.evictExpiredCacheEntries(),super.entries()}keys(){return this.evictExpiredCacheEntries(),super.keys()}values(){return this.evictExpiredCacheEntries(),super.values()}delete(e){return this.clearCacheEntryEvictionTimeIfExists(e),super.delete(e)}has(e){return this.isCacheEntryValid(e)?this.cache.has(e):(this.delete(e),!1)}get(e){var t;if(this.isCacheEntryValid(e))return void 0!==(t=super.get(e))&&this.resetCacheEntryEvictionTime(e),t;this.delete(e)}set(e,t){t=super.set(e,t);return this.resetCacheEntryEvictionTime(e),t}}t.TLRUCache=i},1948:(e,t,r)=>{let n=r(1112),a=r(2180),o=r(3033),s=r(6330),l=r(7686),u=r(1103);e.exports=(e,t,r,i)=>{switch(t){case"===":return(e="object"==typeof e?e.version:e)===(r="object"==typeof r?r.version:r);case"!==":return(e="object"==typeof e?e.version:e)!==(r="object"==typeof r?r.version:r);case"":case"=":case"==":return n(e,r,i);case"!=":return a(e,r,i);case">":return o(e,r,i);case">=":return s(e,r,i);case"<":return l(e,r,i);case"<=":return u(e,r,i);default:throw new TypeError("Invalid operator: "+t)}}},2034:(e,t,r)=>{let i=r(4605);e.exports=(e,t,r)=>{e=new i(e,r),t=new i(t,r);return e.compare(t)||e.compareBuild(t)}},2091:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StoreBackedConfiguration=void 0;let n=r(3720),i=r(6882);t.StoreBackedConfiguration=class{constructor(e,t,r){this.flagConfigurationStore=e,this.banditVariationConfigurationStore=t,this.banditModelConfigurationStore=r}async hydrateConfigurationStores(e,t,r){var e=await(0,n.hydrateConfigurationStore)(this.flagConfigurationStore,e),i=[];return this.banditVariationConfigurationStore&&t&&i.push((0,n.hydrateConfigurationStore)(this.banditVariationConfigurationStore,t)),this.banditModelConfigurationStore&&r&&i.push((0,n.hydrateConfigurationStore)(this.banditModelConfigurationStore,r)),await Promise.all(i),e}getBandit(e){return this.banditModelConfigurationStore?.get(e)??null}getFlagVariationBandit(e,t){e=(this.banditVariationConfigurationStore?.get(e))?.find(e=>e.variationValue===t)?.key;return e?this.getBandit(e):null}getFlag(e){return this.flagConfigurationStore.get(e)??null}getFlagConfigDetails(){return{configFetchedAt:this.flagConfigurationStore.getConfigFetchedAt()??"",configPublishedAt:this.flagConfigurationStore.getConfigPublishedAt()??"",configEnvironment:this.flagConfigurationStore.getEnvironment()??{name:""},configFormat:this.flagConfigurationStore.getFormat()??""}}getFlagBanditVariations(e){return this.banditVariationConfigurationStore?.get(e)??[]}getFlagKeys(){return this.flagConfigurationStore.getKeys()}getFlags(){return this.flagConfigurationStore.entries()}isObfuscated(){return i.OBFUSCATED_FORMATS.includes(this.getFlagConfigDetails().configFormat??"SERVER")}isInitialized(){return this.flagConfigurationStore.isInitialized()&&(!this.banditVariationConfigurationStore||this.banditVariationConfigurationStore.isInitialized())&&(!this.banditModelConfigurationStore||this.banditModelConfigurationStore.isInitialized())}getBandits(){return this.banditModelConfigurationStore?.entries()??{}}getBanditVariations(){return this.banditVariationConfigurationStore?.entries()??{}}}},2094:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LRUInMemoryAssignmentCache=void 0;let i=r(7989),n=r(3040);class a extends i.AbstractAssignmentCache{constructor(e){super(new n.LRUCache(e))}}t.LRUInMemoryAssignmentCache=a},2156:(e,t,r)=>{let i=r(1147);e.exports=(e,t)=>{e=i(e,t);return e&&e.prerelease.length?e.prerelease:null}},2180:(e,t,r)=>{let i=r(9043);e.exports=(e,t,r)=>0!==i(e,t,r)},2196:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default="ffffffff-ffff-ffff-ffff-ffffffffffff"},2291:(e,t)=>{let r,i=(Object.defineProperty(t,"__esModule",{value:!0}),new Uint8Array(16));t.default=function(){if(!r){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");r=crypto.getRandomValues.bind(crypto)}return r(i)}},2381:(e,t,r)=>{let a=r(1147);e.exports=(e,t)=>{var e=a(e,null,!0),t=a(t,null,!0),r=e.compare(t);if(0===r)return null;var r=0<r,i=r?e:t,r=r?t:e,n=!!i.prerelease.length;if(r.prerelease.length&&!n){if(!r.patch&&!r.minor)return"major";if(0===r.compareMain(i))return r.minor&&!r.patch?"minor":"patch"}i=n?"pre":"";return e.major!==t.major?i+"major":e.minor!==t.minor?i+"minor":e.patch!==t.patch?i+"patch":"prerelease"}},2415:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(2975),n=r(802);t.default=class{constructor(e){this.storage=new n.default(e)}set(e){this.storage.set((0,i.assignmentCacheKeyToString)(e),(0,i.assignmentCacheValueToString)(e))}has(e){throw new Error("This should never be called for ChromeStorageAssignmentCache, use getEntries() instead.")}async getEntries(){var e=await this.storage.entries();return Object.entries(e).map(([e,t])=>[e,t])}}},2557:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IsolatableHybridConfigurationStore=void 0;r=r(2975);class i extends r.HybridConfigurationStore{constructor(e,t,r="always"){super(e,t),this.servingStoreUpdateStrategy=r}async setEntries(e){this.persistentStore&&await this.persistentStore.setEntries(e);var t=!this.persistentStore||await this.persistentStore.isExpired(),r=!(null!=(r=this.servingStore.getKeys())&&r.length),t="always"===this.servingStoreUpdateStrategy||t&&"expired"===this.servingStoreUpdateStrategy||t&&r;return t&&this.servingStore.setEntries(e),t}}t.IsolatableHybridConfigurationStore=i},2770:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(9746);t.default=function(e){if((0,i.default)(e))return parseInt(e.slice(14,15),16);throw TypeError("Invalid UUID")}},2787:(e,t,r)=>{let i=r(3708);e.exports=(e,t)=>{try{return new i(e,t).range||"*"}catch(e){return null}}},2802:(e,t,r)=>{let i=r(1147);e.exports=(e,t)=>{e=i(e,t);return e?e.version:null}},2829:(e,t)=>{function g(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(i){let u=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520],t=new Uint8Array(i.length+1),r=(t.set(i),t[i.length]=128,(i=t).length/4+2),n=Math.ceil(r/16),c=new Array(n);for(let r=0;r<n;++r){let t=new Uint32Array(16);for(let e=0;e<16;++e)t[e]=i[64*r+4*e]<<24|i[64*r+4*e+1]<<16|i[64*r+4*e+2]<<8|i[64*r+4*e+3];c[r]=t}c[n-1][14]=8*(i.length-1)/Math.pow(2,32),c[n-1][14]=Math.floor(c[n-1][14]),c[n-1][15]=8*(i.length-1)&4294967295;for(let t=0;t<n;++t){let i=new Uint32Array(80);for(let e=0;e<16;++e)i[e]=c[t][e];for(let e=16;e<80;++e)i[e]=g(i[e-3]^i[e-8]^i[e-14]^i[e-16],1);let n=e[0],a=e[1],o=e[2],s=e[3],l=e[4];for(let r=0;r<80;++r){let e=Math.floor(r/20),t=g(n,5)+((e,t,r,i)=>{switch(e){case 0:return t&r^~t&i;case 1:case 3:return t^r^i;case 2:return t&r^t&i^r&i}})(e,a,o,s)+l+u[e]+i[r]>>>0;l=s,s=o,o=g(a,30)>>>0,a=n,n=t}e[0]=e[0]+n>>>0,e[1]=e[1]+a>>>0,e[2]=e[2]+o>>>0,e[3]=e[3]+s>>>0,e[4]=e[4]+l>>>0}return Uint8Array.of(e[0]>>24,e[0]>>16,e[0]>>8,e[0],e[1]>>24,e[1]>>16,e[1]>>8,e[1],e[2]>>24,e[2]>>16,e[2]>>8,e[2],e[3]>>24,e[3]>>16,e[3]>>8,e[3],e[4]>>24,e[4]>>16,e[4]>>8,e[4])}},2975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildStorageKeySuffix=t.decodePrecomputedFlag=t.DefaultEventDispatcher=t.BatchEventProcessor=t.newDefaultEventDispatcher=t.DEFAULT_EVENT_DISPATCHER_BATCH_SIZE=t.DEFAULT_EVENT_DISPATCHER_CONFIG=t.BoundedEventQueue=t.FormatEnum=t.VariationType=t.assignmentCacheValueToString=t.assignmentCacheKeyToString=t.LRUInMemoryAssignmentCache=t.NonExpiringInMemoryAssignmentCache=t.MemoryOnlyConfigurationStore=t.HybridConfigurationStore=t.MemoryStore=t.EppoPrecomputedClient=t.validation=t.HttpClient=t.FlagConfigRequestor=t.ApiEndpoints=t.constants=t.EppoClient=t.EppoAssignmentLogger=t.AbstractAssignmentCache=t.applicationLogger=t.loggerPrefix=void 0;var i=r(4620);t.ApiEndpoints=i.default;let n=r(4742),a=(Object.defineProperty(t,"applicationLogger",{enumerable:!0,get:function(){return n.logger}}),Object.defineProperty(t,"loggerPrefix",{enumerable:!0,get:function(){return n.loggerPrefix}}),r(7989)),o=(Object.defineProperty(t,"AbstractAssignmentCache",{enumerable:!0,get:function(){return a.AbstractAssignmentCache}}),Object.defineProperty(t,"assignmentCacheKeyToString",{enumerable:!0,get:function(){return a.assignmentCacheKeyToString}}),Object.defineProperty(t,"assignmentCacheValueToString",{enumerable:!0,get:function(){return a.assignmentCacheValueToString}}),r(2094)),s=(Object.defineProperty(t,"LRUInMemoryAssignmentCache",{enumerable:!0,get:function(){return o.LRUInMemoryAssignmentCache}}),r(9851));Object.defineProperty(t,"NonExpiringInMemoryAssignmentCache",{enumerable:!0,get:function(){return s.NonExpiringInMemoryAssignmentCache}});i=r(8475),t.EppoClient=i.default,i=r(3650),t.EppoPrecomputedClient=i.default,i=r(4224);t.FlagConfigRequestor=i.default;let l=r(653),u=(Object.defineProperty(t,"HybridConfigurationStore",{enumerable:!0,get:function(){return l.HybridConfigurationStore}}),r(9864));Object.defineProperty(t,"MemoryStore",{enumerable:!0,get:function(){return u.MemoryStore}}),Object.defineProperty(t,"MemoryOnlyConfigurationStore",{enumerable:!0,get:function(){return u.MemoryOnlyConfigurationStore}});i=r(6882);t.constants=i;let c=r(1650),g=(Object.defineProperty(t,"decodePrecomputedFlag",{enumerable:!0,get:function(){return c.decodePrecomputedFlag}}),r(9182));Object.defineProperty(t,"EppoAssignmentLogger",{enumerable:!0,get:function(){return g.EppoAssignmentLogger}});i=r(1565);t.BatchEventProcessor=i.default;let d=r(6615),h=(Object.defineProperty(t,"BoundedEventQueue",{enumerable:!0,get:function(){return d.BoundedEventQueue}}),r(5299));t.DefaultEventDispatcher=h.default,Object.defineProperty(t,"DEFAULT_EVENT_DISPATCHER_CONFIG",{enumerable:!0,get:function(){return h.DEFAULT_EVENT_DISPATCHER_CONFIG}}),Object.defineProperty(t,"DEFAULT_EVENT_DISPATCHER_BATCH_SIZE",{enumerable:!0,get:function(){return h.DEFAULT_EVENT_DISPATCHER_BATCH_SIZE}}),Object.defineProperty(t,"newDefaultEventDispatcher",{enumerable:!0,get:function(){return h.newDefaultEventDispatcher}});i=r(7059);t.HttpClient=i.default;let f=r(4619),p=(Object.defineProperty(t,"VariationType",{enumerable:!0,get:function(){return f.VariationType}}),Object.defineProperty(t,"FormatEnum",{enumerable:!0,get:function(){return f.FormatEnum}}),r(6092));Object.defineProperty(t,"buildStorageKeySuffix",{enumerable:!0,get:function(){return p.buildStorageKeySuffix}});i=r(4388);t.validation=i},2988:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=t.stringToBytes=void 0;let l=r(1797),u=r(6011);function c(t){t=unescape(encodeURIComponent(t));var r=new Uint8Array(t.length);for(let e=0;e<t.length;++e)r[e]=t.charCodeAt(e);return r}t.stringToBytes=c,t.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",t.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",t.default=function(e,t,r,i,n,a){var r="string"==typeof r?c(r):r,o="string"==typeof i?(0,l.default)(i):i;if(16!==(i="string"==typeof i?(0,l.default)(i):i)?.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+r.length);if(s.set(o),s.set(r,o.length),(s=t(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,n){a=a||0;for(let e=0;e<16;++e)n[a+e]=s[e];return n}return(0,u.unsafeStringify)(s)}},3033:(e,t,r)=>{let i=r(9043);e.exports=(e,t,r)=>0<i(e,t,r)},3040:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=void 0;class r{constructor(e){this.capacity=e,this.cache=new Map,this.size=this.cache.size}[(Symbol.toStringTag,Symbol.iterator)](){return this.cache[Symbol.iterator]()}forEach(e,t){this.cache.forEach(e,t)}entries(){return this.cache.entries()}clear(){this.cache.clear()}delete(e){return this.cache.delete(e)}keys(){return this.cache.keys()}values(){return this.cache.values()}has(e){return this.cache.has(e)}get(e){var t;if(this.has(e))return void 0!==(t=this.cache.get(e))&&(this.delete(e),this.cache.set(e,t)),t}set(e,t){if(0!==this.capacity){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.capacity){let e=this.cache.keys().next().value;e&&this.delete(e)}this.cache.set(e,t)}return this}}t.LRUCache=r},3142:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sdkName=t.sdkVersion=void 0;r=r(299);t.sdkVersion=r.version,t.sdkName="js-client-sdk"},3454:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let n=r(4742);t.default=class{constructor(e,t){this.sdkKey=e,this.ingestionUrl=t}async deliver(e,t){try{n.logger.info(`[EventDispatcher] Delivering batch of ${e.length} events to ${this.ingestionUrl}...`);var r=await fetch(this.ingestionUrl,{method:"POST",headers:{"Content-Type":"application/json","x-eppo-token":this.sdkKey},body:JSON.stringify({eppo_events:e,context:t})});return r.ok?await this.parseFailedEvents(r,e):{failedEvents:e}}catch(t){return n.logger.warn("Failed to upload event batch",t),{failedEvents:e}}}async parseFailedEvents(e,t){n.logger.info("[EventDispatcher] Batch delivered successfully.");let r=await e.json(),i=new Set(r?.failed_events||[]);return 0<i.size?(n.logger.warn(`[EventDispatcher] ${i.size}/${t.length} events failed ingestion.`),{failedEvents:t.filter(({uuid:e})=>i.has(e))}):{failedEvents:[]}}}},3465:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default="00000000-0000-0000-0000-000000000000"},3585:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BanditEvaluator=void 0;let i=r(6882),n=r(8807);t.BanditEvaluator=class{constructor(){this.assignmentShards=i.BANDIT_ASSIGNMENT_SHARDS,this.sharder=new n.MD5Sharder}evaluateBestBanditAction(e,t,r){e=this.scoreActions(e,t,r),t=this.getTopScore(e).topAction;return t}evaluateBandit(e,t,r,i,n){var a=this.scoreActions(r,i,n),o=this.weighActions(a,n.gamma,n.actionProbabilityFloor),s=this.selectAction(e,t,o),l=Object.values(a).reduce((e,t)=>e<t?t:e,-1/0)-a[s];return{flagKey:e,subjectKey:t,subjectAttributes:r,actionKey:s,actionAttributes:i[s],actionScore:a[s],actionWeight:o[s],gamma:n.gamma,optimalityGap:l}}scoreActions(n,e,a){let o={};return Object.entries(e).forEach(([e,t])=>{let r=a.defaultActionScore;var i=a.coefficients[e];i&&(r=i.intercept,r=(r=(r=(r+=this.scoreNumericAttributes(i.subjectNumericCoefficients,n.numericAttributes))+this.scoreCategoricalAttributes(i.subjectCategoricalCoefficients,n.categoricalAttributes))+this.scoreNumericAttributes(i.actionNumericCoefficients,t.numericAttributes))+this.scoreCategoricalAttributes(i.actionCategoricalCoefficients,t.categoricalAttributes)),o[e]=r}),o}scoreNumericAttributes(e,i){return e.reduce((e,t)=>{var r=i[t.attributeKey];return"number"==typeof r&&isFinite(r)?e+=r*t.coefficient:e+=t.missingValueCoefficient,e},0)}scoreCategoricalAttributes(e,i){return e.reduce((e,t)=>{var r=i[t.attributeKey]?.toString(),r=r&&t.valueCoefficients[r];return e+("number"==typeof r?r:t.missingValueCoefficient)},0)}weighActions(e,s,t){let l={},u=Object.entries(e);if(u.length){var{topScore:e,topAction:c}=this.getTopScore(e);if(null===e||null===c)throw new Error("Unable to find top score");let r=e,i=c,n=u.length,a=t/n,o=0;u.forEach(([e,t])=>{e!==i&&(t=1/(n+s*(r-t)),t=Math.max(t,a),o+=t,l[e]=t)}),l[i]=Math.max(1-o,0)}return l}selectAction(i,n,t){var t=Object.entries(t).sort((e,t)=>{let r=this.sharder.getShard(i+`-${n}-`+e[0],this.assignmentShards)-this.sharder.getShard(i+`-${n}-`+t[0],this.assignmentShards);return r=0===r?e[0]<t[0]?-1:1:r}),r=this.sharder.getShard(i+"-"+n,this.assignmentShards)/this.assignmentShards;let a=0,o=null;for(let e of t)if(a+=e[1],a>r){o=e[0];break}if(null===o)throw new Error(`No bandit action selected for flag "${i}" and subject "${n}"`);return o}getTopScore(e){e=Object.entries(e);let r=null,i=null;return e.forEach(([e,t])=>{(null===r||null===i||t>r||t===r&&e<i)&&(r=t,i=e)}),{topScore:r,topAction:i}}}},3621:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(i,n,a){let o,s=!1,l=0,u=i,c=!1,g=()=>{s||(s=!0,o&&clearTimeout(o),h.logger.info("Eppo SDK polling stopped"))};async function d(){if(!s){try{await n(),l=0,u=i,c&&(c=!1,h.logger.info("Eppo SDK poll successful; resuming normal polling"))}catch(e){c=!0,h.logger.warn("Eppo SDK encountered an error polling configurations: "+e.message);var r=1+(a?.maxPollRetries??f.DEFAULT_POLL_CONFIG_REQUEST_RETRIES);if(++l<r){let e=Math.pow(2,l),t=m(i);u=e*i+t,h.logger.warn(`Eppo SDK will try polling again in ${u} ms (${r-l} attempts remaining)`)}else h.logger.error(`Eppo SDK reached maximum of ${l} failed polling attempts. Stopping polling`),g()}setTimeout(d,u)}}return{start:async()=>{let e=s=!1,t=a?.skipInitialPoll?0:1+(a?.maxStartRetries??f.DEFAULT_INITIAL_CONFIG_REQUEST_RETRIES),r=null;for(;!e&&0<t;)try{await n(),e=!0,c=!1,h.logger.info("Eppo SDK successfully requested initial configuration")}catch(e){if(c=!0,h.logger.warn("Eppo SDK encountered an error with initial poll of configurations: "+e.message),0<--t){let e=m(i);h.logger.warn(`Eppo SDK will retry the initial poll again in ${e} ms (${t} attempts remaining)`),await(0,p.waitForMs)(e)}else a?.pollAfterFailedStart?h.logger.warn("Eppo SDK initial poll failed; will attempt regular polling"):(h.logger.error("Eppo SDK initial poll failed. Aborting polling"),g()),a?.errorOnFailedStart&&(r=e)}if(!s&&(e&&a?.pollAfterSuccessfulStart||!e&&a?.pollAfterFailedStart)?(h.logger.info(`Eppo SDK starting regularly polling every ${i} ms`),o=setTimeout(d,i)):h.logger.info("Eppo SDK will not poll for configuration updates"),r)throw h.logger.info("Eppo SDK rethrowing start error"),r},stop:g}};let h=r(4742),f=r(6882),p=r(7615);function m(e){return e*f.POLL_JITTER_PCT/2+Math.max(Math.floor(Math.random()*e*f.POLL_JITTER_PCT/2),1)}},3650:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let E=r(4620),v=r(4742),a=r(318),i=r(2094),n=r(9851),y=r(6882),o=r(1650),b=r(7059),s=r(4619),l=r(6092),S=r(3621),A=r(5188),u=r(4388),c=r(7791),g=r(8475);t.default=class{constructor(e){this.queuedAssignmentEvents=[],this.banditEventsQueue=[],this.precomputedFlagStore=e.precomputedFlagStore,this.precomputedBanditStore=e.precomputedBanditStore,this.overrideStore=e.overrideStore;var{subjectKey:t,subjectAttributes:r}=e.subject;this.subject={subjectKey:t,subjectAttributes:(0,a.ensureContextualSubjectAttributes)(r)},this.banditActions=e.banditActions,e.requestParameters?this.requestParameters=e.requestParameters:(0<this.precomputedFlagStore.getKeys().length&&(this.precomputedFlagStore.isInitialized()||v.logger.error(v.loggerPrefix+" EppoPrecomputedClient requires an initialized precomputedFlagStore if requestParameters are not provided"),this.precomputedFlagStore.salt||v.logger.error(v.loggerPrefix+" EppoPrecomputedClient requires a precomputedFlagStore with a salt if requestParameters are not provided")),this.precomputedBanditStore&&!this.precomputedBanditStore.isInitialized()&&v.logger.error(v.loggerPrefix+" Passing banditOptions without requestParameters requires an initialized precomputedBanditStore"),this.precomputedBanditStore&&!this.precomputedBanditStore.salt&&v.logger.warn(v.loggerPrefix+" EppoPrecomputedClient missing or empty salt for precomputedBanditStore"))}async fetchPrecomputedFlags(){if(!this.requestParameters)throw new Error("Eppo SDK unable to fetch precomputed flags without the request parameters");this.requestPoller?.stop();var{apiKey:e,sdkName:t,sdkVersion:r,baseUrl:i,requestTimeoutMs:n=y.DEFAULT_REQUEST_TIMEOUT_MS,numInitialRequestRetries:a=y.DEFAULT_INITIAL_CONFIG_REQUEST_RETRIES,numPollRequestRetries:o=y.DEFAULT_POLL_CONFIG_REQUEST_RETRIES,pollAfterSuccessfulInitialization:s=!1,pollAfterFailedInitialization:l=!1,throwOnFailedInitialization:u=!1,skipInitialPoll:c=!1}=this.requestParameters,{subjectKey:g,subjectAttributes:d}=this.subject;let{pollingIntervalMs:h=y.DEFAULT_POLL_INTERVAL_MS}=this.requestParameters,f=(h<=0&&(v.logger.error("pollingIntervalMs must be greater than 0. Using default"),h=y.DEFAULT_POLL_INTERVAL_MS),new E.default({baseUrl:i??y.PRECOMPUTED_BASE_URL,queryParams:{apiKey:e,sdkName:t,sdkVersion:r}})),p=new b.default(f,n),m=new A.default(p,this.precomputedFlagStore,g,d,this.precomputedBanditStore,this.banditActions);this.requestPoller=(0,S.default)(h,async()=>{if(await this.precomputedFlagStore.isExpired())return m.fetchAndStorePrecomputedFlags()},{maxStartRetries:a,maxPollRetries:o,pollAfterSuccessfulStart:s,pollAfterFailedStart:l,errorOnFailedStart:u,skipInitialPoll:c}),await this.requestPoller.start()}stopPolling(){this.requestPoller&&this.requestPoller.stop()}getPrecomputedAssignment(t,r,i,e=e=>e){(0,u.validateNotBlank)(t,"Invalid argument: flagKey cannot be blank");var n=this.overrideStore?.get(t);if(n)return e(n.value);n=this.getPrecomputedFlag(t);if(null==n)return v.logger.warn(v.loggerPrefix+" No assigned variation. Flag not found: "+t),r;if(!(0,g.checkTypeMatch)(i,n.variationType)){let e=v.loggerPrefix+` Type mismatch: expected ${i} but flag ${t} has type `+n.variationType;return v.logger.error(e),r}i={flagKey:t,format:this.precomputedFlagStore.getFormat()??"",subjectKey:this.subject.subjectKey??"",subjectAttributes:(0,a.ensureNonContextualSubjectAttributes)(this.subject.subjectAttributes??{}),variation:{key:n.variationKey??"",value:n.variationValue},allocationKey:n.allocationKey??"",extraLogging:n.extraLogging??{},doLog:n.doLog,entityId:null};try{i.doLog&&this.logAssignment(i)}catch(t){v.logger.error(v.loggerPrefix+" Error logging assignment event: "+t)}try{return void 0!==i.variation?.value?e(i.variation.value):r}catch(t){return v.logger.error(v.loggerPrefix+" Error transforming value: "+t),r}}getStringAssignment(e,t){return this.getPrecomputedAssignment(e,t,s.VariationType.STRING)}getBooleanAssignment(e,t){return this.getPrecomputedAssignment(e,t,s.VariationType.BOOLEAN)}getIntegerAssignment(e,t){return this.getPrecomputedAssignment(e,t,s.VariationType.INTEGER)}getNumericAssignment(e,t){return this.getPrecomputedAssignment(e,t,s.VariationType.NUMERIC)}getJSONAssignment(e,t){return this.getPrecomputedAssignment(e,t,s.VariationType.JSON,e=>"string"==typeof e?JSON.parse(e):t)}getBanditAction(t,e){if(!this.getPrecomputedFlag(t))return v.logger.warn(v.loggerPrefix+" No assigned variation. Flag not found: "+t),{variation:e,action:null};var r=this.getPrecomputedBandit(t),i=this.getStringAssignment(t,e);if(r){let e={timestamp:(new Date).toISOString(),featureFlag:t,bandit:r.banditKey,subject:this.subject.subjectKey??"",action:r.action,actionProbability:r.actionProbability,optimalityGap:r.optimalityGap,modelVersion:r.modelVersion,subjectNumericAttributes:r.actionNumericAttributes,subjectCategoricalAttributes:r.actionCategoricalAttributes,actionNumericAttributes:r.actionNumericAttributes,actionCategoricalAttributes:r.actionCategoricalAttributes,metaData:this.buildLoggerMetadata(),evaluationDetails:null};try{this.logBanditAction(e)}catch(t){v.logger.error(v.loggerPrefix+" Error logging bandit action: "+t)}return{variation:i,action:e.action}}return{variation:i,action:null}}getPrecomputedFlag(e){return this.getObfuscatedFlag(e)}getObfuscatedFlag(e){var t=this.precomputedFlagStore.salt,e=(0,l.getMD5Hash)(e,t),t=this.precomputedFlagStore.get(e);return t?(0,o.decodePrecomputedFlag)(t):null}getPrecomputedBandit(e){e=this.getObfuscatedPrecomputedBandit(e);return e?(0,o.decodePrecomputedBandit)(e):null}getObfuscatedPrecomputedBandit(e){var t=this.precomputedBanditStore?.salt,e=(0,l.getMD5Hash)(e,t);return this.precomputedBanditStore?.get(e)??null}isInitialized(){return this.precomputedFlagStore.isInitialized()}setAssignmentLogger(e){this.assignmentLogger=e,this.flushQueuedEvents(this.queuedAssignmentEvents,this.assignmentLogger?.logAssignment)}setBanditLogger(e){this.banditLogger=e,this.flushQueuedEvents(this.banditEventsQueue,this.banditLogger?.logBanditAction)}disableAssignmentCache(){this.assignmentCache=void 0}useNonExpiringInMemoryAssignmentCache(){this.assignmentCache=new n.NonExpiringInMemoryAssignmentCache}useLRUInMemoryAssignmentCache(e){this.assignmentCache=new i.LRUInMemoryAssignmentCache(e)}useCustomAssignmentCache(e){this.assignmentCache=e}flushQueuedEvents(e,t){var r=[...e];e.length=0,t&&r.forEach(e=>{try{t(e)}catch(e){v.logger.error(v.loggerPrefix+" Error flushing event to logger: "+e.message)}})}logAssignment(e){var{flagKey:t,subjectKey:r,allocationKey:i,subjectAttributes:n,variation:a,format:o}=e,o={...e.extraLogging??{},allocation:i??null,experiment:i?t+"-"+i:null,featureFlag:t,format:o,variation:a?.key??null,subject:r,timestamp:(new Date).toISOString(),subjectAttributes:n,metaData:this.buildLoggerMetadata(),evaluationDetails:null};if(a&&i){let e=this.assignmentCache?.has({flagKey:t,subjectKey:r,allocationKey:i,variationKey:a.key});if(e)return}try{this.assignmentLogger?this.assignmentLogger.logAssignment(o):this.queuedAssignmentEvents.length<y.MAX_EVENT_QUEUE_SIZE&&this.queuedAssignmentEvents.push(o),this.assignmentCache?.set({flagKey:t,subjectKey:r,allocationKey:i??"__eppo_no_allocation",variationKey:a?.key??"__eppo_no_variation"})}catch(e){v.logger.error(v.loggerPrefix+" Error logging assignment event: "+e.message)}}logBanditAction(e){var t=e.subject,t={flagKey:e.featureFlag,subjectKey:t,banditKey:e.bandit,actionKey:e.action??"__eppo_no_action"};if(!this.banditAssignmentCache?.has(t))try{this.banditLogger?this.banditLogger.logBanditAction(e):this.banditEventsQueue.push(e),this.banditAssignmentCache?.set(t)}catch(e){v.logger.warn("Error encountered logging bandit action",e)}}buildLoggerMetadata(){return{obfuscated:!0,sdkLanguage:"javascript",sdkLibVersion:c.LIB_VERSION}}setOverrideStore(e){this.overrideStore=e}unsetOverrideStore(){this.overrideStore=void 0}}},3708:(e,t,r)=>{let i=/\s+/g;e.exports=class R{constructor(e,t){if(t=n(t),e instanceof R)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new R(e.raw,t);if(e instanceof s)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(i," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);if(1<this.set.length){let e=this.set[0];if(this.set=this.set.filter(e=>!m(e[0])),0===this.set.length)this.set=[e];else if(1<this.set.length)for(let e of this.set)if(1===e.length&&E(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){0<e&&(this.formatted+="||");var t=this.set[e];for(let e=0;e<t.length;e++)0<e&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){var t=((this.options.includePrerelease&&f)|(this.options.loose&&p))+":"+e,r=o.get(t);if(r)return r;var i=(r=this.options.loose)?l[d.HYPHENRANGELOOSE]:l[d.HYPHENRANGE];e=e.replace(i,N(this.options.includePrerelease)),g("hyphen replace",e),e=e.replace(l[d.COMPARATORTRIM],u),g("comparator trim",e),e=e.replace(l[d.TILDETRIM],c),g("tilde trim",e),e=e.replace(l[d.CARETTRIM],h),g("caret trim",e);let n=e.split(" ").map(e=>y(e,this.options)).join(" ").split(/\s+/).map(e=>_(e,this.options));r&&(n=n.filter(e=>(g("loose invalid filter",e,this.options),!!e.match(l[d.COMPARATORLOOSE])))),g("range list",n);var a=new Map;for(let e of n.map(e=>new s(e,this.options))){if(m(e))return[e];a.set(e.value,e)}return 1<a.size&&a.has("")&&a.delete(""),i=[...a.values()],o.set(t,i),i}intersects(e,r){if(e instanceof R)return this.set.some(t=>v(t,r)&&e.set.some(e=>v(e,r)&&t.every(t=>e.every(e=>t.intersects(e,r)))));throw new TypeError("a Range is required")}test(t){if(t){if("string"==typeof t)try{t=new a(t,this.options)}catch(t){return!1}for(let e=0;e<this.set.length;e++)if(L(this.set[e],t,this.options))return!0}return!1}};let o=new(r(4865)),n=r(6990),s=r(6757),g=r(1721),a=r(4605),{safeRe:l,t:d,comparatorTrimReplace:u,tildeTrimReplace:c,caretTrimReplace:h}=r(4065),{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:p}=r(831),m=e=>"<0.0.0-0"===e.value,E=e=>""===e.value,v=(e,t)=>{let r=!0;var i=e.slice();let n=i.pop();for(;r&&i.length;)r=i.every(e=>n.intersects(e,t)),n=i.pop();return r},y=(e,t)=>(g("comp",e,t),e=O(e,t),g("caret",e),e=S(e,t),g("tildes",e),e=w(e,t),g("xrange",e),e=T(e,t),g("stars",e),e),b=e=>!e||"x"===e.toLowerCase()||"*"===e,S=(e,t)=>e.trim().split(/\s+/).map(e=>A(e,t)).join(" "),A=(o,e)=>{e=e.loose?l[d.TILDELOOSE]:l[d.TILDE];return o.replace(e,(e,t,r,i,n)=>{let a;return g("tilde",o,e,t,r,i,n),a=b(t)?"":b(r)?`>=${t}.0.0 <${+t+1}.0.0-0`:b(i)?`>=${t}.${r}.0 <${t}.${+r+1}.0-0`:n?(g("replaceTilde pr",n),`>=${t}.${r}.${i}-${n} <${t}.${+r+1}.0-0`):`>=${t}.${r}.${i} <${t}.${+r+1}.0-0`,g("tilde return",a),a})},O=(e,t)=>e.trim().split(/\s+/).map(e=>C(e,t)).join(" "),C=(o,e)=>{g("caret",o,e);let t=e.loose?l[d.CARETLOOSE]:l[d.CARET],s=e.includePrerelease?"-0":"";return o.replace(t,(e,t,r,i,n)=>{let a;return g("caret",o,e,t,r,i,n),a=b(t)?"":b(r)?`>=${t}.0.0${s} <${+t+1}.0.0-0`:b(i)?"0"===t?`>=${t}.${r}.0${s} <${t}.${+r+1}.0-0`:`>=${t}.${r}.0${s} <${+t+1}.0.0-0`:n?(g("replaceCaret pr",n),"0"===t?"0"===r?`>=${t}.${r}.${i}-${n} <${t}.${r}.${+i+1}-0`:`>=${t}.${r}.${i}-${n} <${t}.${+r+1}.0-0`:`>=${t}.${r}.${i}-${n} <${+t+1}.0.0-0`):(g("no pr"),"0"===t?"0"===r?`>=${t}.${r}.${i}${s} <${t}.${r}.${+i+1}-0`:`>=${t}.${r}.${i}${s} <${t}.${+r+1}.0-0`:`>=${t}.${r}.${i} <${+t+1}.0.0-0`),g("caret return",a),a})},w=(e,t)=>(g("replaceXRanges",e,t),e.split(/\s+/).map(e=>I(e,t)).join(" ")),I=(u,c)=>{u=u.trim();var e=c.loose?l[d.XRANGELOOSE]:l[d.XRANGE];return u.replace(e,(e,t,r,i,n,a)=>{g("xRange",u,e,t,r,i,n,a);var o=b(r),s=o||b(i),l=s||b(n);return"="===t&&l&&(t=""),a=c.includePrerelease?"-0":"",o?e=">"===t||"<"===t?"<0.0.0-0":"*":t&&l?(s&&(i=0),n=0,">"===t?(t=">=",n=(i=s?(r=+r+1,0):+i+1,0)):"<="===t&&(t="<",s?r=+r+1:i=+i+1),e=t+r+`.${i}.`+n+(a="<"===t?"-0":a)):s?e=`>=${r}.0.0${a} <${+r+1}.0.0-0`:l&&(e=`>=${r}.${i}.0${a} <${r}.${+i+1}.0-0`),g("xRange return",e),e})},T=(e,t)=>(g("replaceStars",e,t),e.trim().replace(l[d.STAR],"")),_=(e,t)=>(g("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),N=d=>(e,t,r,i,n,a,o,s,l,u,c,g)=>(`${t=b(r)?"":b(i)?`>=${r}.0.0`+(d?"-0":""):b(n)?`>=${r}.${i}.0`+(d?"-0":""):a?">="+t:">="+t+(d?"-0":"")} `+(s=b(l)?"":b(u)?`<${+l+1}.0.0-0`:b(c)?`<${l}.${+u+1}.0-0`:g?`<=${l}.${u}.${c}-`+g:d?`<${l}.${u}.${+c+1}-0`:"<="+s)).trim(),L=(t,r,e)=>{for(let e=0;e<t.length;e++)if(!t[e].test(r))return!1;if(!r.prerelease.length||e.includePrerelease)return!0;for(let e=0;e<t.length;e++)if(g(t[e].semver),t[e].semver!==s.ANY&&0<t[e].semver.prerelease.length){var i=t[e].semver;if(i.major===r.major&&i.minor===r.minor&&i.patch===r.patch)return!0}return!1}},3720:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateConfigurationStore=async function(e,t){var r;return!!e&&((r=await e.setEntries(t.entries))&&(e.setEnvironment(t.environment),e.setConfigFetchedAt((new Date).toISOString()),e.setConfigPublishedAt(t.createdAt),e.setFormat(t.format),e.salt=t.salt),r)}},3779:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);t.default={randomUUID:r}},3848:(e,t,r)=>{let a=r(4605),o=r(3708),s=r(3033);e.exports=(i,e)=>{i=new o(i,e);let n=new a("0.0.0");if(i.test(n))return n;if(n=new a("0.0.0-0"),i.test(n))return n;n=null;for(let t=0;t<i.set.length;++t){let e=i.set[t],r=null;e.forEach(e=>{var t=new a(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!s(t,r)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}),!r||n&&!s(n,r)||(n=r)}return n&&i.test(n)?n:null}},3977:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FlagEvaluationDetailsBuilder=t.AllocationEvaluationCode=t.flagEvaluationCodes=void 0;let a=r(4619);var o;t.flagEvaluationCodes=["MATCH","FLAG_UNRECOGNIZED_OR_DISABLED","TYPE_MISMATCH","ASSIGNMENT_ERROR","DEFAULT_ALLOCATION_NULL","NO_ACTIONS_SUPPLIED_FOR_BANDIT","BANDIT_ERROR"],(r=o||(t.AllocationEvaluationCode=o={})).UNEVALUATED="UNEVALUATED",r.MATCH="MATCH",r.BEFORE_START_TIME="BEFORE_START_TIME",r.TRAFFIC_EXPOSURE_MISS="TRAFFIC_EXPOSURE_MISS",r.AFTER_END_TIME="AFTER_END_TIME",r.FAILING_RULE="FAILING_RULE",t.FlagEvaluationDetailsBuilder=class{constructor(e,t,r,i){this.environmentName=e,this.allocations=t,this.configFetchedAt=r,this.configPublishedAt=i,this.variationKey=null,this.variationValue=null,this.matchedRule=null,this.matchedAllocation=null,this.unmatchedAllocations=[],this.addUnmatchedAllocation=e=>{this.unmatchedAllocations.push(e)},this.setNone=()=>(this.variationKey=null,this.variationValue=null,this.matchedRule=null,this.matchedAllocation=null,this),this.setMatch=(e,t,r,i,n)=>(this.variationKey=t.key,this.variationValue=n===a.VariationType.JSON&&"string"==typeof t.value?JSON.parse(t.value):t.value,this.matchedRule=i,this.matchedAllocation={key:r.key,allocationEvaluationCode:o.MATCH,orderPosition:e+1},this),this.buildForNoneResult=(e,t)=>this.setNone().build(e,t),this.build=(e,t)=>({environmentName:this.environmentName,flagEvaluationCode:e,flagEvaluationDescription:t,variationKey:this.variationKey,variationValue:this.variationValue,banditKey:null,banditAction:null,configFetchedAt:this.configFetchedAt,configPublishedAt:this.configPublishedAt,matchedRule:this.matchedRule,matchedAllocation:this.matchedAllocation,unmatchedAllocations:this.unmatchedAllocations,unevaluatedAllocations:this.calculateUnevaluatedAllocations()}),this.gracefulBuild=(e,t)=>{try{return this.build(e,t)}catch(e){return null}},this.calculateUnevaluatedAllocations=()=>{let e=this.matchedAllocation?this.unmatchedAllocations.length+1:this.unmatchedAllocations.length,r=e+1;return this.allocations.slice(e).map((e,t)=>({key:e.key,allocationEvaluationCode:o.UNEVALUATED,orderPosition:r+t}))},this.setNone()}}},3983:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigSource=t.ConfigLoaderStatus=void 0,(r=t.ConfigLoaderStatus||(t.ConfigLoaderStatus={}))[r.FAILED=0]="FAILED",r[r.DID_NOT_PRODUCE=1]="DID_NOT_PRODUCE",r[r.COMPLETED=2]="COMPLETED",(r=t.ConfigSource||(t.ConfigSource={}))[r.CONFIG_STORE=0]="CONFIG_STORE",r[r.FETCH=1]="FETCH",r[r.NONE=2]="NONE"},4035:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.servingStore=e,this.persistentStore=t}async init(){var e=await this.persistentStore.getEntries();e&&this.servingStore.setEntries(e)}set(e){this.servingStore.set(e),this.persistentStore.set(e)}has(e){return this.servingStore.has(e)}}},4065:(e,t,r)=>{let{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:a}=r(831),o=r(1721),s=(t=e.exports={}).re=[],l=t.safeRe=[],u=t.src=[],c=t.safeSrc=[],g=t.t={},d=0,h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",a],[h,n]],p=(e,t,r)=>{var i=(e=>{for(var[t,r]of f)e=e.split(t+"*").join(`${t}{0,${r}}`).split(t+"+").join(`${t}{1,${r}}`);return e})(t),n=d++;o(e,n,t),g[e]=n,u[n]=t,c[n]=i,s[n]=new RegExp(t,r?"g":void 0),l[n]=new RegExp(i,r?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*"),p("NUMERICIDENTIFIERLOOSE","\\d+"),p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),p("MAINVERSION",`(${u[g.NUMERICIDENTIFIER]})\\.(${u[g.NUMERICIDENTIFIER]})\\.(${u[g.NUMERICIDENTIFIER]})`),p("MAINVERSIONLOOSE",`(${u[g.NUMERICIDENTIFIERLOOSE]})\\.(${u[g.NUMERICIDENTIFIERLOOSE]})\\.(${u[g.NUMERICIDENTIFIERLOOSE]})`),p("PRERELEASEIDENTIFIER",`(?:${u[g.NUMERICIDENTIFIER]}|${u[g.NONNUMERICIDENTIFIER]})`),p("PRERELEASEIDENTIFIERLOOSE",`(?:${u[g.NUMERICIDENTIFIERLOOSE]}|${u[g.NONNUMERICIDENTIFIER]})`),p("PRERELEASE",`(?:-(${u[g.PRERELEASEIDENTIFIER]}(?:\\.${u[g.PRERELEASEIDENTIFIER]})*))`),p("PRERELEASELOOSE",`(?:-?(${u[g.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[g.PRERELEASEIDENTIFIERLOOSE]})*))`),p("BUILDIDENTIFIER",h+"+"),p("BUILD",`(?:\\+(${u[g.BUILDIDENTIFIER]}(?:\\.${u[g.BUILDIDENTIFIER]})*))`),p("FULLPLAIN",`v?${u[g.MAINVERSION]}${u[g.PRERELEASE]}?${u[g.BUILD]}?`),p("FULL",`^${u[g.FULLPLAIN]}$`),p("LOOSEPLAIN",`[v=\\s]*${u[g.MAINVERSIONLOOSE]}${u[g.PRERELEASELOOSE]}?${u[g.BUILD]}?`),p("LOOSE",`^${u[g.LOOSEPLAIN]}$`),p("GTLT","((?:<|>)?=?)"),p("XRANGEIDENTIFIERLOOSE",u[g.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),p("XRANGEIDENTIFIER",u[g.NUMERICIDENTIFIER]+"|x|X|\\*"),p("XRANGEPLAIN",`[v=\\s]*(${u[g.XRANGEIDENTIFIER]})(?:\\.(${u[g.XRANGEIDENTIFIER]})(?:\\.(${u[g.XRANGEIDENTIFIER]})(?:${u[g.PRERELEASE]})?${u[g.BUILD]}?)?)?`),p("XRANGEPLAINLOOSE",`[v=\\s]*(${u[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[g.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[g.XRANGEIDENTIFIERLOOSE]})(?:${u[g.PRERELEASELOOSE]})?${u[g.BUILD]}?)?)?`),p("XRANGE",`^${u[g.GTLT]}\\s*${u[g.XRANGEPLAIN]}$`),p("XRANGELOOSE",`^${u[g.GTLT]}\\s*${u[g.XRANGEPLAINLOOSE]}$`),p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),p("COERCE",u[g.COERCEPLAIN]+"(?:$|[^\\d])"),p("COERCEFULL",u[g.COERCEPLAIN]+`(?:${u[g.PRERELEASE]})?`+`(?:${u[g.BUILD]})?(?:$|[^\\d])`),p("COERCERTL",u[g.COERCE],!0),p("COERCERTLFULL",u[g.COERCEFULL],!0),p("LONETILDE","(?:~>?)"),p("TILDETRIM",`(\\s*)${u[g.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",p("TILDE",`^${u[g.LONETILDE]}${u[g.XRANGEPLAIN]}$`),p("TILDELOOSE",`^${u[g.LONETILDE]}${u[g.XRANGEPLAINLOOSE]}$`),p("LONECARET","(?:\\^)"),p("CARETTRIM",`(\\s*)${u[g.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",p("CARET",`^${u[g.LONECARET]}${u[g.XRANGEPLAIN]}$`),p("CARETLOOSE",`^${u[g.LONECARET]}${u[g.XRANGEPLAINLOOSE]}$`),p("COMPARATORLOOSE",`^${u[g.GTLT]}\\s*(${u[g.LOOSEPLAIN]})$|^$`),p("COMPARATOR",`^${u[g.GTLT]}\\s*(${u[g.FULLPLAIN]})$|^$`),p("COMPARATORTRIM",`(\\s*)${u[g.GTLT]}\\s*(${u[g.LOOSEPLAIN]}|${u[g.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",p("HYPHENRANGE",`^\\s*(${u[g.XRANGEPLAIN]})\\s+-\\s+(${u[g.XRANGEPLAIN]})\\s*$`),p("HYPHENRANGELOOSE",`^\\s*(${u[g.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[g.XRANGEPLAINLOOSE]})\\s*$`),p("STAR","(<|>)?=?\\s*\\*"),p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},4154:(e,t,r)=>{let i=r(2034);e.exports=(e,r)=>e.sort((e,t)=>i(t,e,r))},4161:(e,t,r)=>{let i=r(1147);e.exports=(e,t)=>{e=i(e.trim().replace(/^[=v]+/,""),t);return e?e.version:null}},4224:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let n=r(2091);t.default=class{constructor(e,t,r,i){this.httpClient=e,this.flagConfigurationStore=t,this.banditVariationConfigurationStore=r,this.banditModelConfigurationStore=i,this.banditModelVersions=[],this.configuration=new n.StoreBackedConfiguration(this.flagConfigurationStore,this.banditVariationConfigurationStore,this.banditModelConfigurationStore)}isFlagConfigExpired(){return this.flagConfigurationStore.isExpired()}getConfiguration(){return this.configuration}async fetchAndStoreConfigurations(){var i=await this.httpClient.getUniversalFlagConfiguration();if(i?.flags){let e={entries:i.flags,environment:i.environment,createdAt:i.createdAt,format:i.format},t,r;var n=0<Object.keys(i.banditReferences??{}).length,a=Boolean(this.banditVariationConfigurationStore&&this.banditModelConfigurationStore);if(n&&a&&(t={entries:this.indexBanditVariationsByFlagKey(i.banditReferences),environment:i.environment,createdAt:i.createdAt,format:i.format},this.requiresBanditModelConfigurationStoreUpdate(this.banditModelVersions,i.banditReferences))){let e=await this.httpClient.getBanditParameters();e?.bandits&&(r={entries:e.bandits,environment:i.environment,createdAt:i.createdAt,format:i.format},this.banditModelVersions=this.getLoadedBanditModelVersions(e.bandits))}await this.configuration.hydrateConfigurationStores(e,t,r)}}getLoadedBanditModelVersions(e){return Object.values(e).map(e=>e.modelVersion)}requiresBanditModelConfigurationStoreUpdate(t,e){return!Object.values(e).map(e=>e.modelVersion).every(e=>t.includes(e))}indexBanditVariationsByFlagKey(e){let r={};return Object.values(e).forEach(e=>{e.flagVariations.forEach(e=>{let t=r[e.flagKey];t||(t=[],r[e.flagKey]=t),t.push(e)})}),r}}},4299:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateV7State=void 0;let a=r(2291),o=r(6011),s={};function l(e,t,r){return e.msecs??=-1/0,e.seq??=0,e.msecs<t?(e.seq=r[6]<<23|r[7]<<16|r[8]<<8|r[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++),e}function u(e,t,r,i,n=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(i){if(n<0||n+16>i.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`)}else i=new Uint8Array(16),n=0;return t??=Date.now(),r??=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9],i[n++]=t/1099511627776&255,i[n++]=t/4294967296&255,i[n++]=t/16777216&255,i[n++]=t/65536&255,i[n++]=t/256&255,i[n++]=255&t,i[n++]=112|r>>>28&15,i[n++]=r>>>20&255,i[n++]=128|r>>>14&63,i[n++]=r>>>6&255,i[n++]=r<<2&255|3&e[10],i[n++]=e[11],i[n++]=e[12],i[n++]=e[13],i[n++]=e[14],i[n++]=e[15],i}t.updateV7State=l,t.default=function(e,r,i){let n;if(e)n=u(e.random??e.rng?.()??(0,a.default)(),e.msecs,e.seq,r,i);else{let e=Date.now(),t=(0,a.default)();l(s,e,t),n=u(t,s.msecs,s.seq,r,i)}return r??(0,o.unsafeStringify)(n)}},4388:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidArgumentError=void 0,t.validateNotBlank=function(e,t){if(null==e||0===e.length)throw new r(t)};class r extends Error{}t.InvalidArgumentError=r},4406:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OVERRIDES_KEY=t.META_KEY=t.CONFIGURATION_KEY=void 0,t.CONFIGURATION_KEY="eppo-configuration",t.META_KEY="eppo-configuration-meta",t.OVERRIDES_KEY="eppo-overrides"},4557:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0;let n=r(2829),a=r(2988);var i=r(2988);function o(e,t,r,i){return(0,a.default)(80,n.default,e,t,r,i)}Object.defineProperty(t,"DNS",{enumerable:!0,get:function(){return i.DNS}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return i.URL}}),o.DNS=a.DNS,o.URL=a.URL,t.default=o},4605:(e,t,r)=>{let n=r(1721),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=r(831),{safeRe:o,safeSrc:s,t:l}=r(4065),u=r(6990),c=r(8950).compareIdentifiers;e.exports=class g{constructor(e,t){if(t=u(t),e instanceof g){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);if(n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,!(t=e.trim().match(t.loose?o[l.LOOSE]:o[l.FULL])))throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=t[4]?t[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){var t=+e;if(0<=t&&t<a)return t}return e}):[],this.build=t[5]?t[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.`+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof g)){if("string"==typeof e&&e===this.version)return 0;e=new g(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof g||(e=new g(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof g||(e=new g(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{var r=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return c(r,i)}while(++t)}compareBuild(e){e instanceof g||(e=new g(e,this.options));let t=0;do{var r=this.build[t],i=e.build[t];if(n("build compare",t,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return c(r,i)}while(++t)}inc(e,r,i){if(e.startsWith("pre")){if(!r&&!1===i)throw new Error("invalid increment argument: identifier is empty");if(r){let e=new RegExp(`^${this.options.loose?s[l.PRERELEASELOOSE]:s[l.PRERELEASE]}$`),t=("-"+r).match(e);if(!t||t[1]!==r)throw new Error("invalid identifier: "+r)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,i),this.inc("pre",r,i);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",r,i),this.inc("pre",r,i);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{let t=Number(i)?1:0;if(0===this.prerelease.length)this.prerelease=[t];else{let e=this.prerelease.length;for(;0<=--e;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);if(-1===e){if(r===this.prerelease.join(".")&&!1===i)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(t)}}if(r){let e=[r,t];!1===i&&(e=[r]),0===c(this.prerelease[0],r)&&!isNaN(this.prerelease[1])||(this.prerelease=e)}break}default:throw new Error("invalid increment argument: "+e)}return this.raw=this.format(),this.build.length&&(this.raw+="+"+this.build.join(".")),this}}},4617:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EppoValue=t.EppoValueType=void 0;let i=r(4619),n=r(6092);var a;(r=a||(t.EppoValueType=a={}))[r.NullType=0]="NullType",r[r.BoolType=1]="BoolType",r[r.NumericType=2]="NumericType",r[r.StringType=3]="StringType",r[r.JSONType=4]="JSONType";class o{constructor(e,t,r,i,n){this.valueType=e,this.boolValue=t,this.numericValue=r,this.stringValue=i,this.objectValue=n}static valueOf(e,t){if(null==e)return o.Null();switch(t){case i.VariationType.BOOLEAN:return o.Bool(e);case i.VariationType.NUMERIC:case i.VariationType.INTEGER:return o.Numeric(e);case i.VariationType.STRING:return o.String(e);case i.VariationType.JSON:return o.JSON(e);default:return o.String(e)}}toString(){switch(this.valueType){case a.NullType:return"null";case a.BoolType:return this.boolValue?"true":"false";case a.NumericType:return this.numericValue?this.numericValue.toString():"0";case a.StringType:return this.stringValue??"";case a.JSONType:try{return JSON.stringify(this.objectValue)??""}catch{return this.stringValue??""}}}toHashedString(){var e=this.toString();return(0,n.getMD5Hash)(e)}static Bool(e){return new o(a.BoolType,e,void 0,void 0,void 0)}static Numeric(e){return new o(a.NumericType,void 0,e,void 0,void 0)}static String(e){return new o(a.StringType,void 0,void 0,e,void 0)}static JSON(e){return new o(a.JSONType,void 0,void 0,void 0,"string"==typeof e?JSON.parse(e):e)}static Null(){return new o(a.NullType,void 0,void 0,void 0,void 0)}}t.EppoValue=o},4619:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FormatEnum=t.UNKNOWN_ENVIRONMENT_NAME=t.VariationType=void 0,t.VariationType={STRING:"STRING",INTEGER:"INTEGER",NUMERIC:"NUMERIC",BOOLEAN:"BOOLEAN",JSON:"JSON"},t.UNKNOWN_ENVIRONMENT_NAME="UNKNOWN",t.FormatEnum={SERVER:"SERVER",CLIENT:"CLIENT",PRECOMPUTED:"PRECOMPUTED"}},4620:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(6882);t.default=class{constructor(e){this.params=e,this.params.baseUrl=e.baseUrl??i.BASE_URL}endpoint(e){let r=new URL(this.params.baseUrl+e);return Object.entries(this.params.queryParams??{}).forEach(([e,t])=>r.searchParams.append(e,t)),r}ufcEndpoint(){return this.endpoint(i.UFC_ENDPOINT)}banditParametersEndpoint(){return this.endpoint(i.BANDIT_ENDPOINT)}precomputedFlagsEndpoint(){return this.endpoint(i.PRECOMPUTED_FLAGS_ENDPOINT)}}},4736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObfuscatedOperatorType=t.OperatorType=void 0,t.matchesRule=function(e,t,r){return s=t,t=e.conditions,l=r,!t.map(e=>{if(l){var t=Object.entries(s).reduce((e,[t,r])=>({[(0,c.getMD5Hash)(t)]:r,...e}),{}),r=e,i=t[r.attribute];if(r.operator===d.IS_NULL)return r.value===(0,c.getMD5Hash)("true")?null==i:null!=i;if(null!=i)switch(r.operator){case d.GTE:case d.GT:case d.LTE:case d.LT:{let e=(0,c.decodeBase64)(r.value);return v(e)===h.SEM_VER?E(i,e,r.operator===d.GTE?u.gte:r.operator===d.GT?u.gt:r.operator===d.LTE?u.lte:u.lt):m(i,Number(e),(e,t)=>r.operator===d.GTE?t<=e:r.operator===d.GT?t<e:r.operator===d.LTE?e<=t:e<t)}case d.MATCHES:return new RegExp((0,c.decodeBase64)(r.value)).test(i);case d.NOT_MATCHES:return!new RegExp((0,c.decodeBase64)(r.value)).test(i);case d.ONE_OF:return f((0,c.getMD5Hash)(i.toString()),r.value);case d.NOT_ONE_OF:return p((0,c.getMD5Hash)(i.toString()),r.value)}}else{var n=s,a=e,o=n[a.attribute];if(a.operator===g.IS_NULL)return a.value?null==o:null!=o;if(null!=o)switch(a.operator){case g.GTE:case g.GT:case g.LTE:case g.LT:{if(v(a.value)===h.SEM_VER){let e=a.operator===g.GTE?u.gte:a.operator===g.GT?u.gt:a.operator===g.LTE?u.lte:u.lt;return E(o,a.value,e)}let e=(e,t)=>a.operator===g.GTE?t<=e:a.operator===g.GT?t<e:a.operator===g.LTE?e<=t:e<t;return m(o,a.value,e)}case g.MATCHES:return new RegExp(a.value).test(o);case g.NOT_MATCHES:return!new RegExp(a.value).test(o);case g.ONE_OF:return f(o.toString(),a.value);case g.NOT_ONE_OF:return p(o.toString(),a.value)}}return!1}).includes(!1);var s,l};let u=r(9658),c=r(6092);var g,d,h;function f(e,t){return 0<i(e,t).length}function p(e,t){return 0===i(e,t).length}function i(t,e){return e.filter(e=>e===t)}function m(e,t,r){return r(Number(e),Number(t))}function E(e,t,r){return!!(0,u.valid)(e)&&!!(0,u.valid)(t)&&r(e,t)}function v(e){return"number"==typeof e?h.NUMERIC:Array.isArray(e)?h.STRING_ARRAY:"string"==typeof e&&(0,u.valid)(e)?h.SEM_VER:isNaN(Number(e))?h.PLAIN_STRING:h.NUMERIC}(r=g||(t.OperatorType=g={})).MATCHES="MATCHES",r.NOT_MATCHES="NOT_MATCHES",r.GTE="GTE",r.GT="GT",r.LTE="LTE",r.LT="LT",r.ONE_OF="ONE_OF",r.NOT_ONE_OF="NOT_ONE_OF",r.IS_NULL="IS_NULL",(r=d||(t.ObfuscatedOperatorType=d={})).MATCHES="05015086bdd8402218f6aad6528bef08",r.NOT_MATCHES="8323761667755378c3a78e0a6ed37a78",r.GTE="32d35312e8f24bc1669bd2b45c00d47c",r.GT="cd6a9bd2a175104eed40f0d33a8b4020",r.LTE="cc981ecc65ecf63ad1673cbec9c64198",r.LT="c562607189d77eb9dfb707464c1e7b0b",r.ONE_OF="27457ce369f2a74203396a35ef537c0b",r.NOT_ONE_OF="602f5ee0b6e84fe29f43ab48b9e1addf",r.IS_NULL="dbd9c38e0339e6c34bd48cafc59be388",(t=h=h||{}).PLAIN_STRING="PLAIN_STRING",t.STRING_ARRAY="STRING_ARRAY",t.SEM_VER="SEM_VER",t.NUMERIC="NUMERIC"},4742:(e,t,r)=>{var i=r(5606),r=(Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.loggerPrefix=void 0,r(4874));t.loggerPrefix="[Eppo SDK]",t.logger=(0,r.default)({level:i.env.LOG_LEVEL??"warn",browser:{disabled:!0}})},4858:(e,t,r)=>{let i=r(4605);e.exports=(e,t)=>new i(e,t).patch},4865:e=>{e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){var t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){let e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},4874:(e,t,r)=>{let E=r(793),v=(e.exports=S,function(){function t(e){return void 0!==e&&e}try{return"undefined"==typeof globalThis&&Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(e){return t(self)||t(window)||t(this)||{}}}().console||{}),i={mapHttpRequest:a,mapHttpResponse:a,wrapRequestSerializer:o,wrapResponseSerializer:o,wrapErrorSerializer:o,req:a,res:a,err:n,errWithCause:n};function y(e,t){return"silent"===e?1/0:t.levels.values[e]}let b=Symbol("pino.logFuncs"),s=Symbol("pino.hierarchy"),p={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function m(e,t){e={logger:t,parent:e[s]};t[s]=e}function S(s){(s=s||{}).browser=s.browser||{};let l=s.browser.transmit;if(l&&"function"!=typeof l.send)throw Error("pino: transmit option must have a send function");let r=s.browser.write||v,u=(s.browser.write&&(s.browser.asObject=!0),s.serializers||{}),c=(o=s.browser.serialize,g=u,Array.isArray(o)?o.filter(function(e){return"!stdSerializers.err"!==e}):!0===o&&Object.keys(g));let e=s.browser.serialize,t=(Array.isArray(s.browser.serialize)&&-1<s.browser.serialize.indexOf("!stdSerializers.err")&&(e=!1),Object.keys(s.customLevels||{})),i=["error","fatal","warn","info","debug","trace"].concat(t),n=("function"==typeof r&&i.forEach(function(e){r[e]=r}),!1!==s.enabled&&!s.browser.disabled||(s.level="silent"),s.level||"info"),a=Object.create(r);a.log||(a.log=w);{var o=a,g=i,d=r;let t={};g.forEach(e=>{t[e]=d[e]||v[e]||v[p[e]||"log"]||w}),o[b]=t}m({},a),Object.defineProperty(a,"levelVal",{get:function(){return y(this.level,this)}}),Object.defineProperty(a,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,A(this,h,a,"error"),A(this,h,a,"fatal"),A(this,h,a,"warn"),A(this,h,a,"info"),A(this,h,a,"debug"),A(this,h,a,"trace"),t.forEach(e=>{A(this,h,a,e)})}});let h={transmit:l,serialize:c,asObject:s.browser.asObject,formatters:s.browser.formatters,levels:i,timestamp:"function"==typeof(g=s).timestamp?g.timestamp:!1===g.timestamp?I:T,messageKey:s.messageKey||"msg",onChild:s.onChild||w};function f(t,r,e){if(!r)throw new Error("missing bindings for child Pino");e=e||{},c&&r.serializers&&(e.serializers=r.serializers);var i,n,a=e.serializers;function o(e){this._childLevel=1+(0|e._childLevel),this.bindings=r,i&&(this.serializers=i,this._serialize=n),l&&(this._logEvent=C([].concat(e._logEvent.bindings,r)))}c&&a&&(i=Object.assign({},u,a),n=!0===s.browser.serialize?Object.keys(i):c,delete r.serializers,O([r],n,i,this._stdErrSerialize)),o.prototype=this;a=new o(this);return m(this,a),a.child=function(...e){return f.call(this,t,...e)},a.level=e.level||this.level,t.onChild(a),a}return a.levels=(o=s.customLevels||{},{values:Object.assign({},S.levels.values,o),labels:Object.assign({},S.levels.labels,(t=>{let r={};return Object.keys(t).forEach(function(e){r[t[e]]=e}),r})(o))}),a.level=n,a.setMaxListeners=a.getMaxListeners=a.emit=a.addListener=a.on=a.prependListener=a.once=a.prependOnceListener=a.removeListener=a.removeAllListeners=a.listeners=a.listenerCount=a.eventNames=a.write=a.flush=w,a.serializers=u,a._serialize=c,a._stdErrSerialize=e,a.child=function(...e){return f.call(this,h,...e)},l&&(a._logEvent=C()),a}function A(t,r,i,n){if(Object.defineProperty(t,n,{value:y(t.level,i)>y(n,i)?w:i[b][n],writable:!0,enumerable:!0,configurable:!0}),t[n]===w){if(!r.transmit)return;let e=y(r.transmit.level||t.level,i);if(y(n,i)<e)return}t[n]=(f=r,p=i,m=n,a=(h=t)[b][m],function(){for(var l=f.timestamp(),u=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===v?v:this,e=0;e<u.length;e++)u[e]=arguments[e];var g=!1;if(f.serialize&&(O(u,this._serialize,this.serializers,this._stdErrSerialize),g=!0),f.asObject||f.formatters?a.call(c,((t,r,e,i,n)=>{var{level:a,log:o=e=>e}=n.formatters||{},s=e.slice();let l=s[0];var u={};if(i&&(u.time=i),a){let e=a(r,t.levels.values[r]);Object.assign(u,e)}else u.level=t.levels.values[r];let c=1+(0|t._childLevel);if(c<1&&(c=1),null!==l&&"object"==typeof l){for(;c--&&"object"==typeof s[0];)Object.assign(u,s.shift());l=s.length?E(s.shift(),s):void 0}else"string"==typeof l&&(l=E(s.shift(),s));return void 0!==l&&(u[n.messageKey]=l),o(u)})(this,m,u,l,f)):a.apply(c,u),f.transmit){let o=f.transmit.level||h._level,e=y(o,p),s=y(m,p);if(!(s<e)){var[c,l,g,d=!1]=[this,{ts:l,methodLevel:m,methodValue:s,transmitLevel:o,transmitValue:p.levels.values[f.transmit.level||h._level],send:f.transmit.send,val:y(h._level,p)},u,g];let e=l.send,t=l.ts,r=l.methodLevel,i=l.methodValue,n=l.val,a=c._logEvent.bindings;d||O(g,c._serialize||Object.keys(c.serializers),c.serializers,void 0===c._stdErrSerialize||c._stdErrSerialize),c._logEvent.ts=t,c._logEvent.messages=g.filter(function(e){return-1===a.indexOf(e)}),c._logEvent.level.label=r,c._logEvent.level.value=i,e(r,c._logEvent,n),c._logEvent=C(a)}}});var h,f,p,m,a,e,o,r=(e=>{var t=[];e.bindings&&t.push(e.bindings);let r=e[s];for(;r.parent;)(r=r.parent).logger.bindings&&t.push(r.logger.bindings);return t.reverse()})(t);0!==r.length&&(t[n]=(e=r,o=t[n],function(){return o.apply(this,[...e,...arguments])}))}function O(t,r,i,e){for(var n in t)if(e&&t[n]instanceof Error)t[n]=S.stdSerializers.err(t[n]);else if("object"==typeof t[n]&&!Array.isArray(t[n])&&r)for(let e in t[n])-1<r.indexOf(e)&&e in i&&(t[n][e]=i[e](t[n][e]))}function C(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function n(e){var t,r={type:e.constructor.name,msg:e.message,stack:e.stack};for(t in e)void 0===r[t]&&(r[t]=e[t]);return r}function a(){return{}}function o(e){return e}function w(){}function I(){return!1}function T(){return Date.now()}S.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},S.stdSerializers=i,S.stdTimeFunctions=Object.assign({},{nullTime:I,epochTime:T,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),e.exports.default=S,e.exports.pino=S},5188:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(3720),n=r(4619);t.default=class{constructor(e,t,r,i,n,a){this.httpClient=e,this.precomputedFlagStore=t,this.subjectKey=r,this.subjectAttributes=i,this.precomputedBanditsStore=n,this.banditActions=a}async fetchAndStorePrecomputedFlags(){var e,t=await this.httpClient.getPrecomputedFlags({subject_key:this.subjectKey,subject_attributes:this.subjectAttributes,bandit_actions:this.banditActions});t&&((e=[]).push((0,i.hydrateConfigurationStore)(this.precomputedFlagStore,{entries:t.flags,environment:t.environment??{name:n.UNKNOWN_ENVIRONMENT_NAME},createdAt:t.createdAt,format:t.format,salt:t.salt})),this.precomputedBanditsStore&&e.push((0,i.hydrateConfigurationStore)(this.precomputedBanditsStore,{entries:t.bandits,environment:t.environment??{name:n.UNKNOWN_ENVIRONMENT_NAME},createdAt:t.createdAt,format:t.format,salt:t.salt})),await Promise.all(e))}}},5299:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DEFAULT_EVENT_DISPATCHER_CONFIG=o.DEFAULT_EVENT_DISPATCHER_BATCH_SIZE=void 0,o.newDefaultEventDispatcher=function(e,t,r,i=o.DEFAULT_EVENT_DISPATCHER_BATCH_SIZE,n=o.DEFAULT_EVENT_DISPATCHER_CONFIG){var a=(new d.default).decodeEventIngestionUrl(r);return a?new h(new l.default(e,i),t,{...n,ingestionUrl:a,sdkKey:r}):(s.logger.debug("Unable to parse Event ingestion URL from SDK key, falling back to no-op event dispatcher"),new g.default)};let s=t(4742),l=t(1565),u=t(5576),c=t(3454),g=t(391),d=t(922);o.DEFAULT_EVENT_DISPATCHER_BATCH_SIZE=1e3,o.DEFAULT_EVENT_DISPATCHER_CONFIG={deliveryIntervalMs:1e4,retryIntervalMs:5e3,maxRetryDelayMs:3e4,maxRetries:3};class h{constructor(e,t,r){this.batchProcessor=e,this.networkStatusListener=t,this.context={},this.dispatchTimer=null,this.isOffline=!1,this.ensureConfigFields(r);var{sdkKey:e,ingestionUrl:t,retryIntervalMs:i,maxRetryDelayMs:n,maxRetries:a=3}=r;this.eventDelivery=new c.default(e,t),this.retryManager=new u.default(this.eventDelivery,{retryIntervalMs:i,maxRetryDelayMs:n,maxRetries:a}),this.deliveryIntervalMs=r.deliveryIntervalMs,this.networkStatusListener.onNetworkStatusChange(e=>{s.logger.info(`[EventDispatcher] Network status change, isOffline=${e}.`),(this.isOffline=e)?this.dispatchTimer=null:this.maybeScheduleNextDelivery()})}attachContext(e,t){this.ensureValidContext(e,t),this.context[e]=t}dispatch(e){this.ensureValidEvent(e),this.batchProcessor.push(e),this.maybeScheduleNextDelivery()}ensureValidContext(e,t){if(t&&("object"==typeof t||Array.isArray(t)))throw new Error("Context value must be a string, number, boolean, or null");if(t&&2048<JSON.stringify({...this.context,[e]:t}).length)throw new Error("The total context size must be less than 2048 characters")}ensureValidEvent(e){if(4096<JSON.stringify(e).length)throw new Error("Event serialized length exceeds maximum allowed length of 4096")}async deliverNextBatch(){if(this.isOffline)s.logger.warn("[EventDispatcher] Skipping delivery; network status is offline.");else{let e=this.batchProcessor.nextBatch();if(0===e.length)this.dispatchTimer=null;else{var t={...this.context},r=(await this.eventDelivery.deliver(e,t)).failedEvents;if(0<r.length){s.logger.warn("[EventDispatcher] Failed to deliver some events from batch, retrying...");let e=await this.retryManager.retry(r,t);0<e.length&&this.batchProcessor.push(...e)}s.logger.debug(`[EventDispatcher] Delivered batch of ${e.length} events.`),this.dispatchTimer=null,this.maybeScheduleNextDelivery()}}}maybeScheduleNextDelivery(){this.isOffline||this.batchProcessor.isEmpty()||this.dispatchTimer||(s.logger.info(`[EventDispatcher] Scheduling next delivery in ${this.deliveryIntervalMs}ms.`),this.dispatchTimer=setTimeout(()=>this.deliverNextBatch(),this.deliveryIntervalMs))}ensureConfigFields(e){if(!e.ingestionUrl)throw new Error("Missing required ingestionUrl in EventDispatcherConfig");if(!e.deliveryIntervalMs)throw new Error("Missing required deliveryIntervalMs in EventDispatcherConfig");if(!e.retryIntervalMs)throw new Error("Missing required retryIntervalMs in EventDispatcherConfig");if(!e.maxRetryDelayMs)throw new Error("Missing required maxRetryDelayMs in EventDispatcherConfig")}}o.default=h},5473:(e,t,r)=>{let i=r(4605);e.exports=(e,t)=>new i(e,t).minor},5576:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let l=r(4742);t.default=class{constructor(e,t){this.delivery=e,this.config=t}async retry(e,t,r=0){let{retryIntervalMs:i,maxRetryDelayMs:n,maxRetries:a}=this.config,o=Math.min(i*Math.pow(2,r),n);l.logger.info(`[BatchRetryManager] Retrying batch delivery of ${e.length} events in ${o}ms...`),await new Promise(e=>setTimeout(e,o));var s=(await this.delivery.deliver(e,t)).failedEvents;return 0===s.length?(l.logger.info(`[BatchRetryManager] Batch delivery successfully after ${r+1} tries.`),[]):r<a-1?this.retry(s,t,r+1):(l.logger.warn(`[BatchRetryManager] Failed to deliver batch after ${a} tries, bailing`),e)}}},5606:e=>{var r,i,e=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===n||!r)&&setTimeout)return(r=setTimeout)(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}try{r="function"==typeof setTimeout?setTimeout:n}catch(e){r=n}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}var s,l=[],u=!1,c=-1;function g(){u&&s&&(u=!1,s.length?l=s.concat(l):c=-1,l.length)&&d()}function d(){if(!u){var e=o(g);u=!0;for(var t=l.length;t;){for(s=l,l=[];++c<t;)s&&s[c].run();c=-1,t=l.length}s=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function t(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new h(e,t)),1!==l.length||u||o(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=t,e.addListener=t,e.once=t,e.off=t,e.removeListener=t,e.removeAllListeners=t,e.emit=t,e.prependListener=t,e.prependOnceListener=t,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},5735:e=>{function l(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&n|~i&a)+t[0]-680876936|0)<<7|r>>>25)+i|0)&i|~r&n)+t[1]-389564586|0)<<12|a>>>20)+r|0)&r|~a&i)+t[2]+606105819|0)<<17|n>>>15)+a|0)&a|~n&r)+t[3]-1044525330|0)<<22|i>>>10)+n|0;i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&n|~i&a)+t[4]-176418897|0)<<7|r>>>25)+i|0)&i|~r&n)+t[5]+1200080426|0)<<12|a>>>20)+r|0)&r|~a&i)+t[6]-1473231341|0)<<17|n>>>15)+a|0)&a|~n&r)+t[7]-45705983|0)<<22|i>>>10)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&n|~i&a)+t[8]+1770035416|0)<<7|r>>>25)+i|0)&i|~r&n)+t[9]-1958414417|0)<<12|a>>>20)+r|0)&r|~a&i)+t[10]-42063|0)<<17|n>>>15)+a|0)&a|~n&r)+t[11]-1990404162|0)<<22|i>>>10)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&n|~i&a)+t[12]+1804603682|0)<<7|r>>>25)+i|0)&i|~r&n)+t[13]-40341101|0)<<12|a>>>20)+r|0)&r|~a&i)+t[14]-1502002290|0)<<17|n>>>15)+a|0)&a|~n&r)+t[15]+1236535329|0)<<22|i>>>10)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&a|n&~a)+t[1]-165796510|0)<<5|r>>>27)+i|0)&n|i&~n)+t[6]-1069501632|0)<<9|a>>>23)+r|0)&i|r&~i)+t[11]+643717713|0)<<14|n>>>18)+a|0)&r|a&~r)+t[0]-373897302|0)<<20|i>>>12)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&a|n&~a)+t[5]-701558691|0)<<5|r>>>27)+i|0)&n|i&~n)+t[10]+38016083|0)<<9|a>>>23)+r|0)&i|r&~i)+t[15]-660478335|0)<<14|n>>>18)+a|0)&r|a&~r)+t[4]-405537848|0)<<20|i>>>12)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&a|n&~a)+t[9]+568446438|0)<<5|r>>>27)+i|0)&n|i&~n)+t[14]-1019803690|0)<<9|a>>>23)+r|0)&i|r&~i)+t[3]-187363961|0)<<14|n>>>18)+a|0)&r|a&~r)+t[8]+1163531501|0)<<20|i>>>12)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i&a|n&~a)+t[13]-1444681467|0)<<5|r>>>27)+i|0)&n|i&~n)+t[2]-51403784|0)<<9|a>>>23)+r|0)&i|r&~i)+t[7]+1735328473|0)<<14|n>>>18)+a|0)&r|a&~r)+t[12]-1926607734|0)<<20|i>>>12)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i^n^a)+t[5]-378558|0)<<4|r>>>28)+i|0)^i^n)+t[8]-2022574463|0)<<11|a>>>21)+r|0)^r^i)+t[11]+1839030562|0)<<16|n>>>16)+a|0)^a^r)+t[14]-35309556|0)<<23|i>>>9)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i^n^a)+t[1]-1530992060|0)<<4|r>>>28)+i|0)^i^n)+t[4]+1272893353|0)<<11|a>>>21)+r|0)^r^i)+t[7]-155497632|0)<<16|n>>>16)+a|0)^a^r)+t[10]-1094730640|0)<<23|i>>>9)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i^n^a)+t[13]+681279174|0)<<4|r>>>28)+i|0)^i^n)+t[0]-358537222|0)<<11|a>>>21)+r|0)^r^i)+t[3]-722521979|0)<<16|n>>>16)+a|0)^a^r)+t[6]+76029189|0)<<23|i>>>9)+n|0,i=((i+=((n=((n+=((a=((a+=((r=((r+=(i^n^a)+t[9]-640364487|0)<<4|r>>>28)+i|0)^i^n)+t[12]-421815835|0)<<11|a>>>21)+r|0)^r^i)+t[15]+530742520|0)<<16|n>>>16)+a|0)^a^r)+t[2]-995338651|0)<<23|i>>>9)+n|0,i=((i+=((a=((a+=(i^((r=((r+=(n^(i|~a))+t[0]-198630844|0)<<6|r>>>26)+i|0)|~n))+t[7]+1126891415|0)<<10|a>>>22)+r|0)^((n=((n+=(r^(a|~i))+t[14]-1416354905|0)<<15|n>>>17)+a|0)|~r))+t[5]-57434055|0)<<21|i>>>11)+n|0,i=((i+=((a=((a+=(i^((r=((r+=(n^(i|~a))+t[12]+1700485571|0)<<6|r>>>26)+i|0)|~n))+t[3]-1894986606|0)<<10|a>>>22)+r|0)^((n=((n+=(r^(a|~i))+t[10]-1051523|0)<<15|n>>>17)+a|0)|~r))+t[1]-2054922799|0)<<21|i>>>11)+n|0,i=((i+=((a=((a+=(i^((r=((r+=(n^(i|~a))+t[8]+1873313359|0)<<6|r>>>26)+i|0)|~n))+t[15]-30611744|0)<<10|a>>>22)+r|0)^((n=((n+=(r^(a|~i))+t[6]-1560198380|0)<<15|n>>>17)+a|0)|~r))+t[13]+1309151649|0)<<21|i>>>11)+n|0,i=((i+=((a=((a+=(i^((r=((r+=(n^(i|~a))+t[4]-145523070|0)<<6|r>>>26)+i|0)|~n))+t[11]-1120210379|0)<<10|a>>>22)+r|0)^((n=((n+=(r^(a|~i))+t[2]+718787259|0)<<15|n>>>17)+a|0)|~r))+t[9]-343485551|0)<<21|i>>>11)+n|0,e[0]=r+e[0]|0,e[1]=i+e[1]|0,e[2]=n+e[2]|0,e[3]=a+e[3]|0}function u(e){for(var t=[],r=0;r<64;r+=4)t[r>>2]=e.charCodeAt(r)+(e.charCodeAt(r+1)<<8)+(e.charCodeAt(r+2)<<16)+(e.charCodeAt(r+3)<<24);return t}function c(e){for(var t=[],r=0;r<64;r+=4)t[r>>2]=e[r]+(e[r+1]<<8)+(e[r+2]<<16)+(e[r+3]<<24);return t}function r(e){for(var t,r,i,n,a=e.length,o=[1732584193,-271733879,-1732584194,271733878],s=64;s<=a;s+=64)l(o,u(e.substring(s-64,s)));for(t=(e=e.substring(s-64)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=0;s<t;s+=1)r[s>>2]|=e.charCodeAt(s)<<(s%4<<3);if(r[s>>2]|=128<<(s%4<<3),55<s)for(l(o,r),s=0;s<16;s+=1)r[s]=0;return n=(n=8*a).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),n=parseInt(n[1],16)||0,r[14]=i,r[15]=n,l(o,r),o}function o(e){for(var t=0;t<e.length;t+=1)e[t]=(e=>{for(var t="",r=0;r<4;r+=1)t+=g[e>>8*r+4&15]+g[e>>8*r&15];return t})(e[t]);return e.join("")}function i(e){return e=/[\u0080-\uFFFF]/.test(e)?unescape(encodeURIComponent(e)):e}function s(e){for(var t=[],r=e.length,i=0;i<r-1;i+=2)t.push(parseInt(e.substr(i,2),16));return String.fromCharCode.apply(String,t)}function n(){this.reset()}function a(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}var g;e.exports=(g=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],o(r("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var r=this.byteLength,e=a(e,r),i=r;return(i=void 0!==t?a(t,r):i)<e?new ArrayBuffer(0):(t=i-e,r=new ArrayBuffer(t),i=new Uint8Array(r),e=new Uint8Array(this,e,t),i.set(e),r)}),n.prototype.append=function(e){return this.appendBinary(i(e)),this},n.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;for(var t=this._buff.length,r=64;r<=t;r+=64)l(this._hash,u(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},n.prototype.end=function(e){for(var t,r=this._buff,i=r.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=0;a<i;a+=1)n[a>>2]|=r.charCodeAt(a)<<(a%4<<3);return this._finish(n,i),t=o(this._hash),e&&(t=s(t)),this.reset(),t},n.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},n.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},n.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},n.prototype._finish=function(e,t){var r,i=t;if(e[i>>2]|=128<<(i%4<<3),55<i)for(l(this._hash,e),i=0;i<16;i+=1)e[i]=0;t=(t=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(t[2],16),t=parseInt(t[1],16)||0,e[14]=r,e[15]=t,l(this._hash,e)},n.hash=function(e,t){return n.hashBinary(i(e),t)},n.hashBinary=function(e,t){e=o(r(e));return t?s(e):e},(n.ArrayBuffer=function(){this.reset()}).prototype.append=function(e){r=this._buff.buffer,i=e,(n=new Uint8Array(r.byteLength+i.byteLength)).set(new Uint8Array(r)),n.set(new Uint8Array(i),r.byteLength);var t,r,i,n,a=n,o=a.length;for(this._length+=e.byteLength,t=64;t<=o;t+=64)l(this._hash,c(a.subarray(t-64,t)));return this._buff=t-64<o?new Uint8Array(a.buffer.slice(t-64)):new Uint8Array(0),this},n.ArrayBuffer.prototype.end=function(e){for(var t,r=this._buff,i=r.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=0;a<i;a+=1)n[a>>2]|=r[a]<<(a%4<<3);return this._finish(n,i),t=o(this._hash),e&&(t=s(t)),this.reset(),t},n.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},n.ArrayBuffer.prototype.getState=function(){var e=n.prototype.getState.call(this);return e.buff=String.fromCharCode.apply(null,new Uint8Array(e.buff)),e},n.ArrayBuffer.prototype.setState=function(e){return e.buff=(e=>{for(var t=e.length,r=new ArrayBuffer(t),i=new Uint8Array(r),n=0;n<t;n+=1)i[n]=e.charCodeAt(n);return i})(e.buff),n.prototype.setState.call(this,e)},n.ArrayBuffer.prototype.destroy=n.prototype.destroy,n.ArrayBuffer.prototype._finish=n.prototype._finish,n.ArrayBuffer.hash=function(e,t){e=o((e=>{for(var t,r,i,n,a=e.length,o=[1732584193,-271733879,-1732584194,271733878],s=64;s<=a;s+=64)l(o,c(e.subarray(s-64,s)));for(t=(e=s-64<a?e.subarray(s-64):new Uint8Array(0)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=0;s<t;s+=1)r[s>>2]|=e[s]<<(s%4<<3);if(r[s>>2]|=128<<(s%4<<3),55<s)for(l(o,r),s=0;s<16;s+=1)r[s]=0;return n=(n=8*a).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),n=parseInt(n[1],16)||0,r[14]=i,r[15]=n,l(o,r),o})(new Uint8Array(e)));return t?s(e):e},n)},5822:(e,t,r)=>{let i=r(4605),d=r(6757),h=d.ANY,f=r(3708),p=r(8325),m=r(3033),E=r(7686),v=r(1103),y=r(6330);e.exports=(n,a,e,o)=>{let s,l,u,c,g;switch(n=new i(n,o),a=new f(a,o),e){case">":s=m,l=v,u=E,c=">",g=">=";break;case"<":s=E,l=y,u=m,c="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(p(n,a,o))return!1;for(let i=0;i<a.set.length;++i){let e=a.set[i],t=null,r=null;if(e.forEach(e=>{e.semver===h&&(e=new d(">=0.0.0")),t=t||e,r=r||e,s(e.semver,t.semver,o)?t=e:u(e.semver,r.semver,o)&&(r=e)}),t.operator===c||t.operator===g)return!1;if((!r.operator||r.operator===c)&&l(n,r.semver))return!1;if(r.operator===g&&u(n,r.semver))return!1}return!0}},5919:(e,t,r)=>{let o=r(3708),i=r(6757),f=i.ANY,p=r(8325),m=r(9043),E=[new i(">=0.0.0-0")],v=[new i(">=0.0.0")],y=(e,t,r)=>!e||!(0<(r=m(e.semver,t.semver,r)))&&(r<0||">"===t.operator&&">="===e.operator)?t:e,b=(e,t,r)=>!e||!((r=m(e.semver,t.semver,r))<0)&&(0<r||"<"===t.operator&&"<="===e.operator)?t:e;e.exports=(e,n,a={})=>{if(e!==n){e=new o(e,a),n=new o(n,a);let i=!1;e:for(let r of e.set){for(let t of n.set){let e=((t,r,i)=>{if(t===r)return!0;if(1===t.length&&t[0].semver===f){if(1===r.length&&r[0].semver===f)return!0;t=i.includePrerelease?E:v}if(1===r.length&&r[0].semver===f){if(i.includePrerelease)return!0;r=v}let n=new Set,a,o,s,l,u,c,g;for(let e of t)">"===e.operator||">="===e.operator?a=y(a,e,i):"<"===e.operator||"<="===e.operator?o=b(o,e,i):n.add(e.semver);if(1<n.size)return null;if(a&&o){if(0<(s=m(a.semver,o.semver,i)))return null;if(0===s&&(">="!==a.operator||"<="!==o.operator))return null}for(let t of n){if(a&&!p(t,String(a),i))return null;if(o&&!p(t,String(o),i))return null;for(let e of r)if(!p(t,String(e),i))return!1;return!0}let d=!(!o||i.includePrerelease||!o.semver.prerelease.length)&&o.semver,h=!(!a||i.includePrerelease||!a.semver.prerelease.length)&&a.semver;d&&1===d.prerelease.length&&"<"===o.operator&&0===d.prerelease[0]&&(d=!1);for(let e of r){if(g=g||">"===e.operator||">="===e.operator,c=c||"<"===e.operator||"<="===e.operator,a)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),">"===e.operator||">="===e.operator){if((l=y(a,e,i))===e&&l!==a)return!1}else if(">="===a.operator&&!p(a.semver,String(e),i))return!1;if(o)if(d&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===d.major&&e.semver.minor===d.minor&&e.semver.patch===d.patch&&(d=!1),"<"===e.operator||"<="===e.operator){if((u=b(o,e,i))===e&&u!==o)return!1}else if("<="===o.operator&&!p(o.semver,String(e),i))return!1;if(!e.operator&&(o||a)&&0!==s)return!1}return!(a&&c&&!o&&0!==s||o&&g&&!a&&0!==s||h||d)})(r,t,a);if(i=i||null!==e,e)continue e}if(i)return!1}}return!0}},6011:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeStringify=void 0;let i=r(9746),n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function a(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}t.unsafeStringify=a,t.default=function(e,t=0){e=a(e,t);if((0,i.default)(e))return e;throw TypeError("Stringified UUID is invalid")}},6078:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Evaluator=void 0,t.isInShardRange=s,t.hashKey=u,t.noneResult=f,t.matchesRules=p,t.overrideResult=function(e,t,r,i,n){var a="override-"+i.key;return{flagKey:e,subjectKey:t,variation:i,subjectAttributes:r,flagEvaluationDetails:n.setMatch(0,i,{key:a,splits:[],doLog:!1},null,void 0).build("MATCH","Flag override applied"),doLog:!1,format:"",allocationKey:a,extraLogging:{},entityId:null}};let l=r(8475),n=r(3977),a=r(9139),o=r(4736),i=r(8807);function s(e,t){return t.start<=e&&e<t.end}function u(e,t){return e+"-"+t}function f(e,t,r,i,n){return{flagKey:e,format:n,subjectKey:t,subjectAttributes:r,allocationKey:null,variation:null,extraLogging:{},doLog:!1,flagEvaluationDetails:i,entityId:null}}function p(e,r,i){if(!e.length)return{matched:!0,matchedRule:null};let n=null;return e.some(e=>{var t=(0,o.matchesRule)(e,r,i);return t&&(n=e),t})?{matched:!0,matchedRule:n}:{matched:!1,matchedRule:null}}t.Evaluator=class{constructor(e){this.getMatchedEvaluationCodeAndDescription=(r,e,t,i,n)=>{var a,o,s;if((0,l.checkValueTypeMatch)(n,r.value))return a=!!e.rules?.length,s=1<e.splits.length,o=1<t.shards.length,s=s||o,a&&s?{flagEvaluationCode:"MATCH",flagEvaluationDescription:`Supplied attributes match rules defined in allocation "${e.key}" and ${i} belongs to the range of traffic assigned to "${t.variationKey}".`}:a&&!s?{flagEvaluationCode:"MATCH",flagEvaluationDescription:`Supplied attributes match rules defined in allocation "${e.key}".`}:{flagEvaluationCode:"MATCH",flagEvaluationDescription:`${i} belongs to the range of traffic assigned to "${t.variationKey}" defined in allocation "${e.key}".`};{let{key:e,value:t}=r;return{flagEvaluationCode:"ASSIGNMENT_ERROR",flagEvaluationDescription:`Variation (${e}) is configured for type ${n}, but is set to incompatible value (${t})`}}},this.sharder=e??new i.MD5Sharder}evaluateFlag(s,l,u,c,r,g){let d=new n.FlagEvaluationDetailsBuilder(l.configEnvironment.name,s.allocations,l.configFetchedAt,l.configPublishedAt);try{if(!s.enabled)return f(s.key,u,c,d.buildForNoneResult("FLAG_UNRECOGNIZED_OR_DISABLED","Unrecognized or disabled flag: "+s.key),l.configFormat);let t=new Date;for(let o=0;o<s.allocations.length;o++){let a=s.allocations[o],e=e=>{d.addUnmatchedAllocation({key:a.key,allocationEvaluationCode:e,orderPosition:o+1})};if(a.startAt&&t<new Date(a.startAt))e(n.AllocationEvaluationCode.BEFORE_START_TIME);else if(a.endAt&&t>new Date(a.endAt))e(n.AllocationEvaluationCode.AFTER_END_TIME);else{var{matched:i,matchedRule:h}=p(a?.rules??[],{id:u,...c},r);if(i){for(let n of a.splits)if(n.shards.every(e=>this.matchesShard(e,u,s.totalShards))){let e=s.variations[n.variationKey],{flagEvaluationCode:t,flagEvaluationDescription:r}=this.getMatchedEvaluationCodeAndDescription(e,a,n,u,g),i=d.setMatch(o,e,a,h,g).build(t,r);return{flagKey:s.key,format:l.configFormat,subjectKey:u,subjectAttributes:c,allocationKey:a.key,variation:e,extraLogging:n.extraLogging??{},doLog:a.doLog,flagEvaluationDetails:i,entityId:s.entityId??null}}e(n.AllocationEvaluationCode.TRAFFIC_EXPOSURE_MISS)}else e(n.AllocationEvaluationCode.FAILING_RULE)}}return f(s.key,u,c,d.buildForNoneResult("DEFAULT_ALLOCATION_NULL",'No allocations matched. Falling back to "Default Allocation", serving NULL'),l.configFormat)}catch(s){console.error(">>>>",s);let t=d.gracefulBuild("ASSIGNMENT_ERROR","Assignment Error: "+s.message);if(t){let e=new a.FlagEvaluationError(s.message);throw e.flagEvaluationDetails=t,e}throw s}}matchesShard(e,t,r){let i=this.sharder.getShard(e.salt+"-"+t,r);return e.ranges.some(e=>s(i,e))}}},6092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMD5Hash=o,t.buildStorageKeySuffix=function(e){return o(e).slice(0,16)},t.encodeBase64=s,t.attributeEncodeBase64=a,t.decodeBase64=function(e){return i.decode(e)},t.obfuscatePrecomputedBanditMap=function(r,e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[o(e,r),{banditKey:s((e=t).banditKey),action:s(e.action),actionProbability:e.actionProbability,optimalityGap:e.optimalityGap,modelVersion:s(e.modelVersion),actionNumericAttributes:l(e.actionNumericAttributes),actionCategoricalAttributes:l(e.actionCategoricalAttributes)}]))},t.obfuscatePrecomputedFlags=function(i,n){let a={};return Object.keys(n).forEach(e=>{var t=n[e],r=Object.fromEntries(Object.entries(t.extraLogging??{}).map(e=>e.map(s))),e=o(e,i);a[e]={flagKey:e,variationType:t.variationType,extraLogging:r,doLog:t.doLog,allocationKey:s(t.allocationKey??""),variationKey:s(t.variationKey??""),variationValue:s(t.variationValue)}}),a};let i=r(8127),n=r(5735);function o(e,t=""){return(new n).append(t).append(e).end()}function s(e){return i.encode(e)}function a(e){return s("string"!=typeof e?String(e):e)}function l(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[s(e),a(t)]))}},6330:(e,t,r)=>{let i=r(9043);e.exports=(e,t,r)=>0<=i(e,t,r)},6356:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let n=r(6011),a=r(1425),o=r(6568);t.default=function(e,t,r){e??={},r??=0;var i=(0,a.default)({...e,_v6:!0},new Uint8Array(16)),i=(0,o.default)(i);if(t){for(let e=0;e<16;e++)t[r+e]=i[e];return t}return(0,n.unsafeStringify)(i)}},6396:(e,t,r)=>{let i=r(9043);e.exports=(e,t)=>i(e,t,!0)},6568:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(1797),n=r(6011);t.default=function(e){t="string"==typeof e?(0,i.default)(e):e;var t=Uint8Array.of((15&t[6])<<4|t[7]>>4&15,(15&t[7])<<4|(240&t[4])>>4,(15&t[4])<<4|(240&t[5])>>4,(15&t[5])<<4|(240&t[0])>>4,(15&t[0])<<4|(240&t[1])>>4,(15&t[1])<<4|(240&t[2])>>4,96|15&t[2],t[3],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]);return"string"==typeof e?(0,n.unsafeStringify)(t):t}},6615:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BoundedEventQueue=void 0;let n=r(4742),i=r(6882);class a{constructor(e,t=new Array,r=i.MAX_EVENT_QUEUE_SIZE){this.name=e,this.queue=t,this.maxSize=r}get length(){return this.queue.length}splice(e){return this.queue.splice(e)}isEmpty(){return 0===this.queue.length}[Symbol.iterator](){return this.queue[Symbol.iterator]()}push(...e){for(var{name:t,maxSize:r,queue:i}=this;i.length<r&&0<e.length;)i.push(...e.splice(0,1));0<e.length&&n.logger.warn(`Dropping ${e.length} events for queue ${t} since maxSize of ${r} reached.`)}flush(){var e=[...this.queue];return this.queue.length=0,e}}t.BoundedEventQueue=a},6697:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i},6757:(e,t,r)=>{let i=Symbol("SemVer ANY");e.exports=class g{static get ANY(){return i}constructor(e,t){if(t=n(t),e instanceof g){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===i?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){var t=this.options.loose?a[o.COMPARATORLOOSE]:a[o.COMPARATOR];if(!(t=e.match(t)))throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==t[1]?t[1]:"","="===this.operator&&(this.operator=""),this.semver=t[2]?new u(t[2],this.options.loose):i}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return s(e,this.operator,this.semver,this.options)}intersects(e,t){if(e instanceof g)return""===this.operator?""===this.value||new c(e.value,t).test(this.value):""===e.operator?""===e.value||new c(this.value,t).test(e.semver):!((t=n(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(s(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(s(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")));throw new TypeError("a Comparator is required")}};let n=r(6990),{safeRe:a,t:o}=r(4065),s=r(1948),l=r(1721),u=r(4605),c=r(3708)},6814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChromeStorageEngine=void 0;let i=r(4406);t.ChromeStorageEngine=class{constructor(e,t){this.storageMap=e,this.getContentsJsonString=async()=>{var e=await this.storageMap.get(this.contentsKey);return null!=e?e:null},this.getMetaJsonString=async()=>{var e=await this.storageMap.get(this.metaKey);return null!=e?e:null},this.setContentsJsonString=async e=>{await this.storageMap.set(this.contentsKey,e)},this.setMetaJsonString=async e=>{await this.storageMap.set(this.metaKey,e)};e=t?"-"+t:"";this.contentsKey=i.CONFIGURATION_KEY+e,this.metaKey=i.META_KEY+e}}},6846:(e,t,r)=>{let u=r(8325),c=r(9043);e.exports=(e,t,r)=>{var i=[];let n=null,a=null;var o=e.sort((e,t)=>c(e,t,r));for(let e of o)n=u(e,t,r)?(a=e,n||e):(a&&i.push([n,a]),a=null,null);n&&i.push([n,null]);var s=[];for(let[e,t]of i)e===t?s.push(e):t||e!==o[0]?t?e===o[0]?s.push("<="+t):s.push(e+" - "+t):s.push(">="+e):s.push("*");var e=s.join(" || "),l="string"==typeof t.raw?t.raw:String(t);return e.length<l.length?e:t}},6882:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OBFUSCATED_FORMATS=t.DEFAULT_TLRU_TTL_MS=t.BANDIT_ASSIGNMENT_SHARDS=t.MAX_EVENT_QUEUE_SIZE=t.NULL_SENTINEL=t.SESSION_ASSIGNMENT_CONFIG_LOADED=t.PRECOMPUTED_FLAGS_ENDPOINT=t.PRECOMPUTED_BASE_URL=t.BANDIT_ENDPOINT=t.UFC_ENDPOINT=t.BASE_URL=t.DEFAULT_POLL_CONFIG_REQUEST_RETRIES=t.DEFAULT_INITIAL_CONFIG_REQUEST_RETRIES=t.POLL_JITTER_PCT=t.DEFAULT_POLL_INTERVAL_MS=t.REQUEST_TIMEOUT_MILLIS=t.DEFAULT_REQUEST_TIMEOUT_MS=void 0;r=r(4619);t.DEFAULT_REQUEST_TIMEOUT_MS=5e3,t.REQUEST_TIMEOUT_MILLIS=t.DEFAULT_REQUEST_TIMEOUT_MS,t.DEFAULT_POLL_INTERVAL_MS=3e4,t.POLL_JITTER_PCT=.1,t.DEFAULT_INITIAL_CONFIG_REQUEST_RETRIES=1,t.DEFAULT_POLL_CONFIG_REQUEST_RETRIES=7,t.BASE_URL="https://fscdn.eppo.cloud/api",t.UFC_ENDPOINT="/flag-config/v1/config",t.BANDIT_ENDPOINT="/flag-config/v1/bandits",t.PRECOMPUTED_BASE_URL="https://fs-edge-assignment.eppo.cloud",t.PRECOMPUTED_FLAGS_ENDPOINT="/assignments",t.SESSION_ASSIGNMENT_CONFIG_LOADED="eppo-session-assignment-config-loaded",t.NULL_SENTINEL="EPPO_NULL",t.MAX_EVENT_QUEUE_SIZE=100,t.BANDIT_ASSIGNMENT_SHARDS=1e4,t.DEFAULT_TLRU_TTL_MS=6e5,t.OBFUSCATED_FORMATS=[r.FormatEnum.CLIENT,r.FormatEnum.PRECOMPUTED]},6965:(e,t,r)=>{let i=r(4605);e.exports=(e,t)=>new i(e,t).major},6990:e=>{let t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},6999:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationWireV1=t.ObfuscatedPrecomputedConfigurationResponse=t.PrecomputedConfigurationResponse=t.PrecomputedConfiguration=void 0;let i=r(4619),o=r(6092);class n{constructor(e,t,r){this.subjectKey=e,this.subjectAttributes=t,this.environment=r,this.format=i.FormatEnum.PRECOMPUTED,this.createdAt=(new Date).toISOString()}}t.PrecomputedConfiguration=class l{constructor(e,t,r){this.response=e,this.subjectKey=t,this.subjectAttributes=r}static obfuscated(e,t,r,i,n,a){return t=new s(e,t,r,i,n,a),new l(JSON.stringify(t),e,n)}static unobfuscated(e,t,r,i,n){return t=new a(e,t,r,i,n),new l(JSON.stringify(t),e,i)}};class a extends n{constructor(e,t,r,i,n){super(e,i,n),this.flags=t,this.bandits=r,this.obfuscated=!1}}t.PrecomputedConfigurationResponse=a;class s extends n{constructor(e,t,r,i,n,a){super(e,n,a),this.obfuscated=!0,this.salt=i,this.bandits=(0,o.obfuscatePrecomputedBanditMap)(this.salt,r),this.flags=(0,o.obfuscatePrecomputedFlags)(this.salt,t)}}t.ObfuscatedPrecomputedConfigurationResponse=s,t.ConfigurationWireV1=class{constructor(e){this.precomputed=e,this.version=1}}},7029:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringValuedAsyncStore=void 0,t.StringValuedAsyncStore=class{constructor(e,t=0){this.storageEngine=e,this.cooldownSeconds=t,this.initialized=!1}isInitialized(){return this.initialized}async isExpired(){if(!this.cooldownSeconds)return!0;var e=await this.storageEngine.getMetaJsonString();let t=!0;return e&&(e=JSON.parse(e).lastUpdatedAtMs,t=!e||Date.now()-e>1e3*this.cooldownSeconds),t}async entries(){var e=await this.storageEngine.getContentsJsonString();return e?JSON.parse(e):{}}async setEntries(e){await this.storageEngine.setContentsJsonString(JSON.stringify(e));e={lastUpdatedAtMs:(new Date).getTime()};await this.storageEngine.setMetaJsonString(JSON.stringify(e)),this.initialized=!0}}},7043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assignmentCacheFactory=void 0;let n=r(1552),a=r(2415),o=r(4035),s=r(1726),l=r(1479);t.assignmentCacheFactory=function({forceMemoryOnly:e=!1,chromeStorage:t,storageKeySuffix:r}){var i=new l.default;if(!e){if(t){let e=new a.default(t);return new o.default(i,e)}if((0,n.hasWindowLocalStorage)()){let e=new s.LocalStorageAssignmentCache(r);return new o.default(i,e)}}return i}},7059:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HttpRequestError=void 0;class o extends Error{constructor(e,t,r){super(e),this.message=e,this.status=t,(this.cause=r)&&(this.cause=r)}}t.HttpRequestError=o,t.default=class{constructor(e,t){this.apiEndpoints=e,this.timeout=t}async getUniversalFlagConfiguration(){var e=this.apiEndpoints.ufcEndpoint();return this.rawGet(e)}async getBanditParameters(){var e=this.apiEndpoints.banditParametersEndpoint();return this.rawGet(e)}async getPrecomputedFlags(e){var t=this.apiEndpoints.precomputedFlagsEndpoint();return this.rawPost(t,e)}async rawGet(n){try{let e=new AbortController,t=e.signal,r=setTimeout(()=>e.abort(),this.timeout),i=await fetch(n.toString(),{signal:t});if(clearTimeout(r),i?.ok)return await i.json();throw new o("Failed to fetch data",i?.status)}catch(n){if("AbortError"===n.name)throw new o("Request timed out",408,n);if(n instanceof o)throw n;throw new o("Network error",0,n)}}async rawPost(n,a){try{let e=new AbortController,t=e.signal,r=setTimeout(()=>e.abort(),this.timeout),i=await fetch(n.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),signal:t});if(clearTimeout(r),i?.ok)return await i.json();{let e=await i.text();throw new o(e||"Failed to post data",i?.status)}}catch(n){if("AbortError"===n.name)throw new o("Request timed out",408,n);if(n instanceof o)throw n;throw new o("Network error",0,n)}}}},7063:(e,t,r)=>{let i=r(5822);e.exports=(e,t,r)=>i(e,t,"<",r)},7309:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageEngine=void 0;let i=r(4406);t.LocalStorageEngine=class{constructor(e,t){this.localStorage=e,this.getContentsJsonString=async()=>this.localStorage.getItem(this.contentsKey),this.getMetaJsonString=async()=>this.localStorage.getItem(this.metaKey),this.setContentsJsonString=async e=>{this.localStorage.setItem(this.contentsKey,e)},this.setMetaJsonString=async e=>{this.localStorage.setItem(this.metaKey,e)};e=t?"-"+t:"";this.contentsKey=i.CONFIGURATION_KEY+e,this.metaKey=i.META_KEY+e}}},7607:(e,t,r)=>{let u=r(4605),c=r(1147),{safeRe:g,t:d}=r(4065);e.exports=(t,r)=>{if(t instanceof u)return t;if("string"!=typeof(t="number"==typeof t?String(t):t))return null;let i=null;if((r=r||{}).rtl){let e=r.includePrerelease?g[d.COERCERTLFULL]:g[d.COERCERTL];for(var n;(n=e.exec(t))&&(!i||i.index+i[0].length!==t.length);)i&&n.index+n[0].length===i.index+i[0].length||(i=n),e.lastIndex=n.index+n[1].length+n[2].length;e.lastIndex=-1}else i=t.match(r.includePrerelease?g[d.COERCEFULL]:g[d.COERCE]);var e,a,o,s,l;return null===i?null:(e=i[2],a=i[3]||"0",o=i[4]||"0",s=r.includePrerelease&&i[5]?"-"+i[5]:"",l=r.includePrerelease&&i[6]?"+"+i[6]:"",c(e+`.${a}.`+o+s+l,r))}},7615:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.waitForMs=async function(t){await new Promise(e=>setTimeout(e,t))},t.shallowClone=function(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),e)}},7686:(e,t,r)=>{let i=r(9043);e.exports=(e,t,r)=>i(e,t,r)<0},7778:(e,t,r)=>{let i=r(2034);e.exports=(e,r)=>e.sort((e,t)=>i(e,t,r))},7791:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LIB_VERSION=void 0;r=r(1461);t.LIB_VERSION=r.version},7989:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractAssignmentCache=void 0,t.assignmentCacheKeyToString=n,t.assignmentCacheValueToString=a;let i=r(6092);function n({subjectKey:e,flagKey:t}){return(0,i.getMD5Hash)([e,t].join(";"))}function a(e){return(0,i.getMD5Hash)(Object.values(e).join(";"))}t.AbstractAssignmentCache=class{constructor(e){this.delegate=e}has(e){return this.get(e)===a(e)}get(e){return this.delegate.get(n(e))}set(e){this.delegate.set(n(e),a(e))}entries(){return this.delegate.entries()}}},8127:function(e,j,t){function r(e){return e.replace(/=/g,"").replace(/[+\/]/g,function(e){return"+"==e?"-":"_"})}function i(e){for(var t,r,i,n="",a=e.length%3,o=0;o<e.length;){if(255<(t=e.charCodeAt(o++))||255<(r=e.charCodeAt(o++))||255<(i=e.charCodeAt(o++)))throw new TypeError("invalid character found");n+=S[(t=t<<16|r<<8|i)>>18&63]+S[t>>12&63]+S[t>>6&63]+S[63&t]}return a?n.slice(0,a-3)+"===".substring(a):n}function n(e,t){return(t=void 0===t?!1:t)?r(_(e)):_(e)}function a(e){var t;return e.length<2?(t=e.charCodeAt(0))<128?e:t<2048?C(192|t>>>6)+C(128|63&t):C(224|t>>>12&15)+C(128|t>>>6&63)+C(128|63&t):(t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320),C(240|t>>>18&7)+C(128|t>>>12&63)+C(128|t>>>6&63)+C(128|63&t))}function o(e){return e.replace(N,a)}function s(e,t){return(t=void 0===t?!1:t)?r(L(e)):L(e)}function l(e){return s(e,!0)}function u(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return C(55296+(t>>>10))+C(56320+(1023&t));case 3:return C((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return C((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}}function c(e){return e.replace(R,u)}function g(e){if(e=e.replace(/\s+/g,""),!O.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));for(var t,r,i,n="",a=0;a<e.length;)t=A[e.charAt(a++)]<<18|A[e.charAt(a++)]<<12|(r=A[e.charAt(a++)])<<6|(i=A[e.charAt(a++)]),n+=64===r?C(t>>16&255):64===i?C(t>>16&255,t>>8&255):C(t>>16&255,t>>8&255,255&t);return n}function d(e){return M(h(e))}function h(e){return I(e.replace(/[-_]/g,function(e){return"-"==e?"+":"/"}))}function f(e){return D(h(e))}function p(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}}function m(){function e(e,t){Object.defineProperty(String.prototype,e,p(t))}e("fromBase64",function(){return f(this)}),e("toBase64",function(e){return s(this,e)}),e("toBase64URI",function(){return s(this,!0)}),e("toBase64URL",function(){return s(this,!0)}),e("toUint8Array",function(){return d(this)})}function E(){function e(e,t){Object.defineProperty(Uint8Array.prototype,e,p(t))}e("toBase64",function(e){return n(this,e)}),e("toBase64URI",function(){return n(this,!0)}),e("toBase64URL",function(){return n(this,!0)})}var v,y,b,S,A,O,C,w,I,T,_,N,L,R,P,M,D,F;"undefined"==typeof self&&"undefined"==typeof window&&void 0!==t.g&&t.g,e.exports=(t="function"==typeof Buffer,y="function"==typeof TextDecoder?new TextDecoder:void 0,b="function"==typeof TextEncoder?new TextEncoder:void 0,S=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),v={},S.forEach(function(e,t){return v[e]=t}),A=v,O=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,C=String.fromCharCode.bind(String),w="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e){return new Uint8Array(Array.prototype.slice.call(e,0))},I=function(e){return e.replace(/[^A-Za-z0-9\+\/]/g,"")},T="function"==typeof btoa?function(e){return btoa(e)}:t?function(e){return Buffer.from(e,"binary").toString("base64")}:i,_=t?function(e){return Buffer.from(e).toString("base64")}:function(e){for(var t=[],r=0,i=e.length;r<i;r+=4096)t.push(C.apply(null,e.subarray(r,r+4096)));return T(t.join(""))},N=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,L=t?function(e){return Buffer.from(e,"utf8").toString("base64")}:b?function(e){return _(b.encode(e))}:function(e){return T(o(e))},R=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,P="function"==typeof atob?function(e){return atob(I(e))}:t?function(e){return Buffer.from(e,"base64").toString("binary")}:g,M=t?function(e){return w(Buffer.from(e,"base64"))}:function(e){return w(P(e).split("").map(function(e){return e.charCodeAt(0)}))},D=t?function(e){return Buffer.from(e,"base64").toString("utf8")}:y?function(e){return y.decode(M(e))}:function(e){return c(P(e))},F={version:"3.7.7",VERSION:"3.7.7",atob:P,atobPolyfill:g,btoa:T,btoaPolyfill:i,fromBase64:f,toBase64:s,encode:s,encodeURI:l,encodeURL:l,utob:o,btou:c,decode:f,isValid:function(e){return"string"==typeof e&&(e=e.replace(/\s+/g,"").replace(/={0,2}$/,""),!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e))},fromUint8Array:n,toUint8Array:d,extendString:m,extendUint8Array:E,extendBuiltins:function(){m(),E()},Base64:{}},Object.keys(F).forEach(function(e){return F.Base64[e]=F[e]}),F)},8286:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let n=r(3779),a=r(2291),o=r(6011);t.default=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();var i=(e=e||{}).random??e.rng?.()??(0,a.default)();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=i[e];return t}return(0,o.unsafeStringify)(i)}},8325:(e,t,r)=>{let i=r(3708);e.exports=(e,t,r)=>{try{t=new i(t,r)}catch(e){return!1}return t.test(e)}},8475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkTypeMatch=R,t.checkValueTypeMatch=function(e,t){if(null==e)return!0;switch(e){case C.VariationType.STRING:return"string"==typeof t;case C.VariationType.BOOLEAN:return"boolean"==typeof t;case C.VariationType.INTEGER:return"number"==typeof t&&Number.isInteger(t);case C.VariationType.NUMERIC:return"number"==typeof t;case C.VariationType.JSON:return"string"==typeof t;default:return!1}};let i=r(182),p=r(4620),m=r(4742),f=r(318),s=r(3585),n=r(2094),a=r(9851),o=r(664),E=r(4224),l=r(9864),u=r(6999),v=r(6882),c=r(1650),g=r(4617),d=r(6078),h=r(6615),y=r(391),b=r(3977),S=r(9139),A=r(7059),O=r(2091),C=r(4619),w=r(6092),I=r(204),T=r(3621),_=r(7615),N=r(4388),L=r(7791);function R(e,t){return void 0===e||t===e}t.default=class{constructor({eventDispatcher:e=new y.default,isObfuscated:t=!1,flagConfigurationStore:r,banditVariationConfigurationStore:i,banditModelConfigurationStore:n,overrideStore:a,configurationRequestParameters:o}){this.assignmentEventsQueue=new h.BoundedEventQueue("assignments"),this.banditEventsQueue=new h.BoundedEventQueue("bandit"),this.banditEvaluator=new s.BanditEvaluator,this.isGracefulFailureMode=!0,this.obfuscationMismatchWarningIssued=!1,this.evaluator=new d.Evaluator,this.overrideValidator=new I.OverrideValidator,this.eventDispatcher=e,this.flagConfigurationStore=r,this.banditVariationConfigurationStore=i,this.banditModelConfigurationStore=n,this.overrideStore=a,this.configurationRequestParameters=o,this.expectObfuscated=t}getConfiguration(){return this.configurationRequestor?this.configurationRequestor.getConfiguration():new O.StoreBackedConfiguration(this.flagConfigurationStore,this.banditVariationConfigurationStore,this.banditModelConfigurationStore)}maybeWarnAboutObfuscationMismatch(e){e===this.expectObfuscated||this.obfuscationMismatchWarningIssued?e===this.expectObfuscated&&(this.obfuscationMismatchWarningIssued=!1):(this.obfuscationMismatchWarningIssued=!0,m.logger.warn(`[Eppo SDK] configuration obfuscation [${e}] does not match expected [${this.expectObfuscated}]`))}isObfuscated(e){return void 0===this.configObfuscatedCache&&(this.configObfuscatedCache=e.isObfuscated()),this.maybeWarnAboutObfuscationMismatch(this.configObfuscatedCache),this.configObfuscatedCache}async parseOverrides(e){if(e)return e=this.overrideValidator.parseOverridePayload(e),await this.overrideValidator.validateKey(e.browserExtensionKey),e.overrides}withOverrides(e){var t;return e&&Object.keys(e).length?((t=(0,_.shallowClone)(this)).overrideStore=new l.MemoryOnlyConfigurationStore,t.overrideStore.setEntries(e),t):this}setConfigurationRequestParameters(e){this.configurationRequestParameters=e}setFlagConfigurationStore(e){this.flagConfigurationStore=e,this.configObfuscatedCache=void 0}setBanditVariationConfigurationStore(e){this.banditVariationConfigurationStore=e}setEventDispatcher(e){this.eventDispatcher=e}setContext(e,t){this.eventDispatcher?.attachContext(e,t)}setBanditModelConfigurationStore(e){this.banditModelConfigurationStore=e}setIsObfuscated(e){this.expectObfuscated=e}setOverrideStore(e){this.overrideStore=e}unsetOverrideStore(){this.overrideStore=void 0}getOverrideVariationKeys(){return Object.fromEntries(Object.entries(this.overrideStore?.entries()??{}).map(([e,t])=>[e,t.key]))}async fetchFlagConfigurations(){if(!this.configurationRequestParameters)throw new Error("Eppo SDK unable to fetch flag configurations without configuration request parameters");this.requestPoller?.stop();var{apiKey:e,sdkName:t,sdkVersion:r,baseUrl:i,requestTimeoutMs:n=v.DEFAULT_REQUEST_TIMEOUT_MS,numInitialRequestRetries:a=v.DEFAULT_INITIAL_CONFIG_REQUEST_RETRIES,numPollRequestRetries:o=v.DEFAULT_POLL_CONFIG_REQUEST_RETRIES,pollAfterSuccessfulInitialization:s=!1,pollAfterFailedInitialization:l=!1,throwOnFailedInitialization:u=!1,skipInitialPoll:c=!1}=this.configurationRequestParameters;let{pollingIntervalMs:g=v.DEFAULT_POLL_INTERVAL_MS}=this.configurationRequestParameters,d=(g<=0&&(m.logger.error("pollingIntervalMs must be greater than 0. Using default"),g=v.DEFAULT_POLL_INTERVAL_MS),new p.default({baseUrl:i,queryParams:{apiKey:e,sdkName:t,sdkVersion:r}})),h=new A.default(d,n),f=new E.default(h,this.flagConfigurationStore,this.banditVariationConfigurationStore??null,this.banditModelConfigurationStore??null);this.requestPoller=(0,T.default)(g,async()=>{if(await f.isFlagConfigExpired())return this.configObfuscatedCache=void 0,f.fetchAndStoreConfigurations()},{maxStartRetries:a,maxPollRetries:o,pollAfterSuccessfulStart:s,pollAfterFailedStart:l,errorOnFailedStart:u,skipInitialPoll:c}),await this.requestPoller.start()}stopPolling(){this.requestPoller&&this.requestPoller.stop()}getStringAssignment(e,t,r,i){return this.getStringAssignmentDetails(e,t,r,i).variation}getStringAssignmentDetails(e,t,r,i){var{eppoValue:e,flagEvaluationDetails:t}=this.getAssignmentVariation(e,t,r,g.EppoValue.String(i),C.VariationType.STRING);return{variation:e.stringValue??i,action:null,evaluationDetails:t}}getBoolAssignment(e,t,r,i){return this.getBooleanAssignment(e,t,r,i)}getBooleanAssignment(e,t,r,i){return this.getBooleanAssignmentDetails(e,t,r,i).variation}getBooleanAssignmentDetails(e,t,r,i){var{eppoValue:e,flagEvaluationDetails:t}=this.getAssignmentVariation(e,t,r,g.EppoValue.Bool(i),C.VariationType.BOOLEAN);return{variation:e.boolValue??i,action:null,evaluationDetails:t}}getIntegerAssignment(e,t,r,i){return this.getIntegerAssignmentDetails(e,t,r,i).variation}getIntegerAssignmentDetails(e,t,r,i){var{eppoValue:e,flagEvaluationDetails:t}=this.getAssignmentVariation(e,t,r,g.EppoValue.Numeric(i),C.VariationType.INTEGER);return{variation:e.numericValue??i,action:null,evaluationDetails:t}}getNumericAssignment(e,t,r,i){return this.getNumericAssignmentDetails(e,t,r,i).variation}getNumericAssignmentDetails(e,t,r,i){var{eppoValue:e,flagEvaluationDetails:t}=this.getAssignmentVariation(e,t,r,g.EppoValue.Numeric(i),C.VariationType.NUMERIC);return{variation:e.numericValue??i,action:null,evaluationDetails:t}}getJSONAssignment(e,t,r,i){return this.getJSONAssignmentDetails(e,t,r,i).variation}getJSONAssignmentDetails(e,t,r,i){var{eppoValue:e,flagEvaluationDetails:t}=this.getAssignmentVariation(e,t,r,g.EppoValue.JSON(i),C.VariationType.JSON);return{variation:e.objectValue??i,action:null,evaluationDetails:t}}getBanditAction(e,t,r,i,n){var{variation:e,action:t}=this.getBanditActionDetails(e,t,r,i,n);return{variation:e,action:t}}getBestAction(e,i,n,t){let a=this.getConfiguration(),o=null;var s=a.getFlagBanditVariations(e)?.at(0)?.key;if(s){let r=a.getBandit(s);if(r){let e=(0,f.ensureContextualSubjectAttributes)(i),t=(0,f.ensureActionsWithContextualAttributes)(n);o=this.banditEvaluator.evaluateBestBanditAction(e,t,r.modelData)}}return o??t}getBanditActionDetails(t,r,e,i,n){var a=this.getConfiguration();let o=n,s=null,l=this.newFlagEvaluationDetailsBuilder(a,t).buildForNoneResult("ASSIGNMENT_ERROR","Unexpected error getting assigned variation for bandit action");try{var u=(0,f.ensureNonContextualSubjectAttributes)(e),{variation:c,evaluationDetails:g}=this.getStringAssignmentDetails(t,r,u,n),d=(o=c,l=g,a.getFlagVariationBandit(t,o));if(!d)return{variation:o,action:null,evaluationDetails:l};l.banditKey=d.banditKey;var h=this.evaluateBanditAction(t,r,e,i,d.modelData);if(h?.actionKey){s=h.actionKey;let e={timestamp:(new Date).toISOString(),featureFlag:t,bandit:d.banditKey,subject:r,action:s,actionProbability:h.actionWeight,optimalityGap:h.optimalityGap,modelVersion:d.modelVersion,subjectNumericAttributes:h.subjectAttributes.numericAttributes,subjectCategoricalAttributes:h.subjectAttributes.categoricalAttributes,actionNumericAttributes:h.actionAttributes.numericAttributes,actionCategoricalAttributes:h.actionAttributes.categoricalAttributes,metaData:this.buildLoggerMetadata(),evaluationDetails:l};try{this.logBanditAction(e)}catch(t){m.logger.error("Error logging bandit event",t)}l.banditAction=s}}catch(t){if(m.logger.error("Error determining bandit action",t),!this.isGracefulFailureMode)throw t;o&&(l.flagEvaluationCode="BANDIT_ERROR"),l.flagEvaluationDescription="Error evaluating bandit action: "+t.message}return{variation:o,action:s,evaluationDetails:l}}getExperimentContainerEntry(e,t,r){var{flagKey:e,controlVariationEntry:i,treatmentVariationEntries:n}=e,e=this.getStringAssignment(e,t,r,"control");return"control"===e?i:!e.startsWith("treatment-")||(t=Number.parseInt(e.split("-")[1])-1,isNaN(t))?(m.logger.warn(`Variation '${e}' cannot be mapped to a container. Defaulting to control variation.`),i):t>=n.length?(m.logger.warn(`Selected treatment variation (${t}) index is out of bounds. Defaulting to control variation.`),i):n[t]}evaluateBanditAction(e,t,r,i,n){return Object.keys(i).length?(r=(0,f.ensureContextualSubjectAttributes)(r),i=(0,f.ensureActionsWithContextualAttributes)(i),this.banditEvaluator.evaluateBandit(e,t,r,i,n)):null}logBanditAction(e){var t=e.subject,t={flagKey:e.featureFlag,subjectKey:t,banditKey:e.bandit,actionKey:e.action??"__eppo_no_action"};if(!this.banditAssignmentCache?.has(t))try{this.banditLogger?this.banditLogger.logBanditAction(e):this.banditEventsQueue.push(e),this.banditAssignmentCache?.set(t)}catch(e){m.logger.warn("Error encountered logging bandit action",e)}}getAssignmentVariation(t,e,r,i,n){try{var a=this.getAssignmentDetail(t,e,r,n);return this.parseVariationWithDetails(a,i,n)}catch(t){let e=this.rethrowIfNotGraceful(t,i);return t instanceof S.FlagEvaluationError&&t.flagEvaluationDetails?{eppoValue:e,flagEvaluationDetails:t.flagEvaluationDetails}:{eppoValue:e,flagEvaluationDetails:new b.FlagEvaluationDetailsBuilder("",[],"","").buildForNoneResult("ASSIGNMENT_ERROR","Assignment Error: "+t.message)}}}parseVariationWithDetails({flagEvaluationDetails:e,variation:t},r,i){try{return t&&"MATCH"===e.flagEvaluationCode?{eppoValue:g.EppoValue.valueOf(t.value,i),flagEvaluationDetails:e}:{eppoValue:r,flagEvaluationDetails:e}}catch(t){return{eppoValue:this.rethrowIfNotGraceful(t,r),flagEvaluationDetails:e}}}rethrowIfNotGraceful(e,t){if(this.isGracefulFailureMode)return m.logger.error(m.loggerPrefix+" Error getting assignment: "+e.message),t??g.EppoValue.Null();throw e}getAllAssignments(i,n={}){let a=this.getConfiguration(),o=a.getFlagConfigDetails(),e=this.getFlagKeys(),s={};return e.forEach(e=>{var t,r=this.getNormalizedFlag(a,e);r?(t=this.evaluator.evaluateFlag(r,o,i,n,this.isObfuscated(a))).variation&&t.allocationKey?s[e]={flagKey:e,allocationKey:t.allocationKey,doLog:t.doLog,extraLogging:t.extraLogging,variationKey:t.variation.key,variationType:r.variationType,variationValue:t.variation.value.toString()}:m.logger.debug(m.loggerPrefix+" No assigned variation: "+e):m.logger.debug(m.loggerPrefix+" No assigned variation. Flag does not exist.")}),s}getPrecomputedConfiguration(e,t={},r={},i){var n=this.getConfiguration(),a=n.getFlagConfigDetails(),o=(0,f.ensureContextualSubjectAttributes)(t),t=(0,f.ensureNonContextualSubjectAttributes)(t),t=this.getAllAssignments(e,t),n=this.computeBanditsForFlags(n,e,o,r,t),r=u.PrecomputedConfiguration.obfuscated(e,t,n,i??"",o,a.configEnvironment),e=new u.ConfigurationWireV1(r);return JSON.stringify(e)}getAssignmentDetail(r,i,n={},e){(0,N.validateNotBlank)(i,"Invalid argument: subjectKey cannot be blank"),(0,N.validateNotBlank)(r,"Invalid argument: flagKey cannot be blank");let t=this.getConfiguration(),a=this.newFlagEvaluationDetailsBuilder(t,r),o=this.overrideStore?.get(r);if(o)return(0,d.overrideResult)(r,i,n,o,a);var s=t.getFlagConfigDetails(),l=this.getNormalizedFlag(t,r);if(null===l){m.logger.warn(m.loggerPrefix+" No assigned variation. Flag not found: "+r);let e=a.buildForNoneResult("FLAG_UNRECOGNIZED_OR_DISABLED","Unrecognized or disabled flag: "+r);return(0,d.noneResult)(r,i,n,e,s.configFormat)}if(!R(e,l.variationType)){let t=`Variation value does not have the correct type. Found ${l.variationType}, but expected ${e} for flag `+r;if(this.isGracefulFailureMode){let e=a.buildForNoneResult("TYPE_MISMATCH",t);return(0,d.noneResult)(r,i,n,e,s.configFormat)}throw new TypeError(t)}if(!l.enabled){m.logger.info(m.loggerPrefix+" No assigned variation. Flag is disabled: "+r);let e=a.buildForNoneResult("FLAG_UNRECOGNIZED_OR_DISABLED","Unrecognized or disabled flag: "+r);return(0,d.noneResult)(r,i,n,e,s.configFormat)}var u=this.isObfuscated(t),l=this.evaluator.evaluateFlag(l,s,i,n,u,e);u&&(l.flagKey=r);try{l?.doLog&&this.maybeLogAssignment(l)}catch(r){m.logger.error(m.loggerPrefix+" Error logging assignment event: "+r)}return l}track(e,t){this.eventDispatcher.dispatch({uuid:(0,i.v4)(),type:e,timestamp:(new Date).getTime(),payload:t})}newFlagEvaluationDetailsBuilder(e,t){t=this.getNormalizedFlag(e,t),e=e.getFlagConfigDetails();return new b.FlagEvaluationDetailsBuilder(e.configEnvironment.name,t?.allocations??[],e.configFetchedAt,e.configPublishedAt)}getNormalizedFlag(e,t){return this.isObfuscated(e)?this.getObfuscatedFlag(e,t):e.getFlag(t)}getObfuscatedFlag(e,t){e=e.getFlag((0,w.getMD5Hash)(t));return e?(0,c.decodeFlag)(e):null}getFlagKeys(){return this.getConfiguration().getFlagKeys()}isInitialized(){return this.getConfiguration().isInitialized()}setLogger(e){this.setAssignmentLogger(e)}setAssignmentLogger(e){this.assignmentLogger=e,this.flushQueuedEvents(this.assignmentEventsQueue,this.assignmentLogger?.logAssignment)}setBanditLogger(e){this.banditLogger=e,this.flushQueuedEvents(this.banditEventsQueue,this.banditLogger?.logBanditAction)}disableAssignmentCache(){this.assignmentCache=void 0}useNonExpiringInMemoryAssignmentCache(){this.assignmentCache=new a.NonExpiringInMemoryAssignmentCache}useLRUInMemoryAssignmentCache(e){this.assignmentCache=new n.LRUInMemoryAssignmentCache(e)}useCustomAssignmentCache(e){this.assignmentCache=e}disableBanditAssignmentCache(){this.banditAssignmentCache=void 0}useNonExpiringInMemoryBanditAssignmentCache(){this.banditAssignmentCache=new a.NonExpiringInMemoryAssignmentCache}useExpiringInMemoryBanditAssignmentCache(e,t){this.banditAssignmentCache=new o.TLRUInMemoryAssignmentCache(e,t)}useCustomBanditAssignmentCache(e){this.banditAssignmentCache=e}setIsGracefulFailureMode(e){this.isGracefulFailureMode=e}getFlagConfigurations(){return this.getConfiguration().getFlags()}flushQueuedEvents(e,t){e=e.flush();t&&e.forEach(e=>{try{t(e)}catch(e){m.logger.error(m.loggerPrefix+" Error flushing event to logger: "+e.message)}})}maybeLogAssignment(e){var{flagKey:t,format:r,subjectKey:i,allocationKey:n=null,subjectAttributes:a,variation:o,flagEvaluationDetails:s,extraLogging:l={},entityId:u}=e,l={...l,allocation:n,experiment:n?t+"-"+n:null,featureFlag:t,format:r,variation:o?.key??null,subject:i,timestamp:(new Date).toISOString(),subjectAttributes:a,metaData:this.buildLoggerMetadata(),evaluationDetails:s,entityId:u};if(o&&n){let e=this.assignmentCache?.has({flagKey:t,subjectKey:i,allocationKey:n,variationKey:o.key});if(e)return}try{this.assignmentLogger?this.assignmentLogger.logAssignment(l):this.assignmentEventsQueue.push(l),this.assignmentCache?.set({flagKey:t,subjectKey:i,allocationKey:n??"__eppo_no_allocation",variationKey:o?.key??"__eppo_no_variation"})}catch(e){m.logger.error(m.loggerPrefix+" Error logging assignment event: "+e.message)}}buildLoggerMetadata(){return{obfuscated:this.isObfuscated(this.getConfiguration()),sdkLanguage:"javascript",sdkLibVersion:L.LIB_VERSION}}computeBanditsForFlags(i,n,a,o,e){let s={};return Object.keys(o).forEach(t=>{var r=e[t];if(r){let e=this.getPrecomputedBandit(i,t,r.variationValue,n,a,o[t]);e&&(s[t]=e)}}),s}getPrecomputedBandit(e,t,r,i,n,a){e=e.getFlagVariationBandit(t,r);return e&&(r=this.evaluateBanditAction(t,i,n,a,e.modelData))?{banditKey:e.banditKey,action:r.actionKey,actionNumericAttributes:r.actionAttributes.numericAttributes,actionCategoricalAttributes:r.actionAttributes.categoricalAttributes,actionProbability:r.actionWeight,modelVersion:e.modelVersion,optimalityGap:r.optimalityGap}:null}}},8807:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeterministicSharder=t.MD5Sharder=t.Sharder=void 0;let i=r(6092);class n{}t.Sharder=n,t.MD5Sharder=class extends n{getShard(e,t){e=(0,i.getMD5Hash)(e);return parseInt(e.slice(0,8),16)%t}},t.DeterministicSharder=class extends n{constructor(e){super(),this.lookup=e}getShard(e,t){return this.lookup[e]??0}}},8950:e=>{let n=/^[0-9]+$/,r=(e,t)=>{var r=n.test(e),i=n.test(t);return r&&i&&(e=+e,t=+t),e===t?0:r&&!i||(!i||r)&&e<t?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},9043:(e,t,r)=>{let i=r(4605);e.exports=(e,t,r)=>new i(e,r).compare(new i(t,r))},9052:(e,t,r)=>{let a=r(4605);e.exports=(e,t,r,i,n)=>{"string"==typeof r&&(n=i,i=r,r=void 0);try{return new a(e instanceof a?e.version:e,r).inc(t,i,n).version}catch(e){return null}}},9139:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FlagEvaluationError=void 0;class r extends Error{}t.FlagEvaluationError=r},9182:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EppoAssignmentLogger=void 0,t.EppoAssignmentLogger=class{constructor(e){this.eppoClient=e}logAssignment(e){var{entityId:e,experiment:t,holdoutKey:r,holdoutVariation:i,subject:n,variation:a}=e;e&&this.eppoClient.track("__eppo_assignment",{entity_id:e,experiment:t,holdout_variation:i,holdout:r,subject:n,variation:a})}}},9380:(e,t,r)=>{let i=r(3708);e.exports=(e,t)=>new i(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},9658:(e,j,t)=>{var r=t(4065),i=t(831),n=t(4605),a=t(8950),o=t(1147),s=t(2802),l=t(4161),u=t(9052),c=t(2381),g=t(6965),d=t(5473),h=t(4858),f=t(2156),p=t(9043),m=t(1291),E=t(6396),v=t(2034),y=t(7778),b=t(4154),S=t(3033),A=t(7686),O=t(1112),C=t(2180),w=t(6330),I=t(1103),T=t(1948),_=t(7607),N=t(6757),L=t(3708),R=t(8325),P=t(9380),M=t(375),D=t(9717),F=t(3848),x=t(2787),U=t(5822),V=t(962),B=t(7063),$=t(9815),K=t(6846),t=t(5919);e.exports={parse:o,valid:s,clean:l,inc:u,diff:c,major:g,minor:d,patch:h,prerelease:f,compare:p,rcompare:m,compareLoose:E,compareBuild:v,sort:y,rsort:b,gt:S,lt:A,eq:O,neq:C,gte:w,lte:I,cmp:T,coerce:_,Comparator:N,Range:L,satisfies:R,toComparators:P,maxSatisfying:M,minSatisfying:D,minVersion:F,validRange:x,outside:U,gtr:V,ltr:B,intersects:$,simplifyRange:K,subset:t,SemVer:n,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}},9717:(e,t,r)=>{let o=r(4605),s=r(3708);e.exports=(e,t,r)=>{let i=null,n=null,a=null;try{a=new s(t,r)}catch(e){return null}return e.forEach(e=>{!a.test(e)||i&&1!==n.compare(e)||(i=e,n=new o(i,r))}),i}},9721:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.takeWhile=void 0,t.takeWhile=function(e,t){var r,i=[];for(r of e){if(!t(r))break;i.push(r)}return i}},9746:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});let i=r(6697);t.default=function(e){return"string"==typeof e&&i.default.test(e)}},9815:(e,t,r)=>{let i=r(3708);e.exports=(e,t,r)=>(e=new i(e,r),t=new i(t,r),e.intersects(t,r))},9851:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonExpiringInMemoryAssignmentCache=void 0;r=r(7989);class i extends r.AbstractAssignmentCache{constructor(e=new Map){super(e)}}t.NonExpiringInMemoryAssignmentCache=i},9864:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryOnlyConfigurationStore=t.MemoryStore=void 0;class r{constructor(){this.store={},this.initialized=!1}get(e){return this.store[e]??null}entries(){return this.store}getKeys(){return Object.keys(this.store)}isInitialized(){return this.initialized}setEntries(e){this.store={...e},this.initialized=!0}}t.MemoryStore=r,t.MemoryOnlyConfigurationStore=class{constructor(){this.servingStore=new r,this.initialized=!1,this.configFetchedAt=null,this.configPublishedAt=null,this.environment=null,this.format=null}init(){return this.initialized=!0,Promise.resolve()}get(e){return this.servingStore.get(e)}entries(){return this.servingStore.entries()}getKeys(){return this.servingStore.getKeys()}async isExpired(){return!0}isInitialized(){return this.initialized}async setEntries(e){return this.servingStore.setEntries(e),this.initialized=!0}getEnvironment(){return this.environment}setEnvironment(e){this.environment=e}getConfigFetchedAt(){return this.configFetchedAt}setConfigFetchedAt(e){this.configFetchedAt=e}getConfigPublishedAt(){return this.configPublishedAt}setConfigPublishedAt(e){this.configPublishedAt=e}getFormat(){return this.format}setFormat(e){this.format=e}}}},i={};function n(e){var t=i[e];return void 0!==t||(t=i[e]={exports:{}},r[e].call(t.exports,t,t.exports,n)),t.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s=n(1265),window.EppoVisualEditor={hideOverlay:!1,setHideOverlay:e=>{!0===(window.EppoVisualEditor.hideOverlay=e)&&document.getElementById("eppo-loading-overlay")?.remove()},showContentWhenLoaded:({delayTimeMs:e}={})=>{let t=()=>{setTimeout(()=>{window.EppoVisualEditor.setHideOverlay(!0)},e??1e3),document.removeEventListener("DOMContentLoaded",t)};document.addEventListener("DOMContentLoaded",t)},init:async(e,n,t,r)=>{let a=r.delayContentDisplay;e=(r?.sdkUrl??"https://fscdn.eppo.cloud/api")+"/flag-config/v1/config?apiKey="+e;let i,o=(i=r?.loadFlagConfig?await r.loadFlagConfig():await fetch(e).then(e=>e.json()).catch(e=>{console.error("Error fetching config",e),window.EppoVisualEditor.setHideOverlay(!0)}),await(0,s.ge)({flagsConfiguration:i.flags,assignmentLogger:{logAssignment:t},isObfuscated:!1}));Object.keys(i?.flags)&&0!==Object.keys(i?.flags).length||window.EppoVisualEditor.setHideOverlay(!0),Object.keys(i.flags).map(e=>i.flags[e].key).forEach(t=>{let r=new URLSearchParams(window.location.search).get("eppo-ff-override-"+t),i=e=>{try{return JSON.parse(decodeURIComponent(e))}catch(e){return window.EppoVisualEditor.setHideOverlay(!0),console.error("Error decoding actions for flag with key:",t),[]}},e=(()=>{if(r){let e=o.getFlagConfigurations();return i(JSON.parse(e[t].variations[r].value).actions)}{let e=o.getJSONAssignmentDetails(t,n,{URL:window.location.href,VIEWPORT:window.innerWidth},{});return i(e.variation.actions)}})();(e&&0<e.length&&a&&!e.some(e=>"redirect"===e.type)||!e||0===e.length)&&window.EppoVisualEditor.setHideOverlay(!0),e&&0<e.length&&e.forEach(e=>{switch(e.type){case"inject-css":({value:n,maxWidth:a}=[e][0]),(o=document.createElement("style")).textContent=a?`@media (max-width: ${a}px) { ${n} }`:n,document.head.appendChild(o);break;case"inject-js":({value:a,maxWidth:n}=[e][0]),n&&window.innerWidth>n||((n=document.createElement("script")).textContent=a,document.head.appendChild(n));break;case"set-html-css":[{selector:o,styles:t={},value:r,maxWidth:i}]=[e],!o||i&&window.innerWidth>i||window.veUtils.updateElementHtmlCss({selector:o,styles:t,value:r});break;case"redirect":if(e?.value)try{window.addEventListener("eppoVeRedirectReady",()=>{window.veUtils.redirectTo(e.value)}),!0===window.veUtils.isRedirectReady&&window.veUtils.redirectTo(e.value)}catch(e){console.error("Catching closed connections",e)}else console.error("no redirect value supplied");break;default:console.log("Unknown action type",e.type)}var t,r,i,n,a,o})})}}})(),window.dispatchEvent(new Event("eppoVisualEditorReady"));