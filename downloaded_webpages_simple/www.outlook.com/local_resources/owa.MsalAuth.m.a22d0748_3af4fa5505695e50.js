"use strict";(globalThis.webpackChunkOwa=globalThis.webpackChunkOwa||[]).push([[66694],{432686:(e,t,o)=>{o.d(t,{Es:()=>c,KA:()=>l,WX:()=>s});var n=o(484088),i=o(682324),r=o(686088),a=o(830170);function s(){return!(0,a.O)()&&!(0,n.Gq)(self,"isauthed")}function c(){(0,i.GV)()===r.XB.Office365&&(0,n.SO)(self,"isauthed","1")}function l(){(0,i.GV)()===r.XB.Office365&&(0,n.Ai)(self,"isauthed")}},666792:(e,t,o)=>{let n,i,r;o.r(t),o.d(t,{acquireAccessTokenMsal:()=>eE,createMsalInstance:()=>b,executeMsalNestedAppAuthRequest:()=>eY,getAnchorMailbox:()=>eq,getAnchorMailboxFromMsalAccount:()=>eF,getAuthTokenMsal:()=>eG,loginUserMsal:()=>eA,onActivityTimeoutErrorForMSAL:()=>e6,onFederatedLogout:()=>e2,prefetchMsalNestedAppAuthRequest:()=>e0,setIsSigninRequired:()=>eS.c,signoutFromMsal:()=>z});var a=o(85453),s=o(479860),c=o(192093),l=o(294868),u=o(940954),d=o(901308),f=o(830170),h=o(336362),p=o(158888),m=o(393365),g=o(686088),A=o(68670),y=o(738409);function v(e){if(e===g.XB.Office365){let e=w();return e?`${e}organizations/`:A.JE}return e===g.XB.OutlookDotCom?A.sj:A.KF}function C(){let e=w();return e?`${e}common/`:A.KF}function w(){let e=((0,y.Ay)("aadAuthorityUrl")||"").toLowerCase();return(0,h.Fg)(e)?e:void 0}var k=o(782433),S=o(157926),T=o(909104);let M=null;function E(){return M??Promise.reject(Error("MSAL instance not available"))}function b(e){if(M)throw Error("MSAL instance creation is managed by boot code");r=e;let t=(0,f.O)(),o={auth:{clientId:k.$b,redirectUri:`${(0,p.$)()}/mail/`,authority:C(),navigateToLoginRequestUrl:!0,clientCapabilities:["CP1"],...r?.auth,supportsNestedAppAuth:t},cache:{cacheLocation:a.Al.LocalStorage,...r?.cache},system:{loggerOptions:function(){if((0,d.si)("auth-msaljs-EnableLogging"))return{logLevel:u.$.Trace,loggerCallback:(e,t,o)=>{if(!o)switch(e){case u.$.Error:m.uP.warn(t);return;case u.$.Info:m.uP.info(t);return;case u.$.Verbose:m.uP.verbose(t);return;case u.$.Warning:m.uP.warn(t);return;default:m.uP.info(t);return}}}}(),allowPlatformBroker:!1,allowRedirectInIframe:!0}};o.auth.protocolMode=e?.auth.protocolMode??(o.auth.clientId==k.$b&&((0,d.si)("auth-msaljs-enableEAR-enterprise")&&(0,S.D)()||(0,d.si)("auth-msaljs-enableEAR-consumer")&&(0,T.pO)())?s.e.EAR:s.e.AAD),(self.__JSWRAPPER||(0,d.si)("auth-msaljs-disableCaeCapabilities"))&&(o.auth.clientCapabilities=void 0);let n={appName:"OWA",appVersion:(0,h.Oo)()};M=t?(0,c.Ji)(o):l.v.createPublicClientApplication(o,n)}function O(){return r?.auth.clientId??k.$b}function I(){return r?.auth.protocolMode??void 0}var R=o(167594),P=o(859741),X=o(432686),_=o(992252),D=o(611143),x=o(484088);function U(e,t,o){if(e)return e.idTokenClaims?.login_hint||e.username;if(t){let e=(0,P.C)(t).SessionSettings;return e?.LoginHint??(0,x.Gq)(self,"login_hint")??(e?.WebSessionType!==0?e?.NotManagedEmailAddresses?.[0]:void 0)??e?.LogonEmailAddress??e?.UserPrincipalName??t?.userIdentity}return o||((0,x.Gq)(self,"login_hint")??void 0)}var L=o(682324),N=o(609624);let $=new Map;function B(e,t,o=!1){let n=null,i={isNaa:o},r=(0,R.ku)(t),a=$.get(r);i.hasMailboxInfoIndexerValue=!!r,i.homeAccountIdFoundInCache=!!a;let s=(0,P.C)(t).SessionSettings;if(i.hasSessionSettings=!!s,!a&&s&&(s.ExternalDirectoryUserGuid&&s.ExternalDirectoryTenantGuid&&(a=`${s.ExternalDirectoryUserGuid}.${s.ExternalDirectoryTenantGuid}`),i.hasExternalDirectoryUserGuid=!!s.ExternalDirectoryUserGuid,i.hasExternalDirectoryTenantGuid=!!s.ExternalDirectoryTenantGuid),a&&(n=e.getAccount({homeAccountId:a}),i.getAccountByHomeAccountIdResult=n?"Success":"Failure"),!n){let o=U(void 0,t);i.hasLoginHint=!!o,o&&((n=e.getAccount({loginHint:o}))&&!n.idToken&&(n=null),i.getAccountByLoginHintResult=n?"Success":"Failure")}return r&&n&&$.set(r,n.homeAccountId),n||(0,D.uZ)("Msal-GetAccountFromMsal-Failure",i),n}function H(e){return e.getActiveAccount()}function q(e,t){(0,_.W)(e.getConfiguration().auth.clientId),function(e,t){e.setActiveAccount(t)}(e,t),(0,x.SO)(self,"login_hint",t.idTokenClaims?.login_hint??t.username);let o=t.username.includes("@")?t.username.split("@")[1]:"",n=(0,L.PX)(t)==g.XB.OutlookDotCom;o&&!n&&(0,x.SO)(self,"domain_hint",o),(0,X.Es)(),function(e){let t=(0,N.K)(),o=e?.idTokenClaims?.xms_wsit??void 0;(0,f.O)()||(0,L.GV)()!==g.XB.Office365||void 0===o||t||(self.document.cookie=`${N.N}=${o}; path=/; SameSite=None; Secure`)}(t)}var F=o(429896),G=o(823601);async function j(e){let t;t=e==k.DR?`${(0,p.$)()}/mail/0/logoutframe.html?iss=${k.DR}&loadMoreIframes=false&clearCookiesOnly=true`:`${r?.auth.redirectUri??`${(0,p.$)()}/mail/`}logoutframe.html?loadMoreIframes=false&clearCookiesOnly=true`;let o=self.document.createElement("iframe");o.style.cssText="position: absolute; width:0; height:0; border:0;",o.id="iframe_cc",o.src=t,self.document.body.appendChild(o)}var V=o(889236);async function z(e){let t=null;(0,x.Ai)(self,"login_hint"),(0,x.Ai)(self,"domain_hint");try{b()}catch{}try{t=await E()}catch(e){m.uP.info("MsalInitFailure-Logout "+{Error:e})}if(t){let o;if(null!=(o=(0,V.A)()?B(t,(0,F.A)()):H(t))){(0,_.W)(null),(0,X.KA)(),await j(o.tenantId);let n={account:o,postLogoutRedirectUri:(0,G.H)(o,e)};try{await t.logoutRedirect(n)}catch(e){m.uP.info("MsalInitFailure-LogoutRedirect "+{Error:e})}}}}var W=o(764169),J=o(861161),K=o(6775);function Z(e,t){let o=Q(e,t);return{AccessToken:o,TokenResultCode:o?0:2,ExpiresIn:e.expiresOn?(e.expiresOn.getTime()-Date.now())/1e3:void 0,AccessTokenExpiry:e.expiresOn?.toUTCString()}}function Q(e,t){return t===g.XB.OutlookDotCom&&e.scopes[0]?.toLocaleLowerCase().startsWith("service::")?`MSAuth1.0 usertoken="${e.accessToken}", type="MSACT"`:`${e.accessToken}`}var Y=o(220585),ee=o(41286),et=o(209248);function eo(e,t,o,n){if(e===g.XB.Office365||n&&!o){let e=t??(0,y.Ay)("publicUrl");if(e)return e.toLowerCase().endsWith("/.default")?[e]:[`${e.replace(/\/+$/,"")}/.default`]}else if(e===g.XB.OutlookDotCom){let e=(0,d.si)("auth-msaljs-useDelegationToken")?A.rk:A.hA;return[o??e]}return[]}var en=o(404711),ei=o(593926);let er="4.14.0";var ea=o(707308),es=o(730004),ec=o(93722);function el(e,t,o,n,i,r,a){return{interactionType:e,isSuccess:t.accessToken.length>0,latency:self.performance.now()-o,accountType:n,isValidAuthorityUrl:i,correlationId:t.correlationId,scopes:t.scopes.join(" "),fromCache:t.fromCache,pageVisible:r,requestedScope:a,applicationId:O(),msalPackageVersion:er,isHosted:(0,f.O)(),app:(0,h.Sx)(),hostedScenario:(0,ea.s)(),hostApp:(0,es.iq)()||(0,ec.J)(),protocolMode:I()}}function eu(e,t,o,n,i,r,a,s,c,l){return{interactionType:e,isSuccess:!1,latency:self.performance.now()-o,accountType:r,scopes:i?.join(" "),correlationId:t.correlationId,errorCode:t.errorCode,errorMessage:t.errorMessage,subError:t.subError,isValidAuthorityUrl:a,isCAERemediationRequired:s,pageVisible:c,applicationId:O(),isSigninBannerShown:l,msalPackageVersion:er,isHosted:(0,f.O)(),app:(0,h.Sx)(),hostedScenario:(0,ea.s)(),hostApp:(0,es.iq)()||(0,ec.J)(),protocolMode:I(),incomingApiName:n}}function ed(){return`${(0,p.$)()}${A.IH}`}var ef=o(570366),eh=o(988259),ep=o(42255),em=o(715841);let eg=["login_hint","prompt","realm","domain_hint"];async function eA(e,t,o,n,i,r,a,s,c,l){let u;try{l=l??(0,ef._)();let d=await E();u=await ey(l,d,t,e,o,n,i,r,a,s,c)}catch(e){return{TokenResultCode:2,SubErrorCode:e.errorCode}}return Z(u,e)}async function ey(e,t,o,n,i,r,s,c,l,u,f){var m;let y;if(n===g.XB.Other)throw(0,Y.SB)("UnsupportedAccountType");let w={};n===g.XB.OutlookDotCom&&(o===en.X.Redirect||o===en.X.Popup)&&(w.cobrandid=A.yQ,w.fl="dob,flname,wld",u===et._M.CREATE&&(w.signup="1"));let k=(m=`${(0,p.$)()+eC()}`,btoa(String.fromCharCode(...new TextEncoder().encode(m))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")),S={scopes:eo(n,c,l,o===en.X.Redirect),account:i??void 0,loginHint:U(i,r,s),state:k,authority:v(n),prompt:u,extraQueryParameters:w,redirectUri:ed(),claims:f,correlationId:e,cacheLookupPolicy:a.nN.Default},M=self.performance.now();try{if(o===en.X.Redirect)throw await function(e,t,o){let n=(0,ei.OU)(),i=n.realm??n.domain_hint,r=(0,x.Gq)(self,"domain_hint");return(0,d.si)("auth-msaljs-domainHint")&&!(0,T.pO)()&&t.prompt!=et._M.SELECT_ACCOUNT&&(i&&(!t.loginHint||t.loginHint.indexOf("@")>-1)?t.domainHint=i:!t.loginHint&&r&&(t.domainHint=r)),(0,T.pO)()&&t.prompt==et._M.CREATE&&(t.loginHint=void 0),t.domainHint||t.loginHint&&t.prompt!=et._M.SELECT_ACCOUNT||(t.prompt=t.prompt??et._M.SELECT_ACCOUNT,t.prompt!=et._M.CREATE&&(t.authority=C())),t.redirectUri=void 0,t.redirectStartPage=eC(),(0,D.Xs)("Msal-Login",{accountType:o,interactionType:en.X.Redirect,prompt:t.prompt,isValidAuthorityUrl:(0,h.Fg)(t.authority??""),correlationId:t.correlationId,applicationId:O(),loginHint:t.loginHint?t.loginHint.indexOf("@")>-1?"UPN":"Opaque String":"None"}),(0,eh.SO)(self,A.Xf,"1"),e.loginRedirect(t)}(t,S,n),(0,ee.pz)("NotRedirected");y=o===en.X.Popup?await t.loginPopup(S):await t.ssoSilent(S)}catch(e){throw(0,D.Xs)("Msal-Login",eu(o,e,M,"LoginUserMsal",S.scopes,n,!!S.authority&&(0,h.Fg)(S.authority))),e}return(0,D.Xs)("Msal-Login",el(o,y,M,n,!!S.authority&&(0,h.Fg)(S.authority))),r&&function(e,t){let o=(0,R.ku)(e);o&&$.set(o,t.homeAccountId)}(r,y.account),y}async function ev(e,t,o,n){let i=self.performance.now();try{(0,eh.Ai)(self,A.Xf);let r=await e.handleRedirectPromise(self.owaLocationHash);if(r){self.document.cookie="logoutSid=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";let a=(0,L.PX)(r.account);if(t!=g.XB.Other&&t!=a)throw(0,ep.U)(U(r.account)),Error("AadOrMsaRedirRequired");return(0,d.si)("auth-msaljs-useDelegationToken")||(0,L.PX)(r.account)!==g.XB.OutlookDotCom||(r=await eb(o,e,r.account,t,"Unknown apiName",void 0,A.hA,n)),(0,D.Xs)("Msal-Login-RedirectPromise",el(en.X.Redirect,r,i,t,(0,h.Fg)(r.authority))),r}}catch(e){throw(0,D.Xs)("Msal-Login-RedirectPromise",eu(en.X.Redirect,e,i,"Unknown apiName",void 0,t)),e}return null}function eC(){let e=(0,ei.OU)();eg.forEach(t=>{delete e[t]});let t=(0,em.O)().pathname;return Object.keys(e).length>0?t+"?"+(0,ei.As)(e):t}var ew=o(964147);function ek(e,t,o){let n;if(o)return o;t?n=t:e&&(n=e.get("WWW-Authenticate")??void 0);let i=n?function(e){let t;let o={},n=/(\w+)="([^"]*)"/g;for(;null!==(t=n.exec(e));){let e=t[1],n=decodeURI(t[2]);o[e]=n}return o}(n).claims:void 0;if(i)try{return atob(i)}catch{}}var eS=o(228791),eT=o(342937);let eM=[W.zv,W.l7,J.s1,W.Uf,A.rm,A.I_,A.ci];async function eE(e,t,o,n,i,r,a,s){let c;if((0,eS.S)())return;let l=(0,L.Mk)(e);if(l===g.XB.Other)return{TokenResultCode:2,SubErrorCode:"UnsupportedAccountType"};r=r??(0,ef._)();let u=await E(),d=B(u,e),h=ek(i,a,s);return d?c=eb(r,u,d,l,t,o,n,h):((0,D.uZ)("Msal-AcquireToken-NoAccount",{accountType:l,correlationId:r}),c=ey(r,u,en.X.Silent,l,void 0,e,void 0,o,n,void 0,h)),c.catch(async e=>{if(e instanceof K.CB&&h){let e=(0,f.O)();if((0,D.uZ)("Msal-AcquireToken",{accountType:l,interactionType:e?en.X.Popup:en.X.Redirect,isCAERemediation:!0,correlationId:r,applicationId:O()}),e)return u.acquireTokenPopup({account:d??void 0,scopes:eo(l,o,n),authority:v(l),redirectUri:ed(),claims:h,correlationId:r});throw await u.acquireTokenRedirect({account:d??void 0,scopes:eo(l,o,n),authority:v(l),claims:h,correlationId:r}),(0,ee.pz)("NotRedirected")}throw e}).then(e=>Z(e,l)).catch(t=>((t instanceof K.CB||eM.includes(t.errorCode))&&function(e,t,o){let n=((0,y.Ay)("publicUrl")||"").toLowerCase(),i=eo(e,t,o);return i.includes(`${n}/.default`)||i.includes(A.hA)}(l,o,n)&&(0,eT.z$)(e)&&((0,eS.S)()||(0,D.uZ)("Msal-AcquireToken",{accountType:l,correlationId:r,applicationId:O(),isSigninRequired:!0}),(0,eS.c)(!0),(0,ew.P)()),{TokenResultCode:2,SubErrorCode:t.errorCode,ErrorMessage:t.errorMessage}))}async function eb(e,t,o,n,i,r,s,c,l=1){let u=self.performance.now(),d={account:o,scopes:eo(n,r,s),authority:v(n),redirectUri:ed(),claims:c,correlationId:e,cacheLookupPolicy:a.nN.Default},f="visible"===self.document.visibilityState,p=()=>{"visible"!=self.document.visibilityState&&(f=!1)};self.document.addEventListener("visibilitychange",p);try{let e=await t.acquireTokenSilent(d);return self.document.removeEventListener("visibilitychange",p),(0,D.uZ)("Msal-AcquireToken",el(en.X.Silent,e,u,n,!!d.authority&&(0,h.Fg)(d.authority),f,d.scopes.join(" ")),{sessionSampleRate:.1}),e}catch(m){if(eM.includes(m.errorCode)&&l<2)return eb(e,t,o,n,i,r,s,c,++l);let a=m instanceof K.CB&&!!c;throw self.document.removeEventListener("visibilitychange",p),(0,D.Xs)("Msal-AcquireToken",eu(en.X.Silent,m,u,i,d.scopes,n,!!d.authority&&(0,h.Fg)(d.authority),a,f,(0,eS.S)())),m}}var eO=o(556077),eI=o(260169);function eR(e){return e instanceof K.CB||(e instanceof eI.jT||e instanceof Y.eB)&&(e.errorCode===W.Uf||e.errorCode===W.zv||e.errorCode===W.l7||e.errorCode===J.s1)}var eP=o(891784),eX=o(989268),e_=o(435156),eD=(e=>(e[e.Scheduled=0]="Scheduled",e[e.Skip=1]="Skip",e[e.Pending=2]="Pending",e))(eD||{});let ex=new Map;async function eU(e){if(!(0,e_.zj)().isFeatureEnabled("auth-msaljs-autoRefresh"))return;let t=(0,R.EN)(e);if(void 0!=ex.get(t))return;ex.set(t,2);let o=B(await E(),e),n=o?.idTokenClaims?.signin_state;if(!(void 0!=n&&n.includes("kmsi"))){ex.set(t,1);return}setInterval(()=>{eL(e)},144e5+Math.floor(6e5*Math.random())),ex.set(t,0)}async function eL(e){let t,o;let n=self.performance.now(),i=(0,L.Mk)(e),r=(0,ef._)(),a=await E(),s=B(a,e),c=null;if(s){let e={account:s,scopes:eo(i),authority:v(i),redirectUri:ed(),correlationId:r,forceRefresh:!0,refreshTokenExpirationOffsetSeconds:72e3};if(c=await a.acquireTokenSilent(e).catch(e=>(t=e.errorCode,o=e.errorMessage,null)),c?.expiresOn){var l=c.expiresOn;(0,x.SO)(self,"msalexp",l.toString())}}(0,D.Xs)("Msal-BackgroundRefresh",{correlationId:r,accountType:i,isAccountPresent:!!s,isSuccess:!!c,errorCode:t,errorMessage:o,latency:self.performance.now()-n,pageVisible:"visible"===self.document.visibilityState})}var eN=o(269055),e$=o(139613),eB=o(662442),eH=o(665714);async function eq(e){return(0,eH.D)()||((0,eT.VU)()||e?(0,eB.q)(e??(0,F.A)()):(await eG(),eF()))}async function eF(){let e,t;let o=H(await E()),n=o?.idTokenClaims?.puid,i=o?.idTokenClaims?.tid,r=o?.username;return(0,S.C)()?(e=n?`PUID:${n}@${i}`:void 0,t=o?`SMTP:${r}`:void 0):(0,eX.E)()&&(e=n?`PUID:${n}@${A.Qw}`:void 0,t=o?`MSA:${r}`:void 0),e??t??""}async function eG(e,t){var o;!t&&(0,V.A)()&&(t=(0,F.A)());let r=(0,ef._)(),a=function(){switch((0,ei.OU)().prompt||self.owaLocationSearchPrompt){case"create_account":return et._M.CREATE;case"select_account":return et._M.SELECT_ACCOUNT;case"login":return et._M.LOGIN;default:return}}(),s=(0,ei.OU)().login_hint,c=e&&ek(e);return!s&&!a&&t&&((o=t).mailboxSmtpAddress||o.userIdentity)?(eU(t),n=void 0,(!i||c)&&(i=eE(t,"GetAuthTokenMsal",void 0,void 0,e,r).then(async e=>{if(i=void 0,(0,x.Ai)(self,"msalexp"),e?.ExpiresIn){var t=e.ExpiresIn+Date.now();(0,x.SO)(self,"msalexp",t.toString())}return e?(0,eN.B)(e.AccessToken):void 0})),i):((!n||c)&&(n=ej(r,s,c,a).then(async e=>{if(e){let e=await eF();self.document.cookie=`DefaultAnchorMailbox=${e}; path=/; secure; Samesite=none;`}return(0,eN.B)(e)})),n)}async function ej(e,t,o,n){let i,r;let a=await E(),s=(0,f.O)(),c=(0,L.SD)(),l=self.performance.now(),u=H(a);if((0,x.Aq)(self,"msalexp")&&Date.now()>Number((0,x.Gq)(self,"msalexp"))&&((0,eP.D4)("msalexp"),(0,x.Ai)(self,"msalexp")),!s&&!o)try{let t=await ev(a,c,e,o);if(t&&(0,L.PX)(t.account)===c)return(0,D.Xs)("Msal-AuthForStartupData-Latency",{accountType:c,isSuccess:!0,isRedirectPromise:!0,latency:self.performance.now()-l,fromCache:t.fromCache,isHosted:s,hasClaims:!!o,correlationId:e}),(0,eP.D4)("reds"),u&&eV(u.homeAccountId,t.account.homeAccountId),(0,e$.z)("MsalAuthSuccess",void 0,t.fromCache),q(a,t.account),Q(t,c)}catch(t){if("AadOrMsaRedirRequired"===t.message)throw t;(0,D.Xs)("Msal-AuthForStartupData-Latency",{accountType:c,isSuccess:!1,isRedirectPromise:!0,latency:self.performance.now()-l,isHosted:s,hasClaims:!!o,correlationId:e}),(0,eP.D4)("rede"),(0,e$.z)("MsalAuthError",t);return}if(!s&&n){(0,eP.D4)("pinlog"),await ey(e,a,en.X.Redirect,c,void 0,void 0,void 0,void 0,void 0,n,o);return}let h=function(e,t,o){if(o){let n=e.getAccount({loginHint:o});return n&&(0,L.PX)(n)===t?n:void 0}let n=H(e);return n&&(0,L.PX)(n)===t?n:(0,f.O)()?void 0:e.getAllAccounts().find(e=>(0,L.PX)(e)===t)??void 0}(a,c,t),p=s?en.X.Popup:en.X.Redirect,m=null,g=null;h?((0,eP.D4)("silogs"),g=eb(e,a,h,c,"GetAuthTokenMsal",void 0,void 0,o)):((0,eP.D4)("silogs"),g=ey(e,a,en.X.Silent,c,void 0,void 0,t,void 0,void 0,void 0,o));let A="None";if(m=await g.catch(n=>{if(function(e,t,o){let n=(0,eX.E)()&&(t||o||"true"==((0,y.Ay)("isRPSAuthCookiePresent")||"").toLowerCase()||(0,d.si)("auth-msaljs-consumer-boot-errorhandler")&&(0,x.Gq)(self,"login_hint"));return(!!((0,S.C)()||(0,eO.v)())||!!n)&&eR(e)}(n,h,t))return(0,eP.D4)("silinlog"),ey(e,a,p,c,h,void 0,t,void 0,void 0,void 0,o);throw n}).catch(e=>{(0,eP.D4)("silogse");let t=(0,x.Gq)(self,"login_hint"),o=(0,T.wR)()&&eR(e)&&!t;if((0,d.si)("auth-msaljs-consumer-boot-errorhandler")&&o||!(0,d.si)("auth-msaljs-consumer-boot-errorhandler")&&(0,T.wR)())throw Error("NeedsRedirectWithNlp");return A="MsalAuthError",i=e,null})){if((0,L.PX)(m.account)===c)return(0,D.Xs)("Msal-AuthForStartupData-Latency",{accountType:c,isSuccess:!0,isAccountPresent:!!h,latency:self.performance.now()-l,fromCache:m.fromCache,isHosted:s,hasClaims:!!o,correlationId:e}),(0,eP.D4)("silogsc"),u&&eV(u.homeAccountId,m.account.homeAccountId),q(a,m.account),(0,e$.z)("MsalAuthSuccess",void 0,m.fromCache),Q(m,c);A="MsalAuthError",i=(0,ee.pz)("AccountTypeDomainMismatch")}(0,D.Xs)("Msal-AuthForStartupData-Latency",{accountType:c,isSuccess:!1,isAccountPresent:!!h,latency:self.performance.now()-l,isHosted:s,hasClaims:!!o,correlationId:e}),"None"==A&&(A="MsalAuthError",i=(0,ee.pz)("NoToken")),(0,eP.D4)("notoken"),(0,e$.z)(A,i,r)}function eV(e,t){e?e!==t&&(0,eP.D4)("acctswitch"):(0,eP.D4)("noacct")}var ez=o(571719),eW=o(535525),eJ=o(881384);async function eK(e,t,o,n,i){let r;let s=await E(),c=(0,L.GV)(e),l=o.correlationId||(0,ef._)(),u=o.scope.split(" ").filter(e=>!!e),d=B(s,e,!0)??void 0,f=function(e,t,o,n,i,r,s,c,l,u){let d=function(e,t,o){if(o!==k.$b||e.getConfiguration().auth.clientId!==k.$b)return!1;if(A.SK.some(e=>e.test(t)))return!0;let n=(0,y.Ay)("businessCanonicalHostName");return void 0!=n&&t===n}(e,n,i),f=function(e,t,o){let n=e.getConfiguration();return o?{}:{client_id:t,brk_client_id:n.auth.clientId,brk_redirect_uri:ed()}}(e,i,d);return{account:c,authority:l??function(e,t,o){if(e==g.XB.Office365){let e=(0,y.Ay)("aadAuthorityUrl"),n=e&&(0,h.Fg)(e)?e:(0,h.t5)()?"https://login.microsoftonline.com/":void 0,i=t?t.tenantId:o?P.C(o).SessionSettings?.ExternalDirectoryTenantGuid:void 0;if(n&&i)return`${n}${i}`}return v(e)}(t,c,o),redirectUri:d?ed():`brk-multihub://${n}`,scopes:r,claims:u,correlationId:s,extraQueryParameters:f,tokenBodyParameters:{...f},storeInCache:{idToken:d,accessToken:d},cacheLookupPolicy:d?a.nN.Default:a.nN.RefreshTokenAndNetwork}}(s,c,e,t,o.clientId,u,l,d,o.authority,o.claims);if((r=n?await (d?s.acquireTokenSilent(f):s.ssoSilent({...f,loginHint:U(void 0,e,void 0)})):await s.acquireTokenPopup({...f,loginHint:U(d,e,void 0),popupWindowParent:i})).idTokenClaims.aud!==o.clientId)throw(0,ee.pz)("client_id_aud_mismatch");return r}function eZ(e,t,o){return(0,eJ.A)(e,"msal_executor_error",t,o)}class eQ{constructor(e){this.mailboxInfo=e;try{b()}catch{}}async getInitContext(e){let t=e?B(await E(),this.mailboxInfo,!0):null;return{sdkName:"OwaMsal",sdkVersion:(0,h.Oo)(),accountContext:t?{homeAccountId:t.homeAccountId,environment:t.environment,tenantId:t.tenantId}:void 0}}getTokenRequest(e,t){return this.getNestedAppAuthToken(e,!0,t).then(e=>this.toNaaAuthResult(e)).catch(e=>this.toNaaAuthError(e))}getTokenPopup(e,t,o){return this.getNestedAppAuthToken(e,!1,t,o).then(e=>this.toNaaAuthResult(e)).catch(e=>this.toNaaAuthError(e))}getNestedAppAuthToken(e,t,o,n){if(!o)throw eZ(eW.H.PersistentError,"invalid_origin");if(!e||!e.clientId||!e.scope)throw eZ(eW.H.PersistentError,"invalid_request");return eK(this.mailboxInfo,o,e,t,n)}getBridgeStatusCodeFromMsalAuthError(e){if(e instanceof K.CB)return eW.H.UserInteractionRequired;if(e instanceof Y.eB)switch(e.errorCode){case J.fn:return eW.H.UserCancel;case J.l7:return eW.H.NoNetwork;case J.rk:return eW.H.AccountUnavailable;case J.CN:return eW.H.Disabled}return eW.H.PersistentError}async toNaaAuthResult(e){return{token:{access_token:e.accessToken,expires_in:e.expiresOn?Math.floor((e.expiresOn.getTime()-Date.now())/1e3):0,id_token:e.idToken,scope:e.scopes.join(" "),authority:e.authority,properties:null},account:e.account}}async toNaaAuthError(e){if(e instanceof ee.lR)throw(0,eJ.A)(this.getBridgeStatusCodeFromMsalAuthError(e),e.errorCode,e.subError,e.errorMessage,{correlationId:e.correlationId});throw eZ(eW.H.PersistentError,"unknown_error",String(e))}}function eY(e,t,o,n,i,r,a){return(0,ez.i4)(eQ,e,t,o,n,i,r,a)}function e0(e,t,o,n){return(0,ez.Uw)(eQ,e,t,o,n)}async function e6(){await e1()}async function e1(){return await z(),location.assign("/owa/logoff.owa"),Promise.resolve()}var e4=o(481073),e8=o(469985);async function e2(e,t,o){if(t){let i=(0,e8.Ri)("logoutSid");if(i||o){let r=await E(),a=r?.getActiveAccount()?.idTokenClaims?.sid;if(((0,e4.A)(void 0,t)?i:o)===a){var n=new URL(e);return n.pathname="/mail/logoutFrame.html",n.search="loadMoreIframes=false&sid="+a,self.location.assign(n.toString()),!0}}}return!1}},682324:(e,t,o)=>{o.d(t,{GV:()=>l,Mk:()=>d,PX:()=>u,SD:()=>f});var n=o(686088),i=o(342937),r=o(157926),a=o(909104),s=o(92090),c=o(68670);function l(e){return e?d(e):f()}function u(e){return[c.RR,c.Qw].includes(e.tenantId)?n.XB.OutlookDotCom:n.XB.Office365}function d(e){if(e.mailboxProvider)return(0,s.A)(e.mailboxProvider);let t=(0,i.fV)(e);return t?.sourceType??n.XB.Other}function f(){return(0,r.D)()?n.XB.Office365:(0,a.pO)()?n.XB.OutlookDotCom:n.XB.Other}}}]),self.scriptsLoaded=self.scriptsLoaded||{},self.scriptsLoaded["owa.MsalAuth.m.a22d0748.js"]=1;