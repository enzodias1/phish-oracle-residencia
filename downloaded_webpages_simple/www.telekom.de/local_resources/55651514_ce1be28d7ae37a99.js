/*
 _____ _____ _     ___ _
|  _  | __  | |_ _|  _| |_
|     | __ -| | | |  _|  _|
|__|__|_____|_|_  |_| |_|.com
              |___|
*/

var projectData = {"id":55651514,"name":"Telekom - Privatkunden","jquery_include":"false","debug":false,"restrict_debug":false,"adhere_dnt":false,"max_cookie_lifetime":90,"activation_mode":"immediately","use_antiflicker":true,"snippet_revision":5041,"rules":"var qp_wt_mc = ablyftTools.getUrlParameter(\"wt_mc\"),\r\n    disable_cookie = ablyftTools.getCookie(\"ablyft_bot_disable\");\r\n\r\nif(\/^test_test_robot_\/i.test(qp_wt_mc) || \/^phdb_\/i.test(qp_wt_mc)){\r\n  disable_cookie = \"1\";\r\n  ablyftTools.setCookie(\"ablyft_bot_disable\", \"1\");\r\n}\r\n\r\n\r\nvar consentValues = [], cookieValue = decodeURIComponent(ablyftTools.getCookie(\"CONSENTMGR\")), consent = cookieValue.split(\"|\");\r\nfor (i = 0; i < consent.length; i++) {\r\n    consentPart = consent[i].split(\":\");\r\n    consentValues[consentPart[0]] = consentPart[1];\r\n}\r\n\r\nreturn (disable_cookie !== \"1\") && (cookieValue !== \"\" && consentValues.consent === \"true\" && consentValues.c1 !== \"0\");","rules_tracking":null,"tracker_url":"https:\/\/www2.telekom.de\/forward\/ablyft-log\/","asset_url":"https:\/\/www2.telekom.de\/forward\/ablyft-assets\/","metadata_key_exp_1":"costs","metadata_key_exp_2":"","metadata_key_exp_3":"","metadata_key_var_1":"","metadata_key_var_2":"","metadata_key_var_3":"","cookie_domain":null,"snippet_version":3.56,"storage":"default","run_only_on_reinit":false,"allow_in_iframes":false,"visual_editor_version":null,"external_tracking_domain":"","encode_storage_values":false,"usedEditorExtensions":[],"js":"console.log('ABlyft is now working');function onLifecycleEnd(){console.log('ABlyft lifecycle ended');if(typeof window.ablyft_reinit!=\"undefined\"&&window.ablyft_reinit===true){try{document.querySelector('#__tealiumGDPRecModal').style.display=\"none\";}catch(e){}\ntry{document.querySelector('#__tealiumGDPRcpPrefs').style.display=\"none\";}catch(e){}}}\nwindow.ablyft=window.ablyft||[];window.ablyft.push({eventType:'addListener',listener:{type:'lifecycleEnd',handler:onLifecycleEnd}});","css":"","helper_js":"","is_spa":true,"pages":[{"id":18630970,"name":"OneShop_Bestellbestaetigung","trigger":"api","trigger_js":"","api_name":"oneshop_bestellbestaetigung","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[],"goals":[33582157,80935904],"url_targetings":[{"id":4291,"type":"include","url":"https:\/\/www.telekom.de\/shop\/order-confirmation","url_type":"simple"}]},{"id":22709234,"name":"Startseite","trigger":"direct","trigger_js":"","api_name":"startseite","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[97329481,46286979],"goals":[30423556,92634993],"url_targetings":[{"id":3593,"type":"include","url":"https:\/\/www.telekom.de\/start","url_type":"simple"}]},{"id":24292546,"name":"Mobilfunk_Smartphonetarife (alt)","trigger":"direct","trigger_js":"","api_name":"mobilfunk_smartphonetarife","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[],"goals":[97637429],"url_targetings":[{"id":18789,"type":"include","url":"https:\/\/www.telekom.de\/mobilfunk\/tarife\/smartphone-tarife","url_type":"simple"}]},{"id":32239637,"name":"Oneshop_Smartphonetarife_URL","trigger":"url_change_history","trigger_js":"","api_name":"copy-of-mobilfunk_oneshop_smartphonetarife","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[40901879],"goals":[],"url_targetings":[{"id":36544,"type":"include","url":"https:\/\/www.telekom.de\/shop\/tarife\/smartphone-tarife","url_type":"simple"}]},{"id":35707504,"name":"OneShop_Bestellbestaetigung_Conf","trigger":"api","trigger_js":"","api_name":"oneshop_bestellbestaetigung_conf","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[],"goals":[28670437,75801548],"url_targetings":[{"id":24911,"type":"include","url":"https:\/\/www.telekom.de\/shop\/order-confirmation","url_type":"simple"}]},{"id":45949281,"name":"OneShop_Tarifwechsel_Konfiguratorseiten","trigger":"api","trigger_js":"","api_name":"festnetz_oneshop_konfigurator_tw","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[17421428],"goals":[],"url_targetings":[{"id":53505,"type":"include","url":"https:\/\/www.telekom.de\/shop\/fixed\/configurator","url_type":"simple"}]},{"id":45997989,"name":"Glasfaser_Glasfaser Tarife","trigger":"direct","trigger_js":"","api_name":"glasfaser_glasfaser-tarife","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[43220353],"goals":[40045278],"url_targetings":[{"id":4230,"type":"include","url":"https:\/\/www.telekom.de\/netz\/glasfaser","url_type":"simple"}]},{"id":48719996,"name":"OneShop_TV Tariftabelle vor VVP","trigger":"api","trigger_js":"","api_name":"festnetz_oneshop_tv-tariftabelle-vor-vvp","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[73502940],"goals":[94887404],"url_targetings":[{"id":41481,"type":"include","url":"https:\/\/www.telekom.de\/shop\/tarife\/magenta-tv-mit-internet-festnetz","url_type":"simple"}]},{"id":51225533,"name":"OneShop_Internet-Festnetz_Doubleplaytarife","trigger":"direct","trigger_js":"","api_name":"oneshop_internet-festnetz_doubleplaytarife","poll_on_rules":true,"deactivation_mode":"reset","rules_js":"return true;","experiments":[58020392],"goals":[98821736],"url_targetings":[{"id":24646,"type":"include","url":"https:\/\/www.telekom.de\/shop\/tarife\/internet-tarife","url_type":"simple"}]},{"id":73139985,"name":"OneShop_Tariftabelle vor VVP","trigger":"api","trigger_js":"","api_name":"festnetz_oneshop_tariftabelle-vor-vvp","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[30951379],"goals":[75483307],"url_targetings":[{"id":41351,"type":"include","url":"https:\/\/www.telekom.de\/shop\/tarife\/internet-tarife","url_type":"simple"}]},{"id":75465203,"name":"Oneshop_Smartphonetarife","trigger":"api","trigger_js":"","api_name":"mobilfunk_oneshop_smartphonetarife","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[11732061],"goals":[45313652,59492891],"url_targetings":[{"id":19266,"type":"include","url":"https:\/\/www.telekom.de\/shop\/tarife\/smartphone-tarife","url_type":"simple"}]},{"id":80829936,"name":"OneShop_Tariftabelle nach VVP","trigger":"api","trigger_js":"","api_name":"festnetz_oneshop_tariftabelle-nach-vvp","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[30951379],"goals":[15402964],"url_targetings":[{"id":41483,"type":"include","url":"https:\/\/www.telekom.de\/shop\/tarife\/internet-tarife","url_type":"simple"}]},{"id":84269780,"name":"SPA_Mobilfunk_OneShop_EG-Katalog","trigger":"url_change_history","trigger_js":"","api_name":"spa_mobilfunk_oneshop_eg-katalog","poll_on_rules":false,"deactivation_mode":"persistent","rules_js":"return true;","experiments":[83257922,10199671],"goals":[],"url_targetings":[{"id":9040,"type":"include","url":"https:\/\/www.telekom.de\/shop\/geraete\/smartphones","url_type":"simple"}]},{"id":86705100,"name":"Mobilfunk_Oneshop_EG-katalog","trigger":"api","trigger_js":"","api_name":"mobilfunk_oneshop_eg-katalog","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[],"goals":[21530099],"url_targetings":[{"id":9039,"type":"include","url":"https:\/\/www.telekom.de\/shop\/geraete\/smartphones","url_type":"simple"}]},{"id":90430122,"name":"OneShop_TV Tariftabelle nach VVP","trigger":"api","trigger_js":"","api_name":"festnetz_oneshop_tv-tariftabelle-nach-vvp","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[73502940],"goals":[48578975],"url_targetings":[{"id":41484,"type":"include","url":"https:\/\/www.telekom.de\/shop\/tarife\/magenta-tv-mit-internet-festnetz","url_type":"simple"}]},{"id":91097296,"name":"GlasfaserSeite - Besucher Status Connected","trigger":"api","trigger_js":"","api_name":"glasfaserseite-connected","poll_on_rules":false,"deactivation_mode":"reset","rules_js":"return true;","experiments":[84014933],"goals":[],"url_targetings":[{"id":8731,"type":"include","url":"https:\/\/www.telekom.de\/netz\/glasfaser","url_type":"simple"}]}],"experiments":[{"id":10199671,"status":"preview","name":"MF_EG_2025-07_Kacheln verkleinern","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-07-23 12:40:37","updated_at":"2025-07-25 10:03:59","published_at":"2025-07-25 10:03:59","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":52728293,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":23727856,"name":"Variation #1","css_code":"","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"console.log('Test funktioniert');","reset_js":"","css":"","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":11732061,"status":"preview","name":"MF_2025_08-Reihenfolge von gross nach klein (XL -> XS)","traffic_allocation":100,"audiences_match_type":"all","created_at":"2024-03-26 15:36:16","updated_at":"2025-09-25 09:40:12","published_at":"2025-09-25 09:40:12","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":83944332,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":68854291,"name":"Variation #1","css_code":".co_ab_hidden {\r\n    display: none !important;\r\n    visibility: hidden !important;\r\n}\r\n\r\n\/* overwrite native \"red dot\" styling (mobile only) *\/\r\ndiv[data-qa=\"undefined_undefined_Dot\"].active {\r\n    background: white;\r\n    border: 2px solid rgb(38, 38, 38);\r\n    transform: scale(1);\r\n}\r\n\r\ndiv[data-qa=\"undefined_undefined_Dot\"].co_ab_active {\r\n    border: none;\r\n    transform: none;\r\n    background: rgb(226, 0, 116);\r\n}","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"var isMobile=document.querySelector(\".tariffCardsWrapperMobile\")||false;var currentDot=0;var cardSelected=false;ablyftTools.waitForElement(\"div.carouselItemsWrap\",function(doc){var tariffCardContainer=document.querySelector(\"div.carouselItemsWrap > div\"),tariffCardNodes=document.querySelectorAll(\"div.carouselItemsWrap > div > div\");tariffCardContainer.id=\"co_ab-carouselparent\";if(isMobile){orderCardsMobile(doc,tariffCardContainer,tariffCardNodes,true);}else{orderCards(doc,tariffCardContainer,tariffCardNodes,true);}\nconst cardObserverConfig={subtree:true,childList:true};const cardObserverCallback=(mutationList,observer)=>{observer.disconnect();tariffCardNodes=document.querySelectorAll(\"div.carouselItemsWrap > div > div\");for(const mutation of mutationList){if(mutation.target.className===\"carouselItemsWrap\"&&mutation.addedNodes.length>0){waitForCardsAndReorder();}}\nwaitForButtons(function(){updateOriginalButtons();},0);observer.observe(doc,cardObserverConfig);};const cardObserver=new MutationObserver(cardObserverCallback);cardObserver.observe(doc,cardObserverConfig);setTimeout(function(){var prevBtn=document.querySelector(\"button.prev-btn\");if(prevBtn&&!window.coabPrevBtnClicked){prevBtn.click();window.coabPrevBtnClicked=true;}},200);observeCarouselForTransformation(tariffCardContainer);});var suppressTransformUntil=0;var lastTransformX=0;var cardWidth=200;const tolerance=50;function parseTranslateX(style){const match=\/translate3d\\((-?\\d+(\\.\\d+)?)px,\/.exec(style);return match?parseInt(match[1],10):null;}\nfunction markClick(){suppressTransformUntil=Date.now()+150;}\ndocument.addEventListener('click',markClick,true);function observeCarouselForTransformation(tariffCardContainer){const carouselObserverConfig={attributes:true,attributeFilter:[\"style\",\"data-offset\"],attributeOldValue:true};const carouselObserverCallback=(mutationList,observer)=>{observer.disconnect();for(const mutation of mutationList){if(mutation.type===\"attributes\"&&mutation.target.dataset.customTransform===\"true\"){mutation.target.dataset.customTransform=\"false\";}else if(mutation.target.dataset.buttonTransform===\"true\"){mutation.target.dataset.buttonTransform=\"false\";}else if(mutation.target.dataset.customTransform===\"false\"||mutation.target.dataset.buttonTransform===\"false\"){if(mutation.oldValue){mutation.target.style=mutation.oldValue;}}}\nwaitForButtons(function(){updateOriginalButtons();},0);observer.observe(tariffCardContainer,carouselObserverConfig);};const carouselObserver=new MutationObserver(carouselObserverCallback);carouselObserver.observe(tariffCardContainer,carouselObserverConfig);}\nfunction orderCards(carouselContainer,tariffCardContainer,tariffCardNodes,initialize=false){if(tariffCardNodes[0]&&!tariffCardNodes[0].dataset.coAbInitialized){initialize=true;}else if(tariffCardNodes[0]&&tariffCardNodes[0].dataset.coAbOrder!==\"0\"){initialize=false;}else return;const cardWidth=tariffCardNodes[0].offsetWidth;const wrapperWidth=carouselContainer.offsetWidth;const totalWidth=tariffCardNodes.length*cardWidth;const maxOffset=Math.max(0,totalWidth-wrapperWidth);Array.from(tariffCardNodes).reverse().forEach(function(card,index){tariffCardContainer.appendChild(card);if(initialize){let offset=(index+0.5)*cardWidth-wrapperWidth \/ 2;offset=Math.max(0,Math.min(offset,maxOffset));card.dataset.offset=offset;card.dataset.coAbOrder=index;card.addEventListener(\"click\",()=>{tariffCardContainer.dataset.customTransform=\"true\";tariffCardContainer.style.setProperty(\"transform\",`translate3d(${-card.dataset.offset}px, 0px, 0px)`);card.dataset.selected=\"true\";for(const otherCard of tariffCardNodes){if(otherCard===card)continue;otherCard.dataset.selected=\"false\";}\nif(index===0||index===1){toggleNextButtonShow();}else if(index>=tariffCardNodes.length-2){togglePrevButtonShow();}});var shadowRoots=card.querySelectorAll(\".htmlTemplate\");shadowRoots.forEach(function(root){const shadowDOM=root.shadowRoot;if(shadowDOM){shadowDOM.addEventListener(\"click\",function(){card.click();});}});card.dataset.coAbInitialized=\"true\";}});}\nfunction updateOriginalButtons(){const buttonContainer=document.querySelector(\"div.carouselButtons\");if(!buttonContainer)return;const prevButton=document.querySelector(\"button.prev-btn:not(.co_ab_prev-btn)\");const nextButton=document.querySelector(\"button.next-btn:not(.co_ab_next-btn)\");var newPrevButton=document.querySelector(\"button.prev-btn.co_ab_prev-btn\");var newNextButton=document.querySelector(\"button.next-btn.co_ab_next-btn\");if(!newPrevButton){newPrevButton=createPrevButton();buttonContainer.appendChild(newPrevButton);newPrevButton.classList.add(\"co_ab_hidden\");}\nif(!newNextButton){newNextButton=createNextButton();buttonContainer.appendChild(newNextButton);}\nnewPrevButton.addEventListener(\"click\",function(){newNextButton.classList.remove(\"co_ab_hidden\");newPrevButton.classList.add(\"co_ab_hidden\");});newNextButton.addEventListener(\"click\",function(){newPrevButton.classList.remove(\"co_ab_hidden\");newNextButton.classList.add(\"co_ab_hidden\");});if(prevButton){prevButton.style=\"display: none;\";}\nif(nextButton){nextButton.style=\"display: none;\";}}\nfunction createNextButton(){const btn=document.createElement(\"button\");btn.className=\"sc-jlZhew jpeSuw dt_button nav-button co_ab_next-btn next-btn defaultControl btn_medium\";btn.setAttribute(\"aria-label\",\"Next Button\");btn.setAttribute(\"data-qa\",\"undefined_undefined_NextButton\");btn.tabIndex=-1;const span=document.createElement(\"span\");span.className=\"buttonText\";const iconWrapper=document.createElement(\"i\");iconWrapper.className=\"sc-aXZVg bBHtqA dt_icon\";iconWrapper.id=\"svg_wrapper_undefined\";const svg=document.createElementNS(\"http:\/\/www.w3.org\/2000\/svg\",\"svg\");svg.setAttribute(\"width\",\"1em\");svg.setAttribute(\"height\",\"1em\");svg.setAttribute(\"aria-hidden\",\"true\");svg.setAttribute(\"viewBox\",\"0 0 24 24\");svg.setAttribute(\"color\",\"#ffffff\");const path=document.createElementNS(\"http:\/\/www.w3.org\/2000\/svg\",\"path\");path.setAttribute(\"d\",\"M.4 16.95c-.25-.35-.2-.8.1-1.05L9.3 9 .55 2.1a.691.691 0 0 1-.1-1.05C.7.75 1.2.65 1.5.95L11.7 9 1.45 17.1c-.3.25-.8.2-1.05-.15z\");svg.appendChild(path);iconWrapper.appendChild(svg);span.appendChild(iconWrapper);btn.appendChild(span);btn.addEventListener(\"click\",function(){const carouselContainer=document.querySelector(\"div.carouselItemsWrap > div\");if(carouselContainer){carouselContainer.dataset.buttonTransform=\"true\";carouselContainer.style.setProperty(\"transform\",`translate3d(-284px, 0px, 0px)`);}});return btn;}\nfunction createPrevButton(){const btn=document.createElement(\"button\");btn.className=\"sc-jlZhew jpeSuw dt_button nav-button co_ab_prev-btn prev-btn defaultControl btn_medium\";btn.setAttribute(\"aria-label\",\"Previous Button\");btn.setAttribute(\"data-qa\",\"undefined_undefined_PrevButton\");btn.tabIndex=-1;const prevSpan=document.createElement(\"span\");prevSpan.className=\"buttonText\";const prevIconWrapper=document.createElement(\"i\");prevIconWrapper.className=\"sc-aXZVg bBHtqA dt_icon\";prevIconWrapper.id=\"svg_wrapper_undefined\";const prevSvg=document.createElementNS(\"http:\/\/www.w3.org\/2000\/svg\",\"svg\");prevSvg.setAttribute(\"width\",\"1em\");prevSvg.setAttribute(\"height\",\"1em\");prevSvg.setAttribute(\"aria-hidden\",\"true\");prevSvg.setAttribute(\"viewBox\",\"0 0 24 24\");prevSvg.setAttribute(\"color\",\"#ffffff\");const prevPath=document.createElementNS(\"http:\/\/www.w3.org\/2000\/svg\",\"path\");prevPath.setAttribute(\"d\",\"M10.55 17.1L.3 9 10.55.9c.35-.25.8-.2 1.05.1.25.35.2.8-.1 1.05L2.7 9l8.75 6.9c.35.25.4.75.1 1.05-.2.35-.7.4-1 .15z\");prevSvg.appendChild(prevPath);prevIconWrapper.appendChild(prevSvg);prevSpan.appendChild(prevIconWrapper);btn.appendChild(prevSpan);btn.addEventListener(\"click\",function(){const carouselContainer=document.querySelector(\"div.carouselItemsWrap > div\");if(carouselContainer){carouselContainer.dataset.buttonTransform=\"true\";carouselContainer.style.setProperty(\"transform\",`translate3d(0px, 0px, 0px)`);}});return btn;}\nfunction toggleNextButtonShow(){const newNextButton=document.querySelector(\"button.next-btn.co_ab_next-btn\");const newPrevButton=document.querySelector(\"button.prev-btn.co_ab_prev-btn\");if(newNextButton&&newPrevButton){if(newNextButton.classList.contains(\"co_ab_hidden\")){newNextButton.classList.remove(\"co_ab_hidden\")}\nif(!newPrevButton.classList.contains(\"co_ab_hidden\")){newPrevButton.classList.add(\"co_ab_hidden\")}}}\nfunction togglePrevButtonShow(){const newPrevButton=document.querySelector(\"button.prev-btn.co_ab_prev-btn\");const newNextButton=document.querySelector(\"button.next-btn.co_ab_next-btn\");if(newPrevButton&&newNextButton){if(newPrevButton.classList.contains(\"co_ab_hidden\")){newPrevButton.classList.remove(\"co_ab_hidden\")}\nif(!newNextButton.classList.contains(\"co_ab_hidden\")){newNextButton.classList.add(\"co_ab_hidden\")}}}\nfunction waitForButtons(method,i){const prevButton=document.querySelector(\"button.prev-btn:not(.co_ab_prev-btn)\");const nextButton=document.querySelector(\"button.next-btn:not(.co_ab_next-btn)\");var buttonFound=prevButton||nextButton||false;if(buttonFound){method();}else{if(i<50){setTimeout(function(){waitForButtons(method,i+1)},50);}}}\nfunction orderCardsMobile(carouselContainer,carousel,tariffCardNodes,initialize=false){var newCarousel=document.getElementById(\"co_ab_carouselMobile\")||createCarousel(carousel);const cardWidth=tariffCardNodes[0].offsetWidth;const wrapperWidth=carouselContainer.offsetWidth;const totalWidth=tariffCardNodes.length*cardWidth;const maxOffset=Math.max(0,totalWidth-wrapperWidth);carousel.insertAdjacentElement(\"afterend\",newCarousel);carousel.style.display=\"none\";var setTranslate=(x)=>{const cardWidth=newCarousel.children[0].offsetWidth;const totalWidth=newCarousel.scrollWidth;const containerWidth=carouselContainer.clientWidth;let softX=x;const leftOverscroll=0.75*cardWidth;const rightOverscroll=0.75*cardWidth;if(softX>leftOverscroll){softX=leftOverscroll+(softX-leftOverscroll)*0.3;}\nconst maxRight=-(totalWidth-containerWidth);if(softX<maxRight-rightOverscroll){softX=(maxRight-rightOverscroll)+(softX-(maxRight-rightOverscroll))*0.3;}\ncurrentX=softX;newCarousel.style.transform=`translate3d(${currentX}px, 0, 0)`;}\nif(newCarousel.dataset.scrollInitialized!==\"true\"){var startX=0;var currentX=0;var prevX=0;var velocity=0;var isDragging=false;var momentumID;var snapToCard=()=>{const cardWidth=newCarousel.children[0].offsetWidth;const containerWidth=carouselContainer.clientWidth;const totalWidth=newCarousel.scrollWidth;const minTranslate=Math.min(containerWidth-totalWidth,0);let cardIndex=Math.round(-currentX \/ cardWidth);if(velocity<0){cardIndex=Math.ceil(-currentX \/ cardWidth);}else{cardIndex=Math.floor(-currentX \/ cardWidth);}\nconst totalCards=tariffCardNodes.length;const visibleCards=Math.floor(containerWidth \/ cardWidth);const maxIndex=totalCards-visibleCards;if(cardIndex<0)cardIndex=0;if(cardIndex>maxIndex)cardIndex=maxIndex;let snappedX=-cardIndex*cardWidth;if(snappedX<minTranslate)snappedX=minTranslate;newCarousel.style.transition='500ms ease-out';currentX=snappedX;newCarousel.style.transform=`translate3d(${currentX}px, 0, 0)`;toggleDotButtonShow(cardIndex);}\nnewCarousel.style.transform='translate3d(0px, 0, 0)';newCarousel.addEventListener('touchstart',(e)=>{cancelAnimationFrame(momentumID);startX=e.touches[0].clientX-currentX;prevX=e.touches[0].clientX;velocity=0;isDragging=true;newCarousel.style.transition='ease-out';carouselContainer.style.cursor='grabbing';});newCarousel.addEventListener('touchmove',(e)=>{if(!isDragging)return;const x=e.touches[0].clientX;const dx=x-prevX;velocity=dx;prevX=x;setTranslate(x-startX);});newCarousel.addEventListener('touchend',()=>{isDragging=false;newCarousel.style.transition='500ms ease-out';carouselContainer.style.cursor='-webkit-grab';function momentum(){let friction=0.5;const totalWidth=newCarousel.scrollWidth;const containerWidth=carouselContainer.clientWidth;const leftLimit=0;const rightLimit=containerWidth-totalWidth;if(currentX>leftLimit||currentX<rightLimit){friction=0.5;}\nvelocity*=friction;if(Math.abs(velocity)<0.4){snapToCard();return;}\nsetTranslate(currentX+velocity);momentumID=requestAnimationFrame(momentum);}\nmomentum();});newCarousel.dataset.scrollInitialized=\"true\";}\nvar oldDotsContainer=document.querySelector(\"div.dt_navDots.bottomCenter:not(.co_ab_dotsContainer)\");if(oldDotsContainer&&initialize){var dotsContainer=oldDotsContainer.cloneNode(true);dotsContainer.classList.add(\"co_ab_dotsContainer\");oldDotsContainer.style.display=\"none\";oldDotsContainer.insertAdjacentElement(\"afterend\",dotsContainer);var dots=dotsContainer.querySelectorAll(\"div\");Array.from(dots).forEach(function(dot,index){dot.addEventListener(\"click\",function(){currentDot=index;var correspondingCard=newCarousel.querySelector(`div[data-co-ab-order=\"${index}\"]`);if(correspondingCard){setTranslate(-(correspondingCard.dataset.offset));}\ntoggleDotButtonShow(index);});});var buttonPrev=dotsContainer.querySelector(\"button.prev-btn\");var buttonNext=dotsContainer.querySelector(\"button.next-btn\");if(buttonPrev&&buttonNext){buttonPrev.addEventListener(\"click\",function(){if(!(currentDot<=0)){currentDot--;dots[currentDot].click();}else currentDot=0;});buttonNext.addEventListener(\"click\",function(){if(!(currentDot>=newCarousel.childElementCount-1)){currentDot++;dots[currentDot].click();}else currentDot=newCarousel.childElementCount;});}}\nArray.from(tariffCardNodes).reverse().forEach(function(card,index){newCarousel.appendChild(card);if(initialize){let offset=(index+0.5)*cardWidth-wrapperWidth \/ 2;offset=Math.max(0,Math.min(offset,maxOffset));card.dataset.offset=offset;card.dataset.coAbOrder=index;card.addEventListener(\"click\",()=>{newCarousel.dataset.customTransform=\"true\";newCarousel.style.setProperty(\"transform\",`translate3d(${-card.dataset.offset}px, 0px, 0px)`);currentX=-card.dataset.offset;card.dataset.selected=\"true\";cardSelected=index;currentDot=index;for(const otherCard of tariffCardNodes){if(otherCard===card)continue;otherCard.dataset.selected=\"false\";}\ntoggleDotButtonShow(index);});var shadowRoots=card.querySelectorAll(\".htmlTemplate\");shadowRoots.forEach(function(root){const shadowDOM=root.shadowRoot;if(shadowDOM){shadowDOM.addEventListener(\"click\",function(){card.click();});}});card.dataset.coAbInitialized=\"true\";newCarousel.style.setProperty(\"transform\",`translate3d(0px, 0px, 0px)`);}});if(initialize){cardSelected=cardSelected===false?2:cardSelected;}\ninitializeOnCard(cardSelected);}\nfunction createCarousel(oldCarousel){const carousel=document.createElement(\"div\");carousel.id=\"co_ab_carouselMobile\";var oldStyle=oldCarousel.getAttribute(\"style\");carousel.setAttribute(\"style\",oldStyle);return carousel;}\nfunction toggleDotButtonShow(index){var dotButtons=document.querySelectorAll('.co_ab_dotsContainer > div[data-qa=\"undefined_undefined_Dot\"]');if(!(dotButtons.length>0))return;dotButtons.forEach(function(dot){dot.classList.remove(\"co_ab_active\");});dotButtons[index].classList.add(\"co_ab_active\");}\nfunction initializeOnCard(cardIndex){var cardEl=document.querySelector(`div[data-co-ab-order=\"${cardIndex}\"] div.tariffCard`);setTimeout(function(){if(cardEl){cardEl.click();}},300);}\nfunction waitForCardsAndReorder(i=0){const tariffCardNodes=document.querySelectorAll(\"div.carouselItemsWrap > div > div\");if(tariffCardNodes.length>0){var carousel=document.querySelector(\"div.carouselItemsWrap\"),tariffCardContainer=document.querySelector(\"div.carouselItemsWrap > div\"),tariffCardButtons=document.querySelectorAll(\"div.dt_navDots.bottomCenter > div\");isMobile=isMobile||document.querySelector(\".tariffCardsWrapperMobile\")||false;if(isMobile){orderCardsMobile(carousel,tariffCardContainer,tariffCardNodes,tariffCardButtons);}else{orderCards(carousel,tariffCardContainer,tariffCardNodes);}\ntoggleNextButtonShow();tariffCardContainer.dataset.customTransform=\"true\";tariffCardContainer.style.setProperty(\"transform\",`translate3d(0px, 0px, 0px)`);observeCarouselForTransformation(tariffCardContainer);}else{if(i<50){setTimeout(function(){waitForCardsAndReorder(i+1)},50);}}}","reset_js":"","css":".co_ab_hidden {\r\n    display: none !important;\r\n    visibility: hidden !important;\r\n}\r\n\r\n\/* overwrite native \"red dot\" styling (mobile only) *\/\r\ndiv[data-qa=\"undefined_undefined_Dot\"].active {\r\n    background: white;\r\n    border: 2px solid rgb(38, 38, 38);\r\n    transform: scale(1);\r\n}\r\n\r\ndiv[data-qa=\"undefined_undefined_Dot\"].co_ab_active {\r\n    border: none;\r\n    transform: none;\r\n    background: rgb(226, 0, 116);\r\n}","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":17421428,"status":"preview","name":"FN_BK_2025-XX_Hardware Schritt ausblenden","traffic_allocation":100,"audiences_match_type":"any","created_at":"2025-08-28 21:03:10","updated_at":"2025-08-28 21:12:24","published_at":"2025-08-28 21:12:24","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":87503297,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":57950937,"name":"Variation #1","css_code":".my-extra-spinner-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(255,255,255,0.7); \/* leicht ausgegraut *\/\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 2;\r\n}\r\n\r\n.my-extra-spinner {\r\n  height: 3.667rem;\r\n  width: 3.667rem;\r\n  border-top: 3px solid rgb(226, 0, 116); \/* Telekom-Pink *\/\r\n  border-radius: 50%;\r\n  border-right: 3px solid transparent;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n.spinnerText {\r\n  margin-top: 1.667rem;\r\n  font-weight: bold;\r\n  font-size: 1rem;\r\n  color: rgb(38, 38, 38);\r\n  line-height: 1.5rem;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"var basketReached=false;function showExtraSpinner(){if(document.querySelector('.my-extra-spinner-overlay'))return;var overlay=document.createElement('div');overlay.classList.add('my-extra-spinner-overlay');var spinner=document.createElement('div');spinner.classList.add('my-extra-spinner');var spinnerText=document.createElement('p');spinnerText.classList.add('spinnerText');spinnerText.innerText='Angebote werden geladen...';overlay.appendChild(spinner);overlay.appendChild(spinnerText);document.body.appendChild(overlay);}\nfunction hideExtraSpinner(){var ownSpinnerOverlay=document.querySelector('.my-extra-spinner-overlay');if(ownSpinnerOverlay)ownSpinnerOverlay.remove();}\nfunction clickWhenReady(buttonSelector,spinnerSelector,interval=500){let timer=setInterval(()=>{const spinner=document.querySelector(spinnerSelector);const button=document.querySelector(buttonSelector);if(spinner){return;}\nif(button&&!basketReached){button.click();}else{basketReached=true;clearInterval(timer);hideExtraSpinner();}},interval);}\nablyftTools.waitForElement('#fixed-toast-container',function(){if(!basketReached){showExtraSpinner();clickWhenReady('#price_summary_continue_cta_horizontal','div.spinner',500);}});","reset_js":"","css":".my-extra-spinner-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(255,255,255,0.7); \/* leicht ausgegraut *\/\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 2;\r\n}\r\n\r\n.my-extra-spinner {\r\n  height: 3.667rem;\r\n  width: 3.667rem;\r\n  border-top: 3px solid rgb(226, 0, 116); \/* Telekom-Pink *\/\r\n  border-radius: 50%;\r\n  border-right: 3px solid transparent;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n.spinnerText {\r\n  margin-top: 1.667rem;\r\n  font-weight: bold;\r\n  font-size: 1rem;\r\n  color: rgb(38, 38, 38);\r\n  line-height: 1.5rem;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":30951379,"status":"preview","name":"FN_DP_2025-09_Tarifempfehlung von L auf XL","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-09-15 09:07:06","updated_at":"2025-10-02 13:38:55","published_at":"2025-10-02 13:38:55","metadata_1":null,"metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":80243738,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":59425054,"name":"Variation #1","css_code":"#co_ab_badge{\r\n\tposition: absolute;\r\n    width: auto;\r\n    top: -2px;\r\n    right: -2px;\r\n    border-radius: 0px 0.25rem;\r\n    padding: 0.25rem 0.5rem;\r\n    max-width: 225px;\r\n    background: rgb(76, 165, 170);\r\n}\r\n\r\n#co_ab_badge div span {\r\n\tfont-size: 1rem;\r\n    line-height: 1.25rem;\r\n    font-weight: 700;\r\n}\r\n\r\n#co_ab_active {\r\n    position: absolute;\r\n    width: auto;\r\n    top: -2px;\r\n    right: -2px;\r\n    border-radius: 0px 0.25rem;\r\n    padding: 0.25rem 0.5rem;\r\n    max-width: 225px;\r\n\tbackground: rgb(226, 0 ,116);\r\n}\r\n\r\n#co_ab_active div span {\r\n\tfont-size: 1rem;\r\n    line-height: 1.25rem;\r\n    font-weight: 700;\r\n}","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"ablyftTools.waitForElement('.headingBadge',function(badge){var STORAGE_KEY='co_selected_tarif';var savedTarif=null;try{savedTarif=localStorage.getItem(STORAGE_KEY);}catch(e){}\nwindow.mmfnTarifSelected=savedTarif||window.mmfnTarifSelected||null;window.fnTarifSelected=window.mmfnTarifSelected||null;function persistSelected(name){window.mmfnTarifSelected=name||'';window.fnTarifSelected=window.mmfnTarifSelected;try{localStorage.setItem(STORAGE_KEY,(window.mmfnTarifSelected||'').trim());}catch(e){}}\nfunction setBadgeState(isSelected){if(!badge)return;badge.id=isSelected?'co_ab_active':'co_ab_badge';}\nfunction isSelected(kachel){if(kachel.classList.contains('checked'))return true;var ariaNode=kachel.matches('[aria-checked=\"true\"]')?kachel:kachel.querySelector('[aria-checked=\"true\"]');if(ariaNode)return true;var radio=kachel.querySelector('input[type=\"radio\"], .tariffCardRadioBtn input[type=\"radio\"]');if(radio&&radio.checked)return true;var flag=kachel.matches('[data-selected=\"true\"]')?kachel:kachel.querySelector('[data-selected=\"true\"]');if(flag)return true;return false;}\nfunction observeSelection(targetEl,kachel){var MutationObserver=window.MutationObserver||window.WebKitMutationObserver;if(!MutationObserver||!targetEl)return;var obs=new MutationObserver(function(){setBadgeState(isSelected(kachel));});obs.observe(targetEl,{attributes:true,subtree:true,attributeFilter:['class','aria-checked','data-selected','checked']});}\nvar cards=document.querySelectorAll('div.carouselItemsWrap span.dtCarouselItem div.tariffCard');var restored=false;cards.forEach(function(kachel){var tarifTitleEl=kachel.querySelector('div.tariffName');var titleText=(tarifTitleEl&&(tarifTitleEl.textContent||tarifTitleEl.innerHTML)||'').trim();if(savedTarif&&!restored&&titleText===savedTarif){setTimeout(function(){kachel.click();persistSelected(savedTarif);},0);restored=true;}\nif(!kachel.dataset.listenerAdded){kachel.addEventListener('click',function(ev){if(ev&&ev.isTrusted&&titleText){persistSelected(titleText);}});kachel.dataset.listenerAdded='true';}\nif(tarifTitleEl&&(tarifTitleEl.textContent||'').trim()==='MagentaZuhause XL'){var tarifNameContainer=kachel.querySelector('div > div');if(badge&&!badge.hasAttribute('observed')&&!tarifTitleEl.hasAttribute('observed')){if(tarifNameContainer){tarifNameContainer.insertAdjacentElement('afterbegin',badge);badge.setAttribute('observed','true');tarifTitleEl.setAttribute('observed','true');}\nvar initiallySelected=isSelected(kachel)||(!!savedTarif&&savedTarif===titleText);setBadgeState(initiallySelected);if(!savedTarif){setTimeout(function(){kachel.click();persistSelected(titleText);requestAnimationFrame(function(){setBadgeState(isSelected(kachel));});},100);}\nvar preferredTarget=kachel.querySelector('.tariffCardRadioBtn')||kachel.querySelector('input[type=\"radio\"]')||kachel;observeSelection(preferredTarget,kachel);if(!kachel.dataset.badgeSyncAdded){kachel.addEventListener('click',function(ev){if(ev&&ev.isTrusted){requestAnimationFrame(function(){setBadgeState(isSelected(kachel));});}});kachel.dataset.badgeSyncAdded='true';}}}});});","reset_js":"","css":"#co_ab_badge{\r\n\tposition: absolute;\r\n    width: auto;\r\n    top: -2px;\r\n    right: -2px;\r\n    border-radius: 0px 0.25rem;\r\n    padding: 0.25rem 0.5rem;\r\n    max-width: 225px;\r\n    background: rgb(76, 165, 170);\r\n}\r\n\r\n#co_ab_badge div span {\r\n\tfont-size: 1rem;\r\n    line-height: 1.25rem;\r\n    font-weight: 700;\r\n}\r\n\r\n#co_ab_active {\r\n    position: absolute;\r\n    width: auto;\r\n    top: -2px;\r\n    right: -2px;\r\n    border-radius: 0px 0.25rem;\r\n    padding: 0.25rem 0.5rem;\r\n    max-width: 225px;\r\n\tbackground: rgb(226, 0 ,116);\r\n}\r\n\r\n#co_ab_active div span {\r\n\tfont-size: 1rem;\r\n    line-height: 1.25rem;\r\n    font-weight: 700;\r\n}","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":40901879,"status":"running","name":"MF_MM_2025-08_Empfehlung Label auf L bei 1 Karte","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-08-17 09:05:21","updated_at":"2025-09-17 22:02:09","published_at":"2025-09-17 22:02:09","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":27765285,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":18881447,"name":"Variation #1","css_code":".co_ab_badge{\r\n\tposition: absolute;\r\n    width: auto;\r\n    top: -2px;\r\n    right: -1px;\r\n    border-radius: 0px 0.25rem;\r\n    padding: 0.25rem 0.5rem;\r\n    max-width: 225px;\r\n}","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"ablyftTools.waitForElement(\".headingBadge\",function(badge){function getG(n){var t=null,e=[];location.search.substr(1).split(\"&\").forEach(function(o){e=o.split(\"=\");if(e[0].toLowerCase()===n.toLowerCase())t=decodeURIComponent(e[1]);});return t;}\nconst adult=getG(\"adult\");const cards=document.querySelectorAll(\"div.carouselItemsWrap span.dtCarouselItem div.tariffCard\");window.mmHandyTarifSelected=window.mmHandyTarifSelected||null;cards.forEach((kachel,index)=>{const tarifNameText=kachel.querySelector(\"div.tariffName\")?.textContent||\"\";const tarifTitle=kachel.querySelector(\"div.tariffTitle\");let badgeIndex=null;if(adult===null||Number(adult)===1){badgeIndex=3;}\nelse if(Number(adult)>=2){badgeIndex=2;}\nif(badgeIndex!==null&&index===badgeIndex){if(badge&&!badge.hasAttribute(\"observed\")&&tarifTitle&&!tarifTitle.hasAttribute(\"observed\")){tarifTitle.insertAdjacentElement(\"beforebegin\",badge);badge.classList.add(\"co_ab_badge\");badge.setAttribute(\"observed\",\"true\");tarifTitle.setAttribute(\"observed\",\"true\");setTimeout(()=>{kachel.click();window.mmHandyTarifSelected=tarifNameText;},100);}}\nif(!kachel.dataset.listenerAdded){kachel.addEventListener(\"click\",()=>{window.mmHandyTarifSelected=tarifNameText;});kachel.dataset.listenerAdded=\"true\";}});});","reset_js":"","css":".co_ab_badge{\r\n\tposition: absolute;\r\n    width: auto;\r\n    top: -2px;\r\n    right: -1px;\r\n    border-radius: 0px 0.25rem;\r\n    padding: 0.25rem 0.5rem;\r\n    max-width: 225px;\r\n}","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":43220353,"status":"running","name":"GF_2025-07_area page ueberspringen","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-07-17 10:32:56","updated_at":"2025-07-24 11:41:04","published_at":"2025-07-20 22:02:14","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":98785834,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":72149343,"name":"Variation #1","css_code":"","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"window.testvar=true;window.ablyft_variant='varianteB';","reset_js":"","css":"","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":46286979,"status":"running","name":"SS_BK_2025-09_Fuer unsere Kunden Bereich Gelb einfaerben","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-09-24 09:05:32","updated_at":"2025-09-29 17:05:56","published_at":"2025-09-29 07:34:13","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":80304973,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":78430312,"name":"Variation #1","css_code":".co_ab_bkSection {\r\n\tbackground-color: #F5E194;\r\n    padding-bottom: 20px !important;\r\n    border-radius: 26px;\r\n    padding-left: 40px !important;\r\n    \/*padding-right: 30px !important;*\/\r\n  \tmax-width: 97% !important;\r\n}\r\n\r\n.co_ab_text-iwant {\r\n\tfont-weight: 600 !important;\r\n    font-size: xx-large;\r\n    padding-left: 10px;\r\n}\r\n\r\n.co_ab_button-wrapper {\r\n\tgap: 10px !important;\r\n}\r\n\r\n.co_ab_buttons {\r\n\tbackground-color: #FFFFFF66;\r\n    border: none !important;\r\n    font-weight: 600 !important;\r\n  \ttext-align: initial !important;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: .5rem;\r\n}\r\n\r\n.co_ab_buttons .co_ab_arrow{\r\n    display: inline-flex;\r\n    flex: 0 0 auto;\r\n    margin-left: auto; \r\n}\r\n\r\n#link-section-heading{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 0px !important;\r\n}\r\n#link-section-heading .co_ab_man{\r\n  width: 60px; \r\n  height: auto;\r\n  flex: 0 0 auto;\r\n}\r\n\r\n.co_ab_buttons .co_ab_label{\r\n  flex: 1 1 auto; \r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .co_ab_bkSection {\r\n    max-width: 94%;\r\n    padding-left: 20px !important;\r\n    padding-right: 20px !important;\r\n  }\r\n}","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"const config={arrow:'<svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\"><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M12.5048 5.50584C12.7781 5.23246 13.2214 5.23242 13.4947 5.50577L17.9898 10.0001L13.4948 14.4957C13.2215 14.7691 12.7783 14.7691 12.5049 14.4958C12.2315 14.2224 12.2314 13.7792 12.5048 13.5058L15.31 10.7002H2.9998C2.61321 10.7002 2.2998 10.3868 2.2998 10.0002C2.2998 9.61362 2.61321 9.30022 2.9998 9.30022H15.3097L12.5049 6.49579C12.2315 6.22244 12.2314 5.77923 12.5048 5.50584Z\" fill=\"black\"\/><\/svg>',manBig:'<svg class=\"co_ab_man\" width=\"83\" height=\"80\" viewBox=\"0 0 83 80\" fill=\"none\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\"><path d=\"M28.8166 59.4872L41.3985 72.2051L53.9804 59.4872H63.1125C72.6504 59.4872 80.5648 66.2564 82.1883 75.6923L83 80H0L0.608802 75.6923C2.23227 66.2564 10.1467 59.4872 19.6846 59.4872H28.8166ZM41.3985 0C55.6039 0 65.7506 10.2564 65.7506 24.6154C65.7506 38.5641 56.0098 53.3333 41.3985 53.3333C26.7873 53.3333 17.0465 38.5641 17.0465 24.6154C17.0465 10.2564 27.1932 0 41.3985 0ZM41.3985 6.15385C30.846 6.15385 23.1345 13.9487 23.1345 24.6154C23.1345 35.4872 30.4401 47.1795 41.3985 47.1795C52.357 47.1795 59.6626 35.4872 59.6626 24.6154C59.6626 13.9487 51.9511 6.15385 41.3985 6.15385Z\" fill=\"#F0D061\"\/><\/svg>',firstBtnText:'Internettarif wechseln',secondBtnText:'TV buchen und anpassen',thirdBtnText:'Empfehlen und Verdienen',fourthBtnText:'Handytarif verl\u00e4ngern',fifthBtnText:'Rechnung einsehen',sixthBtnText:'PlusKarte buchen',firstBtnHref:'https:\/\/www.telekom.de\/shop\/deep-link?bp=tariffChange&targetedLob=fixed&msisdn=default',secondBtnHref:'https:\/\/www.telekom.de\/shop\/deep-link?bp=tariffChange&targetedLob=fixed&msisdn=default&businessAction=addTv',thirdBtnHref:'https:\/\/www.telekom-empfehlen.de\/',fourthBtnHref:'https:\/\/www.telekom.de\/unterwegs\/vertragsverlaengerung\/mobilfunk-konfigurator',fifthBtnHref:'https:\/\/www.telekom.de\/mein-magenta-kundencenter\/zahlungen',sixthBtnHref:'https:\/\/www.telekom.de\/shop\/tarife\/zusatzkarten',firstBtnDTR:'content.text.internettarif-wechseln',secondBtnDTR:'content.text.tv-buchen-und-anpassen',thirdBtnDTR:'content.text.empfehlen-und-verdienen',fourthBtnDTR:'content.text.handytarif-verlaengern',fifthBtnDTR:'content.text.rechnung-einsehen',sixthBtnDTR:'content.text.pluskarte-buchen'};ablyftTools.waitForElement('html.hydrated',function(){const section=document.querySelector(\"section[class^='LinkSection_LinkSection_']\");if(section)section.classList.add('co_ab_bkSection');const iWant=document.querySelector('#link-section-heading');if(iWant){iWant.classList.add('co_ab_text-iwant');iWant.insertAdjacentHTML('afterbegin',config.manBig);}\nconst buttonWrapper=document.querySelector(\"div[class^='LinkSection_LinkSection__link-wrapper_']\");if(buttonWrapper){buttonWrapper.classList.add('co_ab_button-wrapper');}\nconst buttons=document.querySelectorAll(\"a[class^='LinkSquare_LinkSquare_']\");const map=[{text:config.firstBtnText,href:config.firstBtnHref,dtr:config.firstBtnDTR},{text:config.secondBtnText,href:config.secondBtnHref,dtr:config.secondBtnDTR},{text:config.thirdBtnText,href:config.thirdBtnHref,dtr:config.thirdBtnDTR},{text:config.fourthBtnText,href:config.fourthBtnHref,dtr:config.fourthBtnDTR},{text:config.fifthBtnText,href:config.fifthBtnHref,dtr:config.fifthBtnDTR},{text:config.sixthBtnText,href:config.sixthBtnHref,dtr:config.sixthBtnDTR}];buttons.forEach((el,i)=>{el.classList.add('co_ab_buttons');const item=map[i];if(!item)return;el.innerHTML=`<span class=\"co_ab_label\">${item.text}<\/span><span class=\"co_ab_arrow\" aria-hidden=\"true\">${config.arrow}<\/span>`;el.href=item.href;el.setAttribute('data-tealium-rel',item.dtr);});});","reset_js":"","css":".co_ab_bkSection {\r\n\tbackground-color: #F5E194;\r\n    padding-bottom: 20px !important;\r\n    border-radius: 26px;\r\n    padding-left: 40px !important;\r\n    \/*padding-right: 30px !important;*\/\r\n  \tmax-width: 97% !important;\r\n}\r\n\r\n.co_ab_text-iwant {\r\n\tfont-weight: 600 !important;\r\n    font-size: xx-large;\r\n    padding-left: 10px;\r\n}\r\n\r\n.co_ab_button-wrapper {\r\n\tgap: 10px !important;\r\n}\r\n\r\n.co_ab_buttons {\r\n\tbackground-color: #FFFFFF66;\r\n    border: none !important;\r\n    font-weight: 600 !important;\r\n  \ttext-align: initial !important;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: .5rem;\r\n}\r\n\r\n.co_ab_buttons .co_ab_arrow{\r\n    display: inline-flex;\r\n    flex: 0 0 auto;\r\n    margin-left: auto; \r\n}\r\n\r\n#link-section-heading{\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  padding: 0px !important;\r\n}\r\n#link-section-heading .co_ab_man{\r\n  width: 60px; \r\n  height: auto;\r\n  flex: 0 0 auto;\r\n}\r\n\r\n.co_ab_buttons .co_ab_label{\r\n  flex: 1 1 auto; \r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .co_ab_bkSection {\r\n    max-width: 94%;\r\n    padding-left: 20px !important;\r\n    padding-right: 20px !important;\r\n  }\r\n}","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":58020392,"status":"running","name":"FN_DP_2025-08_Anmelden Bereich auf Fixed visuell staerker darstellen","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-08-19 09:58:35","updated_at":"2025-09-30 06:48:07","published_at":"2025-09-30 06:48:07","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":27292904,"name":"Original","css_code":"","baseline":true,"traffic_allocation":0,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":22502258,"name":"Variation #1","css_code":".co_ab_man-icon {\r\n    width: 44px;\r\n    height: auto;\r\n}\r\n\r\nbutton.co_ab_button {\r\n    margin-left: auto;\r\n    background: #ffffff;\r\n    color: #000000;\r\n    border-color: #ffffff;\r\n}\r\n\r\nbutton.co_ab_button:hover {\r\n    background-color: #f7f7f7;\r\n  \tborder-color: #ffffff;\r\n  \tcolor: #000000;\r\n}\r\n\r\n.co_ab_icon-wrapper {\r\n    position: relative;\r\n}\r\n\r\ni.co_ab_icon-general {\r\n    position: absolute;\r\n    font-size: 0.4em;\r\n    height: 17px;\r\n    width: 17px;\r\n    border-radius: 50%;\r\n    background: rgb(107, 179, 36);\r\n    -webkit-box-align: center;\r\n    align-items: center;\r\n    -webkit-box-pack: center;\r\n    justify-content: center;\r\n    stroke: currentcolor;\r\n    right: 7px;\r\n    top: 2px;\r\n    transform: translate(3px, -2px);\r\n    box-shadow: #F9E188 0px 0px 0px 1px;\r\n    color: rgb(255, 255, 255) !important;\r\n}\r\n\r\n.co_ab_icon-check {\r\n    fill: currentColor;\r\n    height: 14px;\r\n    width: 13px;\r\n    top: 1px;\r\n    right: 2px;\r\n    position: absolute;\r\n}\r\n\r\n.co_ab_left-wrapper {\r\n    display: flex;\r\n    gap: 15px;\r\n}\r\n\r\nbutton.teasorBtn.text.btn_large {\r\n    margin-left: 57px;\r\n}\r\n\r\nbutton.co_ab_button-choose {\r\n    font-size: 18px;\r\n    line-height: 22px;\r\n    white-space: nowrap;\r\n    flex-shrink: 0;\r\n    cursor: pointer;\r\n    font-weight: bold;\r\n    border: 1px solid #ffffff;\r\n    transition: 0.2s linear;\r\n    position: relative;\r\n    z-index: 1;\r\n    overflow: hidden;\r\n    display: inline-flex;\r\n    -webkit-box-align: center;\r\n    align-items: center;\r\n    -webkit-box-pack: center;\r\n    justify-content: center;\r\n    border-radius: 0.5rem;\r\n    width: auto;\r\n    height: 54px;\r\n    background: white;\r\n    color: black;\r\n    padding: 0px 1.2rem;\r\n}\r\n\r\nbutton.co_ab_button-choose:hover {\r\n    background-color: #f7f7f7;\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n    button.co_ab_button {\r\n        margin-left: 0;\r\n        \/*margin-right: auto;*\/\r\n    }\r\n\r\n    div[data-co-ab-changed=\"true\"] {\r\n        gap: 15px;\r\n    }\r\n\r\n    div[class^=\"styles__StyledHeadingWrapper\"] {\r\n        margin-bottom: 0;\r\n    }\r\n\r\n    button.co_ab_button-choose {\r\n        width: 100%;\r\n    }\r\n}","baseline":false,"traffic_allocation":100,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"const config={'svgCodeLoggedOut':'<svg width=\"1em\" height=\"1em\" aria-hidden=\"true\" viewBox=\"0 0 24 24\" color=\"currentColor\" class=\"co_ab_man-icon\" id=\"co_ab_man-icon_logged-out\"><path d=\"M8.9 16.5l3.1 3.1 3.1-3.1h2.25c2.35 0 4.3 1.65 4.7 3.95l.2 1.05H1.8l.15-1.05c.4-2.3 2.35-3.95 4.7-3.95H8.9zM12 2c3.5 0 6 2.5 6 6 0 3.4-2.4 7-6 7s-6-3.6-6-7c0-3.5 2.5-6 6-6zm0 1.5C9.4 3.5 7.5 5.4 7.5 8c0 2.65 1.8 5.5 4.5 5.5s4.5-2.85 4.5-5.5c0-2.6-1.9-4.5-4.5-4.5z\"><\/path><\/svg>','svgCodeLoggedIn':'<div class=\"co_ab_icon-wrapper\"><svg width=\"1em\" height=\"1em\" aria-hidden=\"true\" viewBox=\"0 0 24 24\" color=\"currentColor\" class=\"co_ab_man-icon\" id=\"co_ab_man-icon_logged-in\"><path d=\"M8.9 16.5l3.1 3.1 3.1-3.1h2.25c2.35 0 4.3 1.65 4.7 3.95l.2 1.05H1.8l.15-1.05c.4-2.3 2.35-3.95 4.7-3.95H8.9zM12 2c3.5 0 6 2.5 6 6 0 3.4-2.4 7-6 7s-6-3.6-6-7c0-3.5 2.5-6 6-6zm0 1.5C9.4 3.5 7.5 5.4 7.5 8c0 2.65 1.8 5.5 4.5 5.5s4.5-2.85 4.5-5.5c0-2.6-1.9-4.5-4.5-4.5z\"><\/path><\/svg><i class=\"co_ab_icon-general dt_icon confirmIcon\" id=\"svg_wrapper_undefined\"><svg width=\"1em\" height=\"1em\" aria-hidden=\"true\" viewBox=\"0 0 64 64\" color=\"currentColor\" class=\"co_ab_icon-check\" id=\"co_ab_iconCheck\"><path d=\"M23 51.72a4 4 0 0 1-2.75-1.1L6.77 37.81a4 4 0 0 1 5.5-5.81L23 42.14l28.65-28.69a4.002 4.002 0 0 1 5.66 5.66L25.88 50.55A4 4 0 0 1 23 51.72z\"><\/path><\/svg><\/i><\/div>','additionalTextLoggedIn':'Unter \"Auswahl \u00e4ndern\" k\u00f6nnen Sie ihren Tarif \u00e4ndern, Ihren Umzug beauftragen oder Optionen dazubuchen','replaceColor':'#F5E194','replaceText':'meinen Tarif anpassen oder einen Umzug beauftragen.'}\nablyftTools.waitForElement('html.hydrated',function(html){var observeDOM=function(){var e=window.MutationObserver||window.WebKitMutationObserver,t=window.addEventListener;return function(d,n){e?new e(function(e,t){(e[0].addedNodes.length||e[0].removedNodes.length)&&n()}).observe(d,{childList:!0,subtree:!0}):t&&(d.addEventListener('DOMNodeInserted',n,!1),d.addEventListener('DOMNodeRemoved',n,!1),d.addEventListener('DOMSubtreeModified',n,!1))}}();var loginArea=document.querySelector('div[class*=\"styles__StyledTeaserBoxWrapper-sc-\"]');var loginInfo=document.querySelector('div[class*=\"styles__StyledLoginTeaserPanelWrapper-sc-\"]');observeDOM(html,function(){setTimeout(()=>{if(loginArea&&loginArea.dataset.coAbChanged!==\"true\"){updateLoginArea(loginArea);}else if(loginInfo&&loginInfo.dataset.coAbChanged!==\"true\"){updateLoginInfo(loginInfo);}},500);});});function trackClick(linkId){utag.link({'wt_link_id':linkId});}\nfunction updateLoginArea(loginArea){var buttonIconWrapper=loginArea.querySelector('div[class^=\"styles__StyledTeaserIconWrapper-sc\"]');var buttonLogin=loginArea.querySelector('button.dt_button.teaserBoxBtn.secondary.btn_large');var headingWrapper=loginArea.querySelector('div[class^=\"styles__StyledHeadingWrapper-sc\"]');var subHeading=loginArea.querySelector('.variant_small.teaserBox_subHeading');if(!buttonIconWrapper||!buttonLogin||!headingWrapper||!subHeading)return;var leftWrapper=document.createElement(\"div\");leftWrapper.className=\"co_ab_left-wrapper\";leftWrapper.insertAdjacentHTML(\"afterbegin\",config.svgCodeLoggedOut);leftWrapper.insertAdjacentElement(\"beforeend\",headingWrapper);loginArea.style.backgroundColor=config.replaceColor;buttonIconWrapper.remove();buttonLogin.classList.add(\"co_ab_button\");loginArea.insertAdjacentElement(\"afterbegin\",leftWrapper);loginArea.dataset.coAbChanged=\"true\";subHeading.innerText=config.replaceText;buttonLogin.addEventListener(\"click\",function(){trackClick('content.button.anmelden');});}\nfunction updateLoginInfo(loginInfo){var buttonLoginWrapper=loginInfo.querySelector('div.btnWrapper');var infoTextWrapper=loginInfo.querySelector('div[class^=\"styles__StyledContentWrapper-sc-\"]:not(.btnWrapper)');var subSectionHeading=loginInfo.querySelector('div.subSectionHeading');var chooseButton=loginInfo.querySelector('button.teasorBtn');if(!buttonLoginWrapper||!infoTextWrapper||!subSectionHeading||!chooseButton)return;var chooseButtonIcon=chooseButton.querySelector(\"i\");if(!chooseButtonIcon)return;chooseButtonIcon.remove();chooseButton.className=\"co_ab_button-choose\";var leftWrapper=document.createElement(\"div\");leftWrapper.className=\"co_ab_left-wrapper\";leftWrapper.insertAdjacentHTML(\"afterbegin\",config.svgCodeLoggedIn);leftWrapper.insertAdjacentElement(\"beforeend\",infoTextWrapper);var additionalTextWrapper=document.createElement(\"div\");additionalTextWrapper.className=\"co_ab_additional-text-logged-in\";additionalTextWrapper.innerText=config.additionalTextLoggedIn;infoTextWrapper.insertAdjacentElement(\"beforeend\",additionalTextWrapper);loginInfo.style.backgroundColor=config.replaceColor;buttonLoginWrapper.classList.add(\"co_ab_button\");loginInfo.insertAdjacentElement(\"afterbegin\",leftWrapper);loginInfo.dataset.coAbChanged=\"true\";subSectionHeading.innerText=subSectionHeading.innerText.replace(\"\u200e\",\"\");chooseButton.addEventListener(\"click\",function(){trackClick('content.button.auswahl-aendern');});}","reset_js":"","css":".co_ab_man-icon {\r\n    width: 44px;\r\n    height: auto;\r\n}\r\n\r\nbutton.co_ab_button {\r\n    margin-left: auto;\r\n    background: #ffffff;\r\n    color: #000000;\r\n    border-color: #ffffff;\r\n}\r\n\r\nbutton.co_ab_button:hover {\r\n    background-color: #f7f7f7;\r\n  \tborder-color: #ffffff;\r\n  \tcolor: #000000;\r\n}\r\n\r\n.co_ab_icon-wrapper {\r\n    position: relative;\r\n}\r\n\r\ni.co_ab_icon-general {\r\n    position: absolute;\r\n    font-size: 0.4em;\r\n    height: 17px;\r\n    width: 17px;\r\n    border-radius: 50%;\r\n    background: rgb(107, 179, 36);\r\n    -webkit-box-align: center;\r\n    align-items: center;\r\n    -webkit-box-pack: center;\r\n    justify-content: center;\r\n    stroke: currentcolor;\r\n    right: 7px;\r\n    top: 2px;\r\n    transform: translate(3px, -2px);\r\n    box-shadow: #F9E188 0px 0px 0px 1px;\r\n    color: rgb(255, 255, 255) !important;\r\n}\r\n\r\n.co_ab_icon-check {\r\n    fill: currentColor;\r\n    height: 14px;\r\n    width: 13px;\r\n    top: 1px;\r\n    right: 2px;\r\n    position: absolute;\r\n}\r\n\r\n.co_ab_left-wrapper {\r\n    display: flex;\r\n    gap: 15px;\r\n}\r\n\r\nbutton.teasorBtn.text.btn_large {\r\n    margin-left: 57px;\r\n}\r\n\r\nbutton.co_ab_button-choose {\r\n    font-size: 18px;\r\n    line-height: 22px;\r\n    white-space: nowrap;\r\n    flex-shrink: 0;\r\n    cursor: pointer;\r\n    font-weight: bold;\r\n    border: 1px solid #ffffff;\r\n    transition: 0.2s linear;\r\n    position: relative;\r\n    z-index: 1;\r\n    overflow: hidden;\r\n    display: inline-flex;\r\n    -webkit-box-align: center;\r\n    align-items: center;\r\n    -webkit-box-pack: center;\r\n    justify-content: center;\r\n    border-radius: 0.5rem;\r\n    width: auto;\r\n    height: 54px;\r\n    background: white;\r\n    color: black;\r\n    padding: 0px 1.2rem;\r\n}\r\n\r\nbutton.co_ab_button-choose:hover {\r\n    background-color: #f7f7f7;\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n    button.co_ab_button {\r\n        margin-left: 0;\r\n        \/*margin-right: auto;*\/\r\n    }\r\n\r\n    div[data-co-ab-changed=\"true\"] {\r\n        gap: 15px;\r\n    }\r\n\r\n    div[class^=\"styles__StyledHeadingWrapper\"] {\r\n        margin-bottom: 0;\r\n    }\r\n\r\n    button.co_ab_button-choose {\r\n        width: 100%;\r\n    }\r\n}","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":73502940,"status":"running","name":"FN_TV_2025-05_Reihenfolge der Tariftabellen tauschen","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-05-28 11:08:37","updated_at":"2025-06-18 11:22:20","published_at":"2025-06-18 11:22:20","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":24816271,"name":"Original","css_code":"","baseline":true,"traffic_allocation":0,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":27007600,"name":"Variation #1","css_code":"div#left-section-container-id div[class^=\"styles__StyledTariffSelectionWrapper\"] {\r\n    display: flex;\r\n    flex-direction: column-reverse;\r\n}","baseline":false,"traffic_allocation":100,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"console.warn('running test...');","reset_js":"","css":"div#left-section-container-id div[class^=\"styles__StyledTariffSelectionWrapper\"] {\r\n    display: flex;\r\n    flex-direction: column-reverse;\r\n}","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":83257922,"status":"running","name":"MF_EG_2025-06_Smartphone Filter umtauschen_Google-Samsung","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-06-03 19:47:46","updated_at":"2025-08-28 21:27:43","published_at":"2025-08-06 08:17:36","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":42116335,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":42564079,"name":"Variation #1","css_code":"","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"function reorderButtons(){var buttons=document.querySelectorAll('div[class^=\"style__StyledFilterChips-sc-\"]');if(buttons.length>=6){buttons[0].style.order=1;buttons[1].style.order=2;buttons[2].style.order=4;buttons[3].style.order=3;buttons[4].style.order=5;buttons[5].style.order=6;}}\nvar observeDOM=function(){var e=window.MutationObserver||window.WebKitMutationObserver,t=window.addEventListener;return function(d,n){e?new e(function(e,t){(e[0].addedNodes.length||e[0].removedNodes.length)&&n()}).observe(d,{childList:!0,subtree:!0}):t&&(d.addEventListener('DOMNodeInserted',n,!1),d.addEventListener('DOMNodeRemoved',n,!1),d.addEventListener('DOMSubtreeModified',n,!1))}}();ablyftTools.waitForElement('html.hydrated',function(html){reorderButtons();observeDOM(html,reorderButtons);});","reset_js":"","css":"","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":84014933,"status":"running","name":"GF_2025-08_Overlay Preiskommunikation - Positive vs Negative","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-07-30 09:45:18","updated_at":"2025-08-28 21:22:10","published_at":"2025-08-07 12:06:31","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":90144555,"name":"All Visitors","rules_js":"return true;"}],"variations":[{"id":26685103,"name":"Original","css_code":"","baseline":true,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"if(typeof utag!==\"undefined\"){utag.link({'wt_link_id':'content.abtest.load','link_abtest_variant':'gf_2025-08_overlay preiskommunikation positive vs negative '+':'+'original'});}","reset_js":"","css":"","changesets":"[]"},{"id":32071839,"name":"Variation #1","css_code":"","baseline":false,"traffic_allocation":50,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"window.testvar=true;window.ablyft_variant='varianteC';if(typeof utag!==\"undefined\"){utag.link({'wt_link_id':'content.abtest.load','link_abtest_variant':'gf_2025-08_overlay preiskommunikation positive vs negative '+':'+'variation 1'});}","reset_js":"","css":"","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]},{"id":97329481,"status":"running","name":"FN_Startseite_Retargeting Angebot","traffic_allocation":100,"audiences_match_type":"all","created_at":"2025-09-07 09:20:51","updated_at":"2025-09-24 09:37:22","published_at":"2025-09-24 09:37:22","metadata_1":"","metadata_2":null,"metadata_3":null,"integrations_run_mode":null,"js":"","reset_js":"","css":"","audiences":[{"id":53574493,"name":"Fixed Retargeting","rules_js":"if(ablyft.getTools().getCookie('home_fr') !== null &&  ablyft.getTools().getCookie('home_fr') === '1'){\r\n   return true;\r\n}"}],"variations":[{"id":17380478,"name":"Original","css_code":"","baseline":true,"traffic_allocation":0,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"","reset_js":"","css":"","changesets":"[]"},{"id":76802426,"name":"Variation #1","css_code":"","baseline":false,"traffic_allocation":100,"metadata_1":null,"metadata_2":null,"metadata_3":null,"js":"defer(function(){window.reactPersonalize(\"internet:breitband\")},1);function defer(method,i){if(window.reactPersonalize&&window.utag){method();}else{if(i<100){setTimeout(function(){defer(method,i+1)},20);}}}","reset_js":"","css":"","changesets":"[]"}],"environments":[{"id":33791736,"name":"Default","rules_js":"return true;"}]}],"goals":[{"id":18333284,"type":"custom","counting_method":"every","css_selector":null,"name":"Festnetz_OneShop_Anschlussdaten","api_name":"festnetz_oneshop_anschlussdaten"},{"id":18486276,"type":"custom","counting_method":"every","css_selector":null,"name":"Mobilfunk_OneShop_Registrierung","api_name":"mobilfunk_oneshop_registrierung"},{"id":21530099,"type":"pageview","counting_method":"every","css_selector":null,"name":"Mobilfunk_Oneshop_EG-katalog","api_name":null},{"id":24210448,"type":"custom","counting_method":"every","css_selector":null,"name":"Kauf_Magentamobil mit Endger\u00e4t_NG","api_name":"kauf_magentamobil_mit_endgeraet_ng"},{"id":27738512,"type":"custom","counting_method":"every","css_selector":null,"name":"Add_Tripleplay","api_name":"add_tripleplay"},{"id":28670437,"type":"pageview","counting_method":"one","css_selector":null,"name":"OneShop_Bestellbestaetigung_Conf_Unique","api_name":null},{"id":32016812,"type":"custom","counting_method":"every","css_selector":null,"name":"Kauf_Magentamobil_NG","api_name":"kauf_magentamobil_ng"},{"id":33582157,"type":"pageview","counting_method":"every","css_selector":null,"name":"OneShop_Bestellbestaetigung","api_name":null},{"id":35254191,"type":"custom","counting_method":"one","css_selector":null,"name":"Kauf_Magentamobil_NG_Unique","api_name":"kauf_magentamobil_ng_unique"},{"id":41060000,"type":"custom","counting_method":"every","css_selector":null,"name":"Mobilfunk_OneShop_Pers. Daten","api_name":"mobilfunk_oneshop_pers-daten"},{"id":45508787,"type":"revenue","counting_method":"every","css_selector":null,"name":"Revenue","api_name":"revenue"},{"id":47497887,"type":"custom","counting_method":"every","css_selector":null,"name":"Kauf_Tripleplay_NG","api_name":"kauf_tripleplay_ng"},{"id":47719722,"type":"custom","counting_method":"every","css_selector":null,"name":"Add_Revenue","api_name":"add_revenue"},{"id":47846135,"type":"custom","counting_method":"every","css_selector":null,"name":"Mobilfunk_OneShop_Bestellbestaetigung","api_name":"mobilfunk_oneshop_bestellbestaetigung"},{"id":53467692,"type":"custom","counting_method":"every","css_selector":null,"name":"Festnetz_OneShop_Bestellbestaetigung","api_name":"festnetz_oneshop_bestellbestaetigung"},{"id":56160325,"type":"custom","counting_method":"every","css_selector":null,"name":"Mobilfunk_OneShop_Identifizierung","api_name":"mobilfunk_oneshop_identifizierung"},{"id":58840710,"type":"custom","counting_method":"every","css_selector":null,"name":"Kauf_Magentamobil mit Endger\u00e4t_BK","api_name":"kauf_magentamobil_mit_endgeraet_bk"},{"id":68255857,"type":"custom","counting_method":"every","css_selector":null,"name":"Kauf_Tripleplay_BK","api_name":"kauf_tripleplay_bk"},{"id":71435459,"type":"custom","counting_method":"every","css_selector":null,"name":"Kauf_Magentamobil_BK","api_name":"kauf_magentamobil_bk"},{"id":75801548,"type":"pageview","counting_method":"every","css_selector":null,"name":"OneShop_Bestellbestaetigung_Conf","api_name":null},{"id":80935904,"type":"pageview","counting_method":"one","css_selector":null,"name":"OneShop_Bestellbestaetigung_Unique","api_name":null},{"id":82068431,"type":"custom","counting_method":"one","css_selector":null,"name":"Revenue_Unique","api_name":"revenue_unique"},{"id":88743494,"type":"custom","counting_method":"one","css_selector":null,"name":"Festnetz_OneShop_Pers. Daten","api_name":"festnetz_oneshop_pers-daten"},{"id":93083894,"type":"custom","counting_method":"every","css_selector":null,"name":"Festnetz_OneShop_Registrierung","api_name":"festnetz_oneshop_registrierung"},{"id":94320531,"type":"custom","counting_method":"every","css_selector":null,"name":"Mobilfunk_OneShop_Zusammenfassung","api_name":"mobilfunk_oneshop_zusammenfassung"},{"id":97012006,"type":"custom","counting_method":"every","css_selector":null,"name":"Mobilfunk_OneShop_Warenkorb","api_name":"mobilfunk_oneshop_warenkorb"},{"id":97637429,"type":"pageview","counting_method":"every","css_selector":null,"name":"Mobilfunk_Smartphonetarife","api_name":null},{"id":99841246,"type":"custom","counting_method":"one","css_selector":null,"name":"Kauf_Magentamobil mit Endger\u00e4t_NG_Unique","api_name":"kauf_magentamobil_mit_endgeraet_ng_unique"}],"exclusion_groups":[{"id":32031678,"name":"Startseite Tests","exclusion_group_entries":[{"experiment_id":97329481,"traffic":100}]},{"id":32927028,"name":"Fixed","exclusion_group_entries":[{"experiment_id":58020392,"traffic":50},{"experiment_id":77954439,"traffic":50}]},{"id":73935450,"name":"BK Tests","exclusion_group_entries":[{"experiment_id":83481913,"traffic":50},{"experiment_id":58020392,"traffic":50}]},{"id":86383302,"name":"Glasfaser","exclusion_group_entries":[{"experiment_id":84014933,"traffic":50},{"experiment_id":43220353,"traffic":50}]},{"id":88965442,"name":"Mobilfunk Tests","exclusion_group_entries":[{"experiment_id":83257922,"traffic":50},{"experiment_id":40901879,"traffic":50}]}],"default_integrations":[],"custom_integrations":[{"id":54365539,"name":"Tealium","used_hook":"experimentViewed","run_synchronously":true,"js":"\/\/set page scope variables\r\nvar test_case_identifier = (experiment.data.name + \":\" + variation.data.name).toLowerCase().replace(\/[&\u00a7\\\/\\\\\u00e4\u00f6\u00fc\u00df@\u00b0^\u00b2\u00b3#,+()$~%'\"*?!<>{}]\/g,'');\r\nwindow.page_test_case = \"undefined\" !== typeof window.page_test_case && \"\" !== window.page_test_case ? window.page_test_case + \";\" + test_case_identifier : test_case_identifier;"}]};




var geoLocationFn = function(){};

window.ablyftEditorExtensions = projectData.usedEditorExtensions;
(function(w,d,c){if(w.ablyftAlreadyRunning)return c.warn("ABlyft aborting - first snippet already initialized"),!1;function inIframe(){try{return w.self!==w.top}catch{return 1}}if(w.ablyftAlreadyRunning=!0,inIframe()&&!w.ablyftAllowIframe&&!sessionStorage.getItem("ablyft_editor_token")&&!w.ablyftEditorMode&&!projectData.allow_in_iframes)return c.log("ABlyft aborting - running in Iframe"),!1;if("undefined"!=typeof $ablyft){let $=$ablyft}let Script={version:3.56,projectId:projectData.id,revision:projectData.snippet_revision,logDomain:projectData.tracker_url,storage:projectData.storage,goalsEnabled:!0,isPreview:!1,previewCombinations:[],previewExcludeRunning:!0,optedOut:!1,doNotTrackUser:!1,liveEventListenersSet:!1,formerlyPushedGoals:[],mutationObservers:[],intersectionObservers:[],pollIntervals:[],activePages:[],activeExperiments:{},isReinitialized:!1,eventHandlers:{},init(e){this.projectData=e,this.handleDebugMode(),this.handleVisualEditor(),this.handlePreview(),this.handleQaTool(),this.handleSetBucketing(),this.handleOptOut(),this.handleDoNotTrack(),this.handleInstanceCheck(),this.dataToExpose=Tools.pickProperties(Script,["projectId","version","revision","goalsEnabled","isPreview","optedOut","trackerUrl"]),System.logEnabled&&(c.groupCollapsed("%cABlyft # Initiated SNIPPET with Revision","background-color: #002349; border: 2px solid #002349; color: white;",this.revision),Object.keys(this.dataToExpose).forEach(e=>{c.log(e,this.dataToExpose[e])}),c.log("storage",Storage.getStorage()),c.groupEnd())},isNotABot(){var e=/bot|google|crawler|spider|robot|crawling|facebookexternalhit/i.test(navigator.userAgent);return e&&System.log("info",0,"Rated as Bot- Exiting"),!e},generalPrerequisitesMet(e){var t=this.projectData.rules;return!t||(t=System.jsConditionReturnsTrue(t),e||System.log("info",0,"General Prerequisite Rules "+(t?"met":"NOT met")),t)},trackingPrerequisitesMet(e){var t=this.projectData.rules_tracking;return!t||(t=System.jsConditionReturnsTrue(t),e||System.log("info",0,"Tracking Prerequisite Rules "+(t?"met":"NOT met")),t)},resetMutationObservers(){this.mutationObservers.forEach(e=>e.disconnect()),this.mutationObservers=[]},resetIntersectionObservers(){this.intersectionObservers.forEach(e=>e.disconnect()),this.intersectionObservers=[]},resetPollingIntervals(){this.pollIntervals.forEach(e=>clearInterval(e)),this.pollIntervals=[]},run(){if(this.isVisualEditorMode())return System.log("info",0,"Visual Editor Mode activated"),!1;if(User.init(),this.resetMutationObservers(),this.resetIntersectionObservers(),this.resetPollingIntervals(),Project.runHelperJs(),this.generalPrerequisitesMet()&&this.isNotABot()&&!this.optedOut&&!this.doNotTrackUser){if(this.trackingPrerequisitesMet()&&this.handleTempEvents(),w.insideShopifyPixel)return System.log("info",0,"Inside Shopify Checkout Pixel"),!1;this.applyAntiFlicker(),this.main(),this.removeAntiFlicker(),this.invokeHandler("lifecycleEnd")}},handleTempEvents(){var e=System.storagePrefix+"temp_events",t=JSON.parse(sessionStorage.getItem(e)||"[]");0!==t.length&&(System.log("info",1,"Previously saved events are sent",t),t.forEach(e=>EventQueue.add(e)),sessionStorage.removeItem(e))},isVisualEditorMode(){var e;return!!w.visualEditorDebug||(e="ablyft_editor_token",!!sessionStorage.getItem(e))||new URLSearchParams(w.location.search).has(e)},handleVisualEditor(){if(this.isVisualEditorMode()){let e=w.visualEditorDebug?"local.":"";Tools.waitForElement("body",()=>Tools.loadExternalJs(`https://${e}editor.ablyft.com/snippet.js`))}},handleDebugMode(){var{debug:e,restrict_debug:t}=this.projectData;if(e){if(t){e=System.storagePrefix+"show_debug",t=System.urlParamPrefix+"show_debug";if("true"===Tools.getUrlParameter(t)&&Storage.set("sessionStorage",e,"true",!0),"true"!==Storage.get("sessionStorage",e,!0))return}System.enableLog()}},handlePreview(){var e=System.storagePrefix+"exclude_running",t=Tools.getUrlParameter(System.urlParamPrefix+"exclude_running"),t=("true"!==t&&"false"!==t||Storage.set("sessionStorage",e,t,!0),Storage.get("sessionStorage",e,!0)),e=(t&&(this.previewExcludeRunning="true"===t),System.storagePrefix+"preview_combs"),t=Tools.getUrlParameter(System.urlParamPrefix+"preview"),t=(t&&(t=JSON.stringify(t.split(",")),Storage.set("sessionStorage",e,t,!0)),Storage.get("sessionStorage",e,!0));t&&(this.previewCombinations=JSON.parse(t),this.setPreviewMode())},handleQaTool(){var e=System.storagePrefix+"qa_token",t=System.urlParamPrefix+"qa_token",t=Tools.getUrlParameter(t),t=(t&&Storage.set("sessionStorage",e,t,!0),Storage.get("sessionStorage",e,!0));t&&this.setQaMode(t)},handleSetBucketing(){var t=System.urlParamPrefix+"set_bucketing",r=System.storagePrefix+"exps",i=Tools.getUrlParameter(t);if(i){let e;try{e=JSON.parse(i)}catch{return void System.log("error",0,`Invalid JSON in ${t}:`,i)}Array.isArray(e)&&0!==e.length&&(i=(t=Storage.get("cookie",r))?JSON.parse(t):{},t=e.reduce((e,t)=>{var[t,r]=t.split("_");return e[t]=Number(r),e},{}),i={...i,...t},Tools.domLoaded(()=>{setTimeout(()=>{e.forEach(e=>{var[e,t]=e.split("_"),e=new Experiment(Script.getExperimentById(e),!0),t=new Variation(Number(t),!0);Project.runIntegrations(e,t,!0)})},500)}),Storage.set("cookie",r,JSON.stringify(i)))}},setPreviewMode(){this.isPreview=!0,this.goalsEnabled=!1},setQaMode(e){let t="https://app.ablyft.com/qa-tool/",r=this.projectData.id;Tools.domLoaded(function(){Tools.loadExternalJs(t+"js/"+r+"/"+e),Tools.loadExternalCss(t+"css/"+r+"/"+e)})},getVariationIdToPreviewByExperiment(e,t=!1){let r=e.data.id;var e=(this.previewCombinations||[]).find(e=>{var[e]=e.split("_");return Number(e)===r});return!!e&&([,e]=e.split("_"),e=Number(e),!!Number.isInteger(e))&&(t||System.log("info",1,"Starting Preview Mode",e),e)},handleOptOut(){var e=System.storagePrefix+"opt_out",t=Tools.getUrlParameter(System.urlParamPrefix+"opt_out");"true"!==t&&"false"!==t||((t="true"===t)?Storage.set("cookie",e,"true"):Storage.remove("cookie",e),alert(`Opted ${t?"out":"in"} of ABlyft for this domain`)),this.optedOut="true"===Storage.get("cookie",e)},handleDoNotTrack(){this.projectData.adhere_dnt&&"1"===navigator.doNotTrack&&(c.log("ABlyft # stops because client's doNotTrack is enabled"),this.doNotTrackUser=!0)},handleInstanceCheck(){"true"===Tools.getUrlParameter(System.urlParamPrefix+"check")&&alert("ABlyft is implemented")},applyAntiFlicker(){this.projectData.use_antiflicker&&(d.documentElement.style.visibility="hidden",setTimeout(()=>this.removeAntiFlicker(),2e3))},removeAntiFlicker(){this.projectData.use_antiflicker&&(d.documentElement.style.visibility="visible")},invokeHandler(e){Script.eventHandlers.hasOwnProperty(e)&&Script.eventHandlers[e]()},getProjectData(){return this.projectData},prepareEvent(e,t){var{data:e,className:r}=e,{type:e,id:i,value:a}=e,e={type:e,value:void 0!==a?a:0};return"goal"===r&&(e.goal={id:i,variations:t}),e},getExperimentsVariationIds(){return(Project.data?.experiments??[]).flatMap(({variations:e=[]})=>e.map(({id:e})=>e))},getCleanedUserBucket(){var e=User.getExperimentsBucket()||{};let i=new Set(this.getExperimentsVariationIds());return Object.entries(e).reduce((e,[t,r])=>(0!==r&&i.has(r)&&(e[t]=r),e),{})},getCleanedUserBucketVariationIds(){return Object.values(this.getCleanedUserBucket()??{})},sendEvents:function(e,t){e={projectId:this.projectData.id,source:"ablyft-snippet",snippetVersion:this.version,user:e,events:t},t=JSON.stringify(e);navigator.sendBeacon(this.logDomain,t)},processEvents:function(e){var t=this.getCleanedUserBucket(),r=User.attributes;if(Object.keys(t).length){var i,a,s,r={experimentsBucket:t,attributes:r},o=e.filter(e=>"integration"!==e.type),n=e.filter(e=>"integration"===e.type);o.length&&(1===Object.keys(t).length&&(t=o.find(e=>"bucketing"===e.type))&&(t.isFirst=!0),this.sendEvents(r,o));for({data:{experimentId:i,variationId:a},integration:s}of n){var l=new Experiment(this.getExperimentById(i),!0),d=new Variation(a,!0);this.getIntegrationByTypeAndId(s.type,s.id)?.run(Project,l,d)}EventQueue.removeEventsFromQueue(e)}else c.log("ABlyft # Empty UserBucket, not sending"),EventQueue.clear()},getGoalByApiName(t){var{goals:e=[]}=this.projectData;return e.find(({api_name:e})=>e===t)||!1},getGoalById(t){t=Number(t);var{goals:e=[]}=this.projectData;return e.find(e=>e.id===t)||!1},getPageByApiName(t){var{pages:e=[]}=this.projectData;return e.find(({api_name:e})=>e===t)||!1},getPageById(t){t=Number(t);var{pages:e=[]}=this.projectData;return e.find(e=>e.id===t)||!1},getExperimentById(t){t=Number(t);var{experiments:e=[]}=this.projectData;return e.find(e=>e.id===t)||!1},getVariationById(t){t=Number(t);var e,{experiments:r=[]}=this.projectData;for({variations:e=[]}of r){var i=e.find(e=>Number(e.id)===t);if(i)return i}return!1},getIntegrationByTypeAndId(e,t){e=(this.projectData?.[e+"_integrations"]||[]).find(e=>e.id===t);return!!e&&new Integration(e)},carriesExperiment(e){let t=+e;return!Number.isNaN(t)&&(this.projectData?.experiments??[]).some(e=>e.id===t)},getActiveClickGoals(){return(Script.activePages||[]).map(e=>this.getPageById(e)).filter(e=>e&&Array.isArray(e.goals)).flatMap(e=>e.goals.map(e=>this.getGoalById(Number(e))).filter(e=>e&&"click"===e.type))}},Storage={getStorage(e,t=!1){return t||"default"===Script.storage?e:Script.storage},encode(e){return Script.projectData.encode_storage_values?encodeURIComponent(e):e},decode(e){var t;return Script.projectData.encode_storage_values?"null"===(t=decodeURIComponent(String(e)))?null:t:e},useTempStorage(e){return"ablyft_tracking_consent"!==e&&"ablyft_redirect"!==e&&!Script.trackingPrerequisitesMet(!0)},set(e,t,r,i=!1,a){e=this.getStorage(e,i);if(this.useTempStorage(t))(i=window.ablyftTempStorage||={})[e]={...i[e]||{},[t]:r};else switch(e){case"cookie":Tools.setCookie(t,this.encode(r),a);break;case"localStorage":localStorage.setItem(t,r);break;default:sessionStorage.setItem(t,r)}},get(e,t,r=!1){e=this.getStorage(e,r);if(this.useTempStorage(t))return(w.ablyftTempStorage?.[e])?.[t]??!1;switch(e){case"cookie":return this.decode(Tools.getCookie(t));case"localStorage":return localStorage.getItem(t);default:return sessionStorage.getItem(t)}},remove(e,t,r=!1){switch(this.getStorage(e,r)){case"cookie":Tools.removeCookie(t);break;case"localStorage":localStorage.removeItem(t);break;case"temp":delete w[t];break;default:sessionStorage.removeItem(t)}}},ablyft=w.ablyft,formerPushedCalls=[],Api=(void 0!==ablyft&&ablyft.length&&(formerPushedCalls=ablyft),{init(){this.initEventsApi(),"function"==typeof w.CustomEvent&&d.dispatchEvent(new CustomEvent("ablyftApiReady"))},initEventsApi(){w.ablyft={push:function(e){var t,r,i;"custom"===e.eventType||"revenue"===e.eventType?(i=Script.getGoalByApiName(e.eventName))&&new Goal(i).trigger(e.eventValue??0):"forceVariation"===e.eventType?System.forcedVariations[e.experimentId]=e.variationId:"activatePage"===e.eventType?({pageId:i,pageApiName:t}=e,(r=null!=i?Script.getPageById(i):Script.getPageByApiName(t))?new Page(r).run():(r=null!=i?"#"+i:t,System.log("error",0,["API (activatePage)",`Page (${r}) is not available`]))):"deactivatePage"===e.eventType?({pageId:i,pageApiName:t}=e,(r=null!=i?Script.getPageById(i):Script.getPageByApiName(t))?new Page(r).setInactive():(r=null!=i?"#"+i:t,System.log("error",0,["API (deactivatePage)",`Page (${r}) is not available`]))):"addListener"===e.eventType?"lifecycleEnd"===e.listener.type&&(Script.eventHandlers.lifecycleEnd=e.listener.handler):"enableTrackingConsent"===e.eventType?(i=System.storagePrefix+"tracking_consent",t=Storage.get("cookie",i),Storage.set("cookie",i,"1"),System.log("info",0,["enableTrackingConsent"]),(r=w.ablyftTempStorage)&&Object.entries(r).forEach(([r,e])=>{Object.entries(e).forEach(([e,t])=>{Storage.set(r,e,t)})}),"1"!==t&&w.ablyft.reInit({resetStates:!0})):"disableTrackingConsent"===e.eventType&&(i=System.storagePrefix+"tracking_consent",Storage.set("cookie",i,"0"),System.log("info",0,["disableTrackingConsent"]))},get(e,t){if("tools"===e)return Tools;if("data"===e)return Script.dataToExpose;if("activePageIds"===e)return Script.activePages;if("activeExperimentIds"===e)return Script.activeExperiments;if("pingedGoals"===e){let e=[];var r=Storage.get("sessionStorage","ablyft_pinged_goals",!0);return e=r?JSON.parse(r):e}return"pages"===e?Script.projectData.pages:"experiments"===e?Script.projectData.experiments:"goals"===e?Script.projectData.goals:"variationById"===e&&t?Script.getVariationById(t):"goalById"===e&&t?Script.getGoalById(t):"trackingConsentEnabled"===e?"0"!==(r=Storage.get("cookie",System.storagePrefix+"tracking_consent"))&&("1"===r||r):"deviceType"===e?User.attributes.device_type:"bucketing"===e?User.getExperimentsBucket():void c.error("ABlyft - Unknown API type",e)},getTools(){return Tools},reInit({resetStates:e=!1}={}){System.log("info",!1,"Re-Initiated PROJECT"),Script.isReinitialized=!0,e&&(Script.activePages=[],Script.activeExperiments=[],sessionStorage.removeItem("ablyft_pinged_goals")),Project.data?.is_spa&&(e=User.getExperimentsBucket(),Object.keys(e).forEach(e=>{new Experiment(Script.getExperimentById(e),!0).init()})),Script.run()}}},handleFormerlyPushedCalls(){(formerPushedCalls||[]).forEach(e=>{("forceVariation"===e.eventType?w.ablyft:Script.formerlyPushedGoals).push(e)})}}),System={urlParamPrefix:"ablyft_",storagePrefix:"ablyft_",logEnabled:!1,forcedVariations:{},init(){},enableLog(){this.logEnabled=!0},log(t,r=0,i,a=" "){if(this.logEnabled){var s,o="ABlyft #",r=!1===r?"":"----".repeat(Math.max(0,r));if("info"===t)c.log(`%c${o}%c${r} `+i,"background-color: #002349; border: 2px solid #002349; color: white;","color: #777;",a);else if("error"===t){let e;e=Array.isArray(i)?([t,s]=i,`ERROR on ${t&&t.data?t.className.toUpperCase()+" "+t.data.id:t}: `+s):String(i),d.dispatchEvent(new CustomEvent("ablyftError",{detail:{msg:e}})),c.error(o+r+e,a)}}},evalJs(js,extension=null){var ablyftTools=Tools;w.ablyftIgnoreDomMutations=!0,eval(js),w.ablyftIgnoreDomMutations=!1},applyJs(t,e=!1){var r=t?.data?.js;if(r&&r.length){e||System.log("info",2,"Applying JS");try{System.evalJs(r)}catch(e){System.log("error",2,[t,e.message])}}},applyPureJs(e){if(e&&e.length){System.log("info",2,"Applying JS");try{System.evalJs(e)}catch(e){System.log("error",2,[e.message])}}},applyResetJs(e){var{className:e,data:{reset_js:t,name:r,id:i}={}}=e;if(t&&t.length){System.log("info",2,`Applying RESET JS for ${e.toUpperCase()} "${r}"`,i);try{System.evalJs(t)}catch(e){System.log("error",0,[e.message])}}},applyCss(e){var t,r,i,a=e?.data?.css;a&&(System.log("info",2,"Applying CSS"),{className:e,data:{id:t,instance:r}}=e,(i=d.createElement("style")).type="text/css",i.className="ablyft-css",Object.assign(i.dataset,{ablyftCssType:e,ablyftCssTypeId:t,ablyftCssTypeInstance:r}),i.textContent=a,(document.head||document.getElementsByTagName("head")[0]).append(i))},applyResetCss(e){var{className:e,data:{id:t,instance:r}}=e,e=["style.ablyft-css",`[data-ablyft-css-type="${e}"]`,`[data-ablyft-css-type-id="${t}"]`,null!=r&&`[data-ablyft-css-type-instance="${r}"]`].filter(Boolean).join("");d.querySelectorAll(e).forEach(e=>e.remove())},detachCss(){d.querySelectorAll(".ablyft-css").forEach(e=>e.remove())},jsConditionReturnsTrue(e){if(!e||"null"===e||""===e)return!0;try{var t=Tools;return new Function("User","Tools","ablyftTools",e)(User,Tools,t)}catch(e){return System.log("error",2,["JS RULE",e.message]),!1}}},EventQueue=(System.init(),{storageKey:System.storagePrefix+"queue",init(){w.ablyftStopQueue=!1,Tools.domLoaded(()=>{clearInterval(w.ablyftEventQueueInterv),w.ablyftEventQueueInterv=setInterval(()=>this.process(),1e3)}),this.cleanup()},stop(){w.ablyftStopQueue=!0,clearInterval(w.ablyftEventQueueInterv)},add(e){var t,r;Script.trackingPrerequisitesMet(!0)?(e.timestamp=Math.floor(Date.now()/1e3),e.lockId=Tools.generateRandomId(),["bucketing","click","pageview","custom","revenue"].includes(e.type)?Script.processEvents([e]):this.addItemToJson(e)):(t=System.storagePrefix+"temp_events",(r=JSON.parse(sessionStorage.getItem(t)||"[]")).push(e),sessionStorage.setItem(t,JSON.stringify(r)))},get(){var e=Storage.get("cookie",this.storageKey);return e?JSON.parse(e):[]},clear(){this.updateStorage([])},process(){var e=this.get();if(0!==e.length){let t=Math.floor(Date.now()/1e3),r=[];e=e.map(e=>("object"==typeof e&&2<=(null!=e.locked?t-e.locked:1/0)&&(e.locked=t,r.push(e)),e));if(this.updateStorage(e),0!==r.length&&!window.ablyftStopQueue)return Script.processEvents(r),!0}},removeEventsFromQueue(e){let t=new Set(e.map(({lockId:e})=>e));e=this.get().filter(({lockId:e})=>!t.has(e));this.updateStorage(e)},doesItemExist(e,t){let{timestamp:r,type:i}=t;return!!Array.isArray(e)&&e.some(e=>{if(!e||"object"!=typeof e)return!1;if(e.timestamp!==r||e.type!==i)return!1;switch(i){case"bucketing":return e.value===t.value;case"integration":return e.integration?.id===t.integration?.id&&e.data?.variationId===t.data?.variationId;default:return e.goal?.id===t.goal?.id}})},addItemToJson(e){var t=this.get()||[];this.doesItemExist(t,e)||(t.push(e),this.updateStorage(t))},updateStorage(e){var t=this.storageKey;Array.isArray(e)&&0!==e.length?Storage.set("cookie",t,JSON.stringify(e),!1,1/86400*30):Storage.remove("cookie",t)},cleanup(){var e=this.get();if(0!==e.length){let t=Math.floor(Date.now()/1e3);e=e.filter(e=>"object"==typeof e&&t-e.timestamp<=3600);this.updateStorage(e)}}}),Tools={init(){},setCookie(e,t,r=projectData.max_cookie_lifetime,i=!1){r=new Date(Date.now()+24*r*60*60*1e3).toUTCString();let a=[encodeURIComponent(e)+"="+t,"Expires="+r,"SameSite=Lax","Path=/"].join("; ");e=this.getRootDomain();e&&"only_current"!==e&&!i&&(a+="; Domain="+e),d.cookie=a},getCookie(e){var t,r=encodeURIComponent(e)+"=";for(t of d.cookie.split("; "))if(t.startsWith(r))return t.slice(r.length);return null},removeCookie(e){var e=encodeURIComponent(e),t=`Expires=${new Date(0).toUTCString()}; SameSite=Lax; Path=/`,r=(d.cookie=e+"=; "+t,this.getRootDomain());r&&"only_current"!==r&&(d.cookie=e+`=; Domain=${r}; `+t)},parseUrl(e=window.location.href){var t=new Set(["co.uk","ac.uk","gov.uk","co.jp","com.au","co.nz"]);e.startsWith("http")||(e="http://"+e);let r;try{r=new URL(e,window.location.origin)}catch{(r=document.createElement("a")).href=e}var{protocol:e,host:i,hostname:a,port:s,pathname:o,search:n,hash:l}=r,d=a.split("."),c=d.slice(-2).join("."),t=2<d.length&&t.has(c);return{protocol:e,host:i,hostname:a,port:s,pathname:o,search:n,hash:l,domain:d[d.length-(t?3:2)],tld:t?c:d[d.length-1],subdomain:d.slice(0,d.length-(t?3:2)).join(".")||""}},getRootDomain(){var e,t;return projectData.cookie_domain||({domain:e,tld:t}=this.parseUrl(),`.${e}.`+t)},getUrlParameter(e,t=w.location.href){t=new URL(t,w.location.origin).searchParams;return t.has(e)?t.get(e):null},poll(e,t,r=()=>{},i=1e4,a=2e3){let s,o,n,l=!1,d=()=>{l||(l=!0,clearInterval(s),clearTimeout(o),clearTimeout(n))},c=()=>{d(),t()},p=()=>{d(),r()};if(!0===e())return c();s=setInterval(()=>{!0===e()&&c()},10),Script.pollIntervals.push(s),o=setTimeout(p,i),this.domLoaded(()=>{n=setTimeout(p,a)})},check(e,t,r=()=>{}){(!0===e()?t:r)()},buildRedirectUrl(e,t=!0){var r=(e="")=>e.split("&").filter(Boolean).map(e=>e.split("=").map(decodeURIComponent)).reduce((e,[t,r])=>(t&&(void 0===e[t]?e[t]=r:Array.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]),e),{}),{protocol:i,hostname:a,pathname:s,search:o,hash:n}=w.location;return e.startsWith("?")&&(e=i+"//"+a+s+e),t?(i=n||"",[a,s=""]=e.split("?"),[t="",n=""]=s.split("#"),s=n?"#"+n:i,n=r(o.slice(1)),i=r(t),o={...n,...i},""+a+(r=o,Object.keys(r).length?"?"+Object.entries(r).map(([e,t])=>e+"="+t).join("&"):"")+s):e},redirect(e,t=!0,r){var i=!1===r?0:Number.isInteger(r)?r:5;let a=this.buildRedirectUrl(e,t);if(!1!==r&&w.location.href===a)return!1;e=Storage.get("sessionStorage","ablyft_redirect"),t=Date.now();if(e&&(t-e)/1e3<i)return!1;Storage.set("sessionStorage","ablyft_redirect",t),EventQueue.stop(),d.documentElement.style.visibility="hidden",setTimeout(()=>{w.location.replace(a)},50)},shopifyPreviewTheme(e){Tools.poll(()=>{if(window.Shopify)return!0},()=>{Shopify.theme.id!==e&&(System.log("info",2,"Redirecting to Shopify Theme",e),Tools.redirect("?preview_theme_id="+e+"&pb=0"))},()=>{},1e3)},shopifySwitchTemplate(e){w.location.search.includes("view=")||(System.log("info",2,"Switching Shopify Template",e),Tools.redirect("?view="+e))},domLoaded(e){"complete"===d.readyState||"interactive"===d.readyState?e():d.addEventListener("DOMContentLoaded",e,{once:!0})},domChanged:function(t){this.waitForElement("body",function(e){new(w.MutationObserver||w.WebKitMutationObserver)(()=>{w.ablyftIgnoreDomMutations||t()}).observe(e,{childList:!0,subtree:!0,attributes:!0})})},waitForElement(e,t,r){let i=new WeakSet,a={selector:e,fn:t};function s(){d.querySelectorAll(a.selector).forEach(e=>{void 0!==e.dataset.ablyftHandled||i.has(e)||(i.add(e),a.fn.call(e,e,r))})}e=new(w.MutationObserver||w.WebKitMutationObserver)(s),Script.mutationObservers.push(e),e.observe(d.documentElement,{childList:!0,subtree:!0,attributes:!0}),s()},elementIsInView(e,r,i=!1){let a=new WeakSet,s=new IntersectionObserver(e=>{e.forEach(e=>{var t=e.target;e.isIntersecting&&!a.has(t)&&(r.call(t,t),a.add(t),i||s.unobserve(t))})});var t=()=>{d.querySelectorAll(e).forEach(e=>{a.has(e)||s.observe(e)})};this.domLoaded(t),this.domChanged(t),Script.intersectionObservers.push(s)},urlChanged(e,r){if("polling"===e){clearInterval(w.ablyftUrlChangeInterv);let t=w.location.href;w.ablyftUrlChangeInterv=setInterval(()=>{var e=w.location.href;e!==t&&(t=e,r())},10)}else"history"===e&&(["pushState","replaceState"].forEach(e=>{let t=w.history[e];w.history[e]=function(...e){e=t.apply(this,e);return r(),e}}),d.addEventListener("popstate",()=>r()))},getSetBucketingUrlExtension(){var e=User.getExperimentsBucket()||{},e=Object.entries(e);return 0===e.length?null:`[${e.map(([e,t])=>`"${e}_${t}"`).join(",")}]`},loadExternalCss(e){var t=d.createElement("link");t.media="all",t.rel="stylesheet",t.type="text/css",t.href=e,d.head.appendChild(t)},loadExternalJs(e,t){var r=d.createElement("script");r.src=e,r.onload=t,r.onreadystatechange=t,d.head.appendChild(r)},checkForDataLayerEntry(e,t){this.poll(()=>Array.isArray(w.dataLayer)&&w.dataLayer.some(r=>e.every(([e,t])=>r.hasOwnProperty(e)&&r[e]===t)),t,()=>{},36e5,36e5)},generateRandomId(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let r="";for(let e=0;e<10;e++)r+=t.charAt(Math.floor(Math.random()*t.length));return r},applyEditorExtension(e,t,r,i,a=Tools.generateRandomId()){var s=w.ablyftEditorExtensions[r];if(s){t=s.css_selector||t,i={...i,$id:r,$instance:a,$selector:t};i.$html=Mustache.render(s.html,{extension:i}),System.applyCss({className:"variation",data:{id:e,css:s.css,instance:a}});try{s.reset_js&&System.evalJs(s.reset_js,i),s.apply_js&&System.evalJs(s.apply_js,i)}catch(e){System.log("error",0,["Apply Editor Extension JS",e.message])}}else System.log("error",0,`Unknown editor extension "${r}"`);return a},resetEditorExtension(e,t,r){var i=w.ablyftEditorExtensions[t];if(!i)return System.log("error",0,`Unknown Editor Extension (Reset) "${t}"`),r;t={$id:t,$instance:r};System.applyResetCss({className:"variation",data:{id:e,css:i.css,instance:r}}),System.evalJs(i.reset_js,t)},pickProperties(r,e){return e.reduce((e,t)=>(t in r&&(e[t]=r[t]),e),{})}},User=(Tools.init(),{storageKeyExps:System.storagePrefix+"exps",geoLocation:!1,attributes:{device_type:"other",visitor_type:"new",url:""},init(){this.setVisits(),this.browser=this.getBrowser(),this.setGeoLocation(),this.setInitialAttributes()},getExperimentsBucket(){var e=Storage.get("cookie",this.storageKeyExps);return e?JSON.parse(e):{}},setExperimentToBucket(e,t){var r=this.getExperimentsBucket();Object.prototype.hasOwnProperty.call(r,e)||(r[e]=t,Storage.set("cookie",this.storageKeyExps,JSON.stringify(r)),0!==t&&(e={type:"bucketing",value:t},System.log("info",3,"Triggering BUCKETING Event",e),EventQueue.add(Script.prepareEvent({className:"bucketing",data:e},[]))))},setVisits(){if(Script.generalPrerequisitesMet(!0)){var t=System.storagePrefix,r=t+"session_check",t=t+"uvs",i=Storage.get("cookie",t);if(!i||!Script.isReinitialized){var a=Math.floor(Date.now()/1e3);let e;i?((e=JSON.parse(i)).last=a,Storage.get("sessionStorage",r,!0)?e.pageviewsSession++:(e.sessions++,e.pageviewsSession=1),e.pageviews++):e={first:a,last:a,sessions:1,pageviews:1,pageviewsSession:1},this.visits=e,Storage.set("cookie",t,JSON.stringify(e)),Storage.set("sessionStorage",r,"1",!0)}}},getVariationIdOfExperiment(e){let t=e;return"object"==typeof e&&(t=Number(e.data?.id)),!Number.isNaN(t)&&null!=(e=(this.getExperimentsBucket()||{})[t])&&(e=Number(e),!Number.isNaN(e))&&e},getBrowser(){var e=navigator.userAgent.toLowerCase(),t=navigator.platform||navigator.userAgentData?.platform,r=window.shopifyEventContext?.window??window,r=Math.min(r.innerWidth,r.outerWidth),i={mobile:!1,tablet:!1,desktop:!1,msedge:!1,opera:!1,samsungBrowser:!1,firefox:!1,chromium:!1,chrome:!1,msie:!1,safari:!1,version:null,windows:!1,mac:!1,android:!1,ios:!1,linux:!1,osversion:null};return i.mobile=navigator.userAgentData?.mobile||/mobile/i.test(e),i.tablet=/tablet|ipad/i.test(e)||600<r&&r<1024,i.desktop=!i.mobile&&!i.tablet,/edg\/(\d+\.\d+)/i.test(e)?(i.msedge=!0,i.version=RegExp.$1):/opr\/(\d+\.\d+)/i.test(e)||/opera\/(\d+\.\d+)/i.test(e)?(i.opera=!0,i.version=RegExp.$1):/samsungbrowser\/(\d+\.\d+)/i.test(e)?(i.samsungBrowser=!0,i.version=RegExp.$1):/firefox\/(\d+\.\d+)/i.test(e)?(i.firefox=!0,i.version=RegExp.$1):/chromium\/(\d+\.\d+)/i.test(e)?(i.chromium=!0,i.version=RegExp.$1):/chrome\/(\d+\.\d+)/i.test(e)?(i.chrome=!0,i.version=RegExp.$1):/msie (\d+\.\d+)/i.test(e)?(i.msie=!0,i.version=RegExp.$1):/safari\/(\d+\.\d+)/i.test(e)&&!/chrome|chromium/i.test(e)&&(i.safari=!0,r=e.match(/version\/(\d+\.\d+)/i))&&(i.version=r[1]),i.version=parseFloat(i.version),/windows/i.test(e)&&(i.windows=!0),/windows nt 10/i.test(e)&&(i.osversion=11),/windows nt 6.3/i.test(e)&&(i.osversion=8.1),/windows nt 6.2/i.test(e)&&(i.osversion=8),/windows nt 6.1/i.test(e)&&(i.osversion=7),/macintosh|mac os x/i.test(e)&&(i.mac=!0,r=e.match(/mac os x (\d+[\._]\d+[\._]?\d*)/))&&(i.osversion=r[1].replace(/_/g,".")),/android/i.test(e)&&(i.android=!0,r=e.match(/android (\d+(\.\d+)?)/))&&(i.osversion=r[1]),/iphone|ipad|ipod/i.test(e)&&(i.ios=!0,r=e.match(/OS (\d+[\._]\d+)/))&&(i.osversion=r[1].replace(/_/g,".")),/linux/i.test(t)&&(i.linux=!0),i.osversion=parseFloat(i.osversion),i},setGeoLocation:geoLocationFn,setInitialAttributes(){var e=window.navigator.userAgent,t=window.location.href,e=(this.attributes.user_agent=e,this.attributes.url=t,User.visits?.sessions??0),{mobile:t=!1,tablet:e=!1,desktop:r=!1}=(this.attributes.visitor_type=1<e?"returning":"new",this.browser);this.attributes.device_type=e?"tablet":t?"mobile":r?"desktop":"unknown"}}),Project={init(e){this.className="project",this.data=e,System.logEnabled&&c.groupCollapsed('%cABlyft # Initiated PROJECT "'+this.data.name+'"',"background-color: #002349; border: 2px solid #002349; color: white;",this.data.id),this.runCodes(),System.logEnabled&&c.groupEnd()},runCodes(){Project.data?.is_spa&&System.detachCss(),System.applyCss(this),System.applyJs(this)},runHelperJs(){System.applyPureJs(Script.getProjectData().helper_js)},runIntegrations(e,t,r=!1){var i=Project.data,a=e.data,s=t.data;if(!i||!a||!s)return!1;var o,n,{default_integrations:l=[],custom_integrations:d=[]}=Script.projectData||{};for([o,n]of Object.entries({default:l,custom:d}))for(var c of n){var p=new Integration(c),g={type:"integration",integration:{type:o,id:c.id},data:{projectId:i.id,experimentId:a.id,variationId:s.id}},u=a.integrations_run_mode,u=Boolean(c.run_synchronously)||"sync"===u;"userBucketed"===c.used_hook&&!r||(c=p,p=g,u?c.run(Project,e,t):EventQueue.add(p))}return!0}};function Experiment(e,t){this.className="experiment",this.data=e,this.silent=t,this.variationId=!1,this.metadata=this.getMetadata()}function Variation(e,t){this.className="variation",this.data=Script.getVariationById(e),this.metadata=this.getMetadata(),t||System.log("info",2,'Initiated VARIATION "'+this.data.name+'"',this.data.id)}function Environment(e){this.data=e}function Page(e){this.data=e}function Urltargeting(e){this.data=e}function Audience(e){this.data=e}Experiment.prototype.init=function(){var e=this.data;if(!e)return!1;let t=!1;var r=this.shouldNotRun();if(this.variationId=User.getVariationIdOfExperiment(this),0===this.variationId&&System.log("info",1,`EXPERIMENT "${e.name}" not running - User is excluded`,e.id),!1!==this.variationId&&!this.variationIdExists(this.variationId))return!1;if(Script.isPreview){if(t=Script.getVariationIdToPreviewByExperiment(this),r)return!1;if(!t&&Script.previewExcludeRunning)return!1;this.variationId=t}return this.silent||r||(r=t?" (Preview)":"",System.log("info",1,`Initiated EXPERIMENT "${e.name}"`+r,e.id)),Script.projectData.is_spa&&this.reset(),!0},Experiment.prototype.reset=function(){delete Script.activeExperiments[this.data.id],System.applyResetJs(this),System.applyResetCss(this),this.variationId&&new Variation(this.variationId,!0).reset()},Experiment.prototype.getMetadata=function(){return[1,2,3].reduce((e,t)=>{var r=Project.data?.["metadata_key_exp_"+t];return r&&(e[r]=this.data?.["metadata_"+t]??""),e},{})},Experiment.prototype.shouldNotRun=function(){var e=Script.getVariationIdToPreviewByExperiment(this,!0);return"preview"===this.data.status?!e||!Script.isPreview:!!Script.isPreview&&!e&&Script.previewExcludeRunning},Experiment.prototype.run=function(){Script.activeExperiments[this.data.id]=this.variationId,System.applyCss(this),System.applyJs(this)},Experiment.prototype.environmentsPassed=function(t){var{environments:e=[]}=this.data;return 0===e.length||e.some(e=>new Environment(e).matches(t))},Experiment.prototype.audiencesPassed=function(t=!1){var e,{audiences_match_type:r,audiences:i=[]}=this.data;return Script.isPreview&&"preview"===this.data.status?(System.log("info",3,"Skipping audiences check due to Preview Mode"),!0):(e=e=>new Audience(e).rulesPassed(t),"all"===r?i.every(e):i.some(e))},Experiment.prototype.trafficAllocationPassed=function(){return Math.random()<this.data.traffic_allocation/100},Experiment.prototype.chooseVariation=function(){let t=this.data.id;var e=System.forcedVariations||{},r=Object.keys(e).find(e=>Number(e)===t);if(void 0!==r)return e=Number(e[r]),System.log("info",1,"Forced Variation ID",e),e;var i=this.data.variations||[],a=[];for(let t=i.length-1;0<=t;t--){var{id:s,traffic_allocation:o=0}=i[t];let e=o;for(;e--;)a.push(s)}return a[Math.floor(Math.random()*a.length)]},Experiment.prototype.variationIdExists=function(e){let t=Number(e);return!Number.isNaN(t)&&(this.data?.variations??[]).some(({id:e})=>Number(e)===t)},Experiment.prototype.passesExclusionGroups=function(){var e=this.data.id,t=Project.data.exclusion_groups||[];if(0!==t.length)if(Script.isPreview)System.log("info",2,"Skipping exclusion groups in Preview mode");else{for(var i of t){var{id:i,name:a,exclusion_group_entries:s=[]}=i,o=s.map(e=>e.experiment_id);if(o.includes(e)){System.log("info",2,`Checking exclusion group "${a}"`,i);let t=User.getExperimentsBucket(),r=o.find(e=>t.hasOwnProperty(e)&&0!==t[e]&&Script.carriesExperiment(e));if(!r){var n,l,a=s.filter(({experiment_id:e})=>{var t=Script.getExperimentById(e),e=User.getVariationIdOfExperiment(e);return t&&0!==e&&new Experiment(t,!0).audiencesPassed(!0)}),i=a.reduce((e,t)=>e+(t.traffic||0),0);if(i<=0)continue;let e=Math.random()*i;for({experiment_id:n,traffic:l=0}of a)if((e-=l)<0){r=n;break}}if(r!==e)return!1}}System.log("info",3,"Passed all exclusion groups")}return!0},Variation.prototype.getMetadata=function(){return[1,2,3].reduce((e,t)=>{var r=Project.data?.["metadata_key_var_"+t];return r&&(e[r]=this.data?.["metadata_"+t]??""),e},{})},Variation.prototype.run=function(){this.runCodes(),this.runVisualChanges()},Variation.prototype.runCodes=function(){System.applyCss(this),System.applyJs(this)},Variation.prototype.reset=function(){System.applyResetCss(this),System.applyResetJs(this)},Variation.prototype.runVisualChanges=function(){var e=JSON.parse(this.data.changesets);let s=this.data.id;0!==e.length&&(System.log("info",2,"Applying VisualChanges",e),e.forEach(r=>{let i=[],a=(r.changes.hasOwnProperty("outerHTML")?i.push({attribute:"outerHTML",property:"",value:r.changes.outerHTML}):Object.entries(r.changes).forEach(([r,e])=>{null===e||"object"!=typeof e||Array.isArray(e)?i.push({attribute:r,property:"",value:e}):Object.entries(e).forEach(([e,t])=>{i.push({attribute:r,property:e,value:t})})}),r.changes.hasOwnProperty("extensions")&&Object.keys(r.changes.extensions).forEach(e=>{var t=r.changes.extensions[e];Tools.applyEditorExtension(this.data.id,r.selector,e,t,t.instance)}),["id","className","href","src","innerHTML","outerHTML","innerText"]);Tools.waitForElement(r.selector,(r,e)=>{for(let t of e){let e=t.value;var i;"string"==typeof e&&0===e.length||(a.includes(t.attribute)?("outerHTML"===t.attribute&&(e=e.replace(/^<([a-zA-Z0-9-]+)([^>]*)>/,'<$1$2 data-ablyft-handled="true">')),r.parentNode&&(r[t.attribute]=e)):"style"===t.attribute?r.style[t.property]=e:t.attribute.includes("insertAdjacent")&&(i=Array.from(e).reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0).toString(16),i=`${s}_${t.property}_`+i,document.querySelectorAll(`div[data-ablyft-inserted-uId="${i}"]`).forEach(e=>e.remove()),"insertAdjacentHTML"===t.attribute?r.insertAdjacentHTML(t.property,'<div data-ablyft-inserted-uId="'+i+'">'+e+"</div>"):(r.dataset.ablyftInsertedUid=i,Tools.waitForElement(e,e=>{e.insertAdjacentElement(t.property,r)},t))))}},i)}))},Environment.prototype.matches=function(e=!1){var{rules_js:t="",name:r,id:i}=this.data,t=!t.trim()||System.jsConditionReturnsTrue(t);return!e&&t&&System.log("info",3,`ENVIRONMENT "${r}" is matching`,i),t},Page.prototype.matches=function(e,t){var r=w.location.href,{url_targetings:i=[],rules_js:a=""}=this.data;let s=!1,o=!1,n=!1;0===i.length&&(s=!0);for(let e=0;e<i.length;e++){var l=new Urltargeting(i[e]).matches(r);if(l){if("included"!==l){s=!1;break}s=!0}}return!1!==s&&(o=!0,!t&&a&&""!==a&&(o=System.jsConditionReturnsTrue(a)),n=!(!s||!o)||n)},Page.prototype.isActive=function(){return Script.activePages.includes(this.data.id)},Page.prototype.setActive=function(){this.isActive()||Script.activePages.push(this.data.id)},Page.prototype.setInactive=function(){var e,{id:t,name:r,deactivation_mode:i,experiments:a=[]}=this.data;"persistent"===i?System.log("info",0,`Not deactivating persistent PAGE "${r}"`,t):-1!==(e=Script.activePages.indexOf(t))&&(Script.activePages.splice(e,1),System.log("info",0,`Deactivated PAGE "${r}"`,t),"reset"===i)&&a.forEach(e=>{new Experiment(Script.getExperimentById(e),!0).init()})},Page.prototype.run=function(){let{name:e,id:t,poll_on_rules:r,experiments:i}=this.data;var a;this.isActive()&&!this.matches(!1)?this.setInactive():(a=r?2e3:0,Tools.poll(()=>this.matches(!1),()=>{if(this.isActive())System.log("info",0,`Ignoring triggered PAGE "${e}" because it is already active`,t);else{this.setActive(),System.log("info",0,`Initiated PAGE "${e}"`,t),this.applyGoals();for(let a of i){let i=new Experiment(Script.getExperimentById(a));!i.shouldNotRun()&&i.init()&&(System.log("info",2,"Initiated ENVIRONMENTS LOOKUP"),Tools.poll(()=>i.environmentsPassed(),()=>{System.log("info",2,"Initiated AUDIENCES LOOKUP"),Tools.poll(()=>i.audiencesPassed(),()=>{Tools.check(()=>i.passesExclusionGroups(),()=>{let e=!1;if(!1===i.variationId){var t=i.trafficAllocationPassed();if(i.variationId=t?i.chooseVariation():0,e=t,User.setExperimentToBucket(a,i.variationId),!t||0===i.variationId)return}i.run();let r=new Variation(i.variationId);r.run(),setTimeout(()=>Project.runIntegrations(i,r,e),1)},()=>{System.log("info",3,"Exclusion group not passed"),User.setExperimentToBucket(a,0)})})}))}}},()=>{},a,a))},Page.prototype.applyGoals=function(){let e=this.data.goals;0!==e.length&&Tools.domLoaded(()=>{setTimeout(()=>{e.map(e=>new Goal(Script.getGoalById(e))).filter(e=>"pageview"===e.data.type).forEach(e=>e.trigger())},500)})},Urltargeting.prototype.simplifyUrl=function(e){var t=Tools.parseUrl(e);return e=t.host+t.pathname,this.removeLastSlash(e)},Urltargeting.prototype.removeLastSlash=function(e){return e.endsWith("/")?e.slice(0,-1):e},Urltargeting.prototype.removePreviewParams=function(t){var e=System.urlParamPrefix+"preview",r=System.urlParamPrefix+"qa_token";if(![e,r].some(e=>t.includes(e)))return t;var i=new URL(t,w.location.origin);let a=i.searchParams;return[e,r].forEach(e=>{a.has(e)&&a.delete(e)}),i.search=a.toString(),i.toString()},Urltargeting.prototype.matches=function(e){var{type:t,url_type:r,url:i}=this.data,e=this.removePreviewParams(e);if("simple"===r){if(this.simplifyUrl(e)===this.simplifyUrl(i))return"include"===t?"included":"excluded"}else if("exact"===r){if(this.removeLastSlash(i)===this.removeLastSlash(e))return"include"===t?"included":"excluded"}else if("substring"===r){if(-1!==e.indexOf(i))return"include"===t?"included":"excluded"}else if("regex"===r)if(RegExp(i).test(e))return"include"===t?"included":"excluded";return!1},Audience.prototype.rulesPassed=function(e){var t=System.jsConditionReturnsTrue(this.data.rules_js);return!e&&t&&System.log("info",3,'AUDIENCE "'+this.data.name+'" is matching',this.data.id),t};let GoalStorage={storageKey:System.storagePrefix+"tgoals",add(e){var e=e.data.id,t=Script.getCleanedUserBucketVariationIds(),r=this.getAll(),i=r[e]||[];r[e]=Array.from(new Set([...i,...t])),Storage.set("localStorage",this.storageKey,JSON.stringify(r))},getAll(){var e=Storage.get("localStorage",this.storageKey);return e?JSON.parse(e):{}},getUntriggeredVariationIds(e){var e=e.data.id,t=Script.getCleanedUserBucketVariationIds(),e=this.getAll()[e]||[];let r=new Set(e);return t.filter(e=>!r.has(e))}};function Goal(e){this.className="goal",this.data=e}function Integration(e){this.className="integration",this.data=e}Goal.prototype.trigger=function(e){var t,r,{id:i,name:a,type:s,counting_method:o}=this.data;if(null!=e&&(this.data.value=e),Script.isPreview&&(t="ablyft_pinged_goals",(r=(r=Storage.get("sessionStorage",t,!0))?JSON.parse(r):[]).push({id:i,time:Date.now(),value:e}),Storage.set("sessionStorage",t,JSON.stringify(r),!0)),System.log("info",0,`Triggered GOAL "${a}" (${s})`,i),!Script.goalsEnabled)return!1;("one"!==o||0<GoalStorage.getUntriggeredVariationIds(this).length)&&this.send(),GoalStorage.add(this)},Goal.prototype.send=function(){var e=this.data.counting_method,e="one"===e?GoalStorage.getUntriggeredVariationIds(this):Script.getCleanedUserBucketVariationIds();EventQueue.add(Script.prepareEvent(this,e))},Integration.prototype.runCode=function(project,experiment,variation){if(!project||!experiment||!variation)return!1;let{id:projectId,name:projectName}=project.data,{id:experimentId,name:experimentName}=experiment.data,{id:variationId,name:variationName}=variation.data;try{return eval(this.data.js),"done"}catch(err){return err.message}},Integration.prototype.run=function(t,r,i){if(!Script.goalsEnabled)return!1;let a=this.data.name;let s=`integrInterv_${a.replace(/[^A-Za-z0-9]/g,"")}_`+r.data.id,o=20,n=0,l,e=()=>{var e=this.runCode(t,r,i);return n++,("done"===e||n>=o)&&(clearInterval(l),delete w[s],"done"!==e&&System.log("error",2,`Integration "${a}" did not complete after ${n} attempts:`,e),!0)};return Tools.domLoaded(()=>{System.log("info",1,"Running INTEGRATION",a),w[s]&&clearInterval(w[s]),l=setInterval(e,100),w[s]=l,e()}),!0},Api.init(),Script.init(projectData),EventQueue.init(),Api.handleFormerlyPushedCalls(),Script.main=function(){Project.init(Script.getProjectData()),d.dispatchEvent(new CustomEvent("ablyft_initialized"));let triggers={direct:[],url_change_history:[],url_change_polling:[],dom_change:[],callback:[],polling:[],api:[]},pages=Project.data.pages;pages.forEach(function(e){e=new Page(e);triggers[e.data.trigger].push(e)}),triggers.direct.forEach(function(e){e.run()}),triggers.url_change_history.forEach(function(e){e.run(),Tools.urlChanged("history",()=>{e.run()})}),triggers.url_change_polling.forEach(function(e){e.run(),Tools.urlChanged("polling",()=>{e.run()})}),triggers.dom_change.forEach(function(e){e.run(),Tools.domChanged(()=>{e.run()})}),triggers.callback.forEach(function(page){let activate=function(e){!1===e?page.setInactive():page.run()},pageInfo={id:page.data.id},ablyftTools=Tools;eval("(function(activate, page, ablyftTools){ "+page.data.trigger_js+" })(activate, pageInfo, ablyftTools)")}),Script.formerlyPushedGoals.forEach(e=>{w.ablyft.push(e)}),w.ablyftClickListener||(w.ablyftClickListener=!0,d.addEventListener("click",e=>{let t=e.target;e=Script.getActiveClickGoals();let r=new Set(e.map(e=>String(e.id)));e.filter(e=>t.closest(e.css_selector)).forEach(e=>new Goal(e).trigger());e=t.getAttribute("data-ablyft-clickgoals");e&&e.split(",").forEach(e=>{r.has(e)&&new Goal(Script.getGoalById(e)).trigger()})},!0))},Script.projectData.run_only_on_reinit||Script.run()})(window,document,console);
