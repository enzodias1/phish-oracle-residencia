"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{43882:function(e,t,i){i.d(t,{Z:function(){return Z}});var n=i(52322),a=i(2784),d=i(68545),r=i(4979),o=i(31549),l=i(7231),s=i(98442),u=i(63678),c=i(19832),p=i.n(c);let w=e=>{(0,a.useEffect)(()=>{var t;let i=p()(null===(t=window.embeddedMedia)||void 0===t?void 0:t.api.players(),{}),n=document.querySelectorAll('iframe[title="youtube-embed"]'),a=t=>{if(t.persisted){for(let t in i)i[t].pause(),e(!0);Array.from(n).forEach(e=>{e.contentWindow&&e.contentWindow.postMessage('{"event":"command","func":"stopVideo","args":""}',"*")})}};return window.addEventListener("pageshow",a),()=>window.removeEventListener("pageshow",a)})};var f=i(18932),m=i(23935),b=i(17433),v=i(58412),h=i(83962),g=e=>{let{playlistLabels:t,blocks:i,mediaMetadataModel:n,activeIndex:d=0,onNextOnwardJourneyItemStartsPlaying:r,serviceId:c="",isWntvPrerollEnabled:p=!1,playerPosition:g,isAutoPlayDisabled:y,nextItemAutoPlay:A=!0,isAudio:E,isLiveRadio:S,playerContainerRef:Z,startTime:x=0,onTimeUpdate:j,onPlaybackStarted:k,onPlaybackPaused:P,onPlaybackEnded:T,onUserAutoplaySettingChange:O,includeNextButton:C}=e,[F,L]=(0,a.useState)(0),[$,_]=(0,a.useState)([]),[M,I]=(0,a.useState)(void 0),[N,D]=(0,a.useState)(!0),[R,q]=(0,a.useState)(!1),[K,V]=(0,a.useState)({duration:"",warning:""}),[B,U]=(0,a.useState)(!0),W=(0,f.Z)(),{country:z,type:G="",allowAdvertising:J}=(0,o.Z)(),Y=!y&&["video","indexPage"].includes(G),H=(0,m.Z)(),{isSignedIn:X}=(0,b.Z)(),Q=(0,l.Z)("authentication"),ee=X&&Q&&E,et=(0,l.Z)("toucan-audio"),ei=(0,l.Z)("audio-adverts"),{isSubscriptionAllowed:en}=(0,s.Xe)();return(0,a.useEffect)(()=>{if(!H)return;let e=async()=>{let e;if(c||!z||n||(0,u.P1)(z,i[0])||(U(!1),Y=!1),E&&(Y=!y),!window.dotcom)return;window.dotcom.ads||v.Z.error("dotcom-bootstrap.js has failed to load");let a=()=>new Promise((e,t)=>{let i=!1;window.tp.push(["init",function(){window.tp.api.callApi("/access/check",{rid:"AdFreeAudio"},t=>{var n,a;i=!0,e(null!==(a=null==t?void 0:null===(n=t.access)||void 0===n?void 0:n.granted)&&void 0!==a&&a)})}]),setTimeout(()=>{i||t(Error("AdFreeAudio claim check timed out"))},5e3)}),d=n||(0,u.Ox)(i[0]),o=async()=>{var e,t,i,n;let r=await (null===(i=window)||void 0===i?void 0:null===(t=i.dotcom)||void 0===t?void 0:null===(e=t.ads)||void 0===e?void 0:e.enabled()),o=null===(n=null==d?void 0:d.advertising)||void 0===n||n;if(!r||!(o&&J))return!1;if(E){if(S)return!1;if(en)try{let e=await a();return ei&&!e}catch(e){v.Z.error("areAdsEnabled:",e)}return ei}return!0},l=await o(),s="";c?(s=p&&l&&window.dotcom.ads?await window.dotcom.ads.getAdTag():"",e=(0,u.zN)(c,p&&l,s,H,t[0])):(s=window.dotcom.ads?E?await window.dotcom.ads.getAudioAdTag((null==d?void 0:d.tritonStationId)||""):await window.dotcom.ads.getAdTag():"",e=await (0,u.K$)(d,l,s,Y,A,E,S,C,H,t[0],et)),e.statsObject.playerPosition=g,e.statsObject.playlistLabels={...e.statsObject.playlistLabels,ad_enabled:l,...!c&&!E&&{av_content_duration_range:"sfv"}},e.startTime=x,V((0,u.l7)(e.playlistObject)),i.length>1&&_(await (0,u.YJ)(e,i,l,H,t));let w=window.embeddedMedia.api.player(Z.current,e);w.bind("initialised",()=>{Z.current&&(Z.current.style.visibility="visible")}),w.bind("playing",()=>{D(!1);let e=window.embeddedMedia.api.players();for(let t in e){let i=e[t];i===w||i.paused()||i.pause()}}),w.bind("adsPlugin",e=>{"adStarted"===e.id&&D(!1)}),w.bind("bbc.smp.plugins.ads.event.AdsPluginExternalEvent.ALL_ADS_COMPLETED",()=>{}),w.bind("enterFakeFullscreen",()=>q(!0)),w.bind("exitFakeFullscreen",()=>q(!1)),1===i.length&&w.bind("ended",()=>D(!0)),E&&w.bind("continuousPlayChange",e=>{let{status:t}=e;return null==O?void 0:O(t)}),r&&w.bind("continuousPlay.play",e=>{if(e.index&&e.index!==F){let t=!0;z&&(t=(0,u.P1)(z,i[e.index])),U(t),t||w.pause(),L(e.index),r(e)}}),j&&w.bind("significanttimeupdate",j),ee&&w.bind("significanttimeupdate",e=>(0,h.Sp)(e,i)),k&&w.bind("playing",k),P&&w.bind("pause",P),T&&w.bind("ended",T),T&&w.bind("nextRequested",T),w.bind("previousRequested",()=>{w.currentTime(0)}),w.load(),I(w)};return W&&e().then(),()=>{}},[W,H]),(0,a.useEffect)(()=>{if(d!==F&&M){let e=!0;z&&(e=(0,u.P1)(z,i[d])),U(e),M.loadPlaylist($[d].playlist,{autoplay:e,statsObject:$[d].statsObject}),L(d),V((0,u.l7)($[d].playlist))}},[d]),(0,a.useEffect)(()=>{let e=e=>e.preventDefault();return R&&window.addEventListener("touchmove",e,{passive:!1}),()=>{window.removeEventListener("touchmove",e)}},[R]),w(D),{contentAvailableInTerritory:B,customCtaOptions:K,isCustomCtaVisible:N,isInFakeFullscreen:R,handleOnCustomCTAClick:()=>{M&&M.play(!0),D(!1)}}},y=i(75212),A=i(29462),E=i(46964),S=i(17412),Z=(0,r.Z)(e=>{let{playlistLabels:t,blocks:i=[],mediaMetadataModel:r,activeIndex:s=0,testId:u="",onNextOnwardJourneyItemStartsPlaying:c,serviceId:p="",isWntvPrerollEnabled:w=!1,playerPosition:f,isAutoPlayDisabled:m,nextItemAutoPlay:b,isAudio:v=!1,isLiveRadio:h=!1,onTimeUpdate:S,onPlaybackStarted:Z,onPlaybackPaused:x,onPlaybackEnded:j,onUserAutoplaySettingChange:k,startTime:P=0,includeNextButton:T=!0}=e,{subtype:O}=(0,o.Z)(),C=(0,l.Z)("legacy-article-rendering-logic"),F=(0,a.useRef)(null),L=O===y.Gu.News&&!C,{contentAvailableInTerritory:$,customCtaOptions:_,isCustomCtaVisible:M,handleOnCustomCTAClick:I,isInFakeFullscreen:N}=g({playlistLabels:t,blocks:i,mediaMetadataModel:r,activeIndex:s,testId:u,onNextOnwardJourneyItemStartsPlaying:c,serviceId:p,isWntvPrerollEnabled:w,playerPosition:f,isAutoPlayDisabled:m,nextItemAutoPlay:b,isAudio:v,isLiveRadio:h,playerContainerRef:F,startTime:P,onTimeUpdate:S,onPlaybackStarted:Z,onPlaybackPaused:x,onPlaybackEnded:j,onUserAutoplaySettingChange:k,includeNextButton:T});return(0,n.jsxs)(E.rn,{$isInFakeFullscreen:N,$isAudio:v,$withNegativeMargin:L,children:[!$&&(0,n.jsxs)(E.Ts,{children:[(0,n.jsx)(E.it,{children:A.aD}),(0,n.jsx)(E.V7,{children:A.FA})]}),(0,n.jsx)(E.eA,{ref:F,"data-testid":u,$isAudio:v,style:{visibility:"hidden"}}),!v&&(0,n.jsx)(d.Z,{isVisible:M,onClick:I,..._})]})},e=>{let{blocks:t,serviceId:i="",isAudio:r=!1}=e,o=(0,a.useRef)(null),{handleOnCustomCtaClick:l,isCustomCtaVisible:s}=function(e){let{serviceId:t="",isAudio:i=!1,blocks:n,playerContainerRef:d}=e,[r,o]=(0,a.useState)(!0),[l,s]=(0,a.useState)(),[c]=n,p=(0,f.Z)();return(0,a.useEffect)(()=>{let e=async()=>{let e={page:"",destination:S.q.test,producer:"BBC_STUDIOS"},n=t?(0,u.zN)(t,!1,"",e,{}):await (0,u.K$)((0,u.Ox)(c),!1,"",!1,!0,i,!1,!0,e,{},!0),a=window.embeddedMedia.api.player(d.current,n);a.bind("playing",()=>{o(!1);let e=window.embeddedMedia.api.players();for(let t in e){let i=e[t];i===a||i.paused()||i.pause()}}),a.bind("ended",()=>o(!0)),a.load(),s(a)};p&&e()},[p,i,c,d,t]),{isCustomCtaVisible:r,handleOnCustomCtaClick:()=>{l&&l.play(!0),o(!1)}}}({serviceId:i,isAudio:r,blocks:t,playerContainerRef:o});return(0,n.jsxs)(E.rn,{$isInFakeFullscreen:!1,$isAudio:r,children:[(0,n.jsx)(E.eA,{ref:o,$isAudio:r}),(0,n.jsx)(d.Z,{isVisible:s,onClick:l})]})})},29462:function(e,t,i){i.d(t,{FA:function(){return d},YI:function(){return n},aD:function(){return a}});let n={$type:"mobileFullWidth",$marginBottom:["s","m","m","m","m","m"]},a="There was an error",d="This content is not available in your location."},83962:function(e,t,i){i.d(t,{IK:function(){return o},Sp:function(){return s}});var n=i(58412),a=i(24799);let d={credentials:"include",isLegacyApiEnabled:!0},r="heartbeat";async function o(e){let{isFetchAllowed:t,ids:i=[]}=e,o=null==i?void 0:i.map(e=>({id:e,offset:0}));if(!t||!i.length)return o;let l=new URLSearchParams;i.forEach(e=>l.append("id",e));let s={cache:"no-cache",params:l,method:"GET",paramsHaveIdenticalKeys:i.length>1,...d};try{if(1===i.length){let{data:e}=await (0,a.Z)(r,s);return[e]}{let{data:e}=await (0,a.Z)(r,s);return e}}catch(e){return n.Z.error("Error attempting to get media progress: ",JSON.stringify(e)),o}}let l=(e,t)=>{if(Math.floor(e.currentTime)%30!=0)return!1;let i=t[0].model.blocks[0].model.blocks[0].model,n=i.versions[0],a=new URLSearchParams;return a.append("action","started"),a.append("versionPid",n.versionId),a.append("offset",Math.round(e.currentTime).toString()),a.append("id",i.id),a},s=async(e,t)=>{try{let i=l(e,t);if(!1===i)return;await (0,a.Z)(r,{cache:"no-cache",params:i,method:"POST",...d})}catch(e){n.Z.error("Error attempting to set media progress: ",e)}}}}]);