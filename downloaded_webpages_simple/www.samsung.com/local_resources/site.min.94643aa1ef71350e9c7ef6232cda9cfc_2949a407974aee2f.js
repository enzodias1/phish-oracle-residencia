var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(d){return d.raw=d};$jscomp.createTemplateTagFirstArgWithRaw=function(d,e){d.raw=e;return d};
(function(){function d(){e(l.section).target.forEach(function(a){b.instances.has(a)||new b(a)})}var e=window.sg.common.$q,k=window.sg.common.utils,l={section:".co76-feature-kv"},m="undefined"!==typeof digitalData&&digitalData&&digitalData.page&&digitalData.page.pageInfo&&digitalData.page.pageInfo.pageTrack||"page track",b=function(a){this.selector={innerEl:".co76-feature-kv__inner",contentsEl:".co76-feature-kv__contents",textWrapEl:".co76-feature-kv__text-wrap",ctaWrapEl:".co76-feature-kv__cta-wrap",
bgEl:".co76-feature-kv__background-media-wrap",imageEl:".co76-feature-kv__image",ctaEl:".cta",videoEl:".video",videoPlayer:".video figure",controlWrapEl:".co76-feature-kv__btn-wrap",controlEl:".co76-feature-kv__btn",popupVideoCta:".co76-feature-kv__cta--layer-video",popupVideo:".popup-video",clickableState:'[data-js-action\x3d"co76ClickableState"]'};this.el={document:e(document),window:e(window),section:e(a)};this.useVideoDefaultImage="L"===k.getCookie("__COM_SPEED");this.popupVideo=window.sg.common.popupVideo;
this.isLayerVideoPlay=!1;this.classes={isAnimate:"co76-feature-kv--animate",isPlaying:"co76-feature-kv--playing",isPause:"co76-feature-kv--pause",isLoop:"co76-feature-kv--loop",isPreviewImageShow:"preview-image--show",controlWrapElShow:"co76-feature-kv__btn-wrap--show"};this.deviceSize=k.getCurrentDevice();this.focusTargetEl={};this.clickState="play";this.handler={ended:this.endedMotion.bind(this),handleScroll:this.handleScroll.bind(this),handleVideoPlay:this.handleVideoPlay.bind(this),handleKvVideoPlay:this.handleKvVideoPlay.bind(this),
handleLoadedData:this.handleLoadedData.bind(this),handleResize:this.handleResize.bind(this),handleClickClickableState:this.handleClickClickableState.bind(this)};b.instances.set(a,this);this.init()};b.prototype.init=function(){this.setElements();this.initOpts();this.initTagging();this.setCloneCtaWrap();this.setVideoStatus();this.setClickableStateHandler();this.setVideoState();this.bindEvents();this.handleScroll()};b.prototype.reInit=function(){d()};b.prototype.setElements=function(){this.el.innerEl=
this.el.section.find(this.selector.innerEl);this.el.contentsEl=this.el.section.find(this.selector.contentsEl);this.el.textWrapEl=this.el.section.find(this.selector.textWrapEl);this.el.bgEl=this.el.section.find(this.selector.bgEl);this.el.ctaWrapEl=this.el.section.find(this.selector.ctaWrapEl);this.el.ctaEl=this.el.section.find(this.selector.ctaEl);this.el.popupVideo=this.el.section.find(this.selector.popupVideo);this.el.clickableState=this.el.section.find(this.selector.clickableState);this.el.bgEl.find(this.selector.imageEl).target.length&&
(this.el.imageEl=this.el.section.find(this.selector.imageEl));this.el.bgEl.find(this.selector.videoEl).target.length&&(this.el.previewImgEl=this.el.bgEl.find(this.selector.imageEl),this.el.videoEl=this.el.innerEl.find(this.selector.videoEl),this.el.videoPlayer=this.el.section.find(this.selector.videoPlayer),this.el.controlWrapEl=this.el.section.find(this.selector.controlWrapEl),this.el.controlEl=this.el.section.find(this.selector.controlEl))};b.prototype.initOpts=function(){this.animateData={background:{element:this.el.section,
visible:.5*this.el.section.offset().height},text:{element:this.el.textWrapEl,visible:this.el.textWrapEl.offset().height}};this.videoData={video:{element:this.el.section}}};b.prototype.bindEvents=function(){this.el.document.off("scroll",this.handler.handleScroll).on("scroll",this.handler.handleScroll);var a=this.el.innerEl.find(this.selector.popupVideoCta);if(0<a.target.length)a.off("click",this.handler.handleVideoPlay).on("click",this.handler.handleVideoPlay);this.el.window.off("resize",this.handler.handleResize).on("resize",
this.handler.handleResize);this.el.videoEl&&(this.controlHiddenEl=this.el.controlEl.find(".hidden"),this.video=this.el.videoEl.find("video"),this.video.off("ended",this.handler.ended).on("ended",this.handler.ended),this.video.off("loadeddata",this.handler.handleLoadedData).on("loadeddata",this.handler.handleLoadedData),this.el.controlEl.off("click",this.handler.handleKvVideoPlay).on("click",this.handler.handleKvVideoPlay))};b.prototype.setVideoState=function(){this.el.bgEl.removeClass("co76-feature-kv__background-media-wrap--unloaded");
this.useVideoDefaultImage&&this.el.videoEl&&(this.el.previewImgEl.remove(),this.el.videoPlayer.remove(),this.el.controlWrapEl.remove(),this.el.bgEl.addClass("co76-feature-kv__background-media-wrap--unloaded"));!this.useVideoDefaultImage&&this.el.videoEl&&this.el.controlWrapEl.addClass(this.classes.controlWrapElShow)};b.prototype.handleLoadedData=function(){this.el.videoEl&&(this.controlHiddenEl=this.el.controlEl.find(".hidden"),this.controlHiddenEl.target[0].innerHTML="pause",this.setControlTagging())};
b.prototype.handleResize=function(){var a=k.getCurrentDevice();this.handleScroll();this.deviceSize!==a&&this.el.videoEl&&!this.useVideoDefaultImage&&(this.el.bgEl.hasClass(this.classes.isPreviewImageShow)&&this.el.bgEl.removeClass(this.classes.isPreviewImageShow),this.videoPlay());this.deviceSize=a};b.prototype.videoPause=function(){this.video.target[0].pause();this.controlHiddenEl.target[0].innerHTML="play";this.el.bgEl.hasClass(this.classes.isPlaying)&&this.el.bgEl.removeClass(this.classes.isPlaying);
this.el.bgEl.addClass(this.classes.isPause)};b.prototype.videoPlay=function(){this.video.target[0].play();this.controlHiddenEl.target[0].innerHTML="pause";this.el.bgEl.hasClass(this.classes.isPause)&&this.el.bgEl.removeClass(this.classes.isPause);this.el.bgEl.addClass(this.classes.isPlaying)};b.prototype.handleKvVideoPlay=function(a){var c=this;this.video.target[0].ended?(this.clickState="play",this.hideEndImage(),this.videoPlay()):this.video.target[0].paused?(this.clickState="play",this.hideEndImage(),
this.videoPlay()):(this.clickState="pause",this.videoPause());a.stopPropagation();window.setTimeout(function(){c.setControlTagging()},450)};b.prototype.endedMotion=function(){this.videoPause();this.setControlTagging();this.showEndImage()};b.prototype.showEndImage=function(){this.el.bgEl.addClass(this.classes.isPreviewImageShow)};b.prototype.hideEndImage=function(){this.el.bgEl.removeClass(this.classes.isPreviewImageShow)};b.prototype.initTagging=function(){var a=this;this.gbmTagging=this.el.innerEl.attr("data-gbm-value")||
"";this.headlineTagging=this.el.innerEl.attr("data-headline-text")||"";this.controlTagging="feature kv:"+this.gbmTagging+":"+this.headlineTagging+":";this.el.ctaWrapEl.find(".cta").target.forEach(function(c){var f=e(c).attr("data-title")||"";c.setAttribute("an-la","feature kv:"+a.gbmTagging+":"+a.headlineTagging+":"+f)})};b.prototype.setControlTagging=function(){this.el.controlEl&&this.el.controlEl.attr("an-la",""+this.controlTagging+("play"===this.controlHiddenEl.target[0].innerHTML?"play video":
"stop video"))};b.prototype.handleVideoPlay=function(){var a=this.el.innerEl.find(this.selector.popupVideoCta);this.popupVideo.open(this.el.popupVideo.target[0],0,a.target[0])};b.prototype.handleScroll=function(){var a=this;Object.keys(this.animateData).forEach(function(c){c=a.animateData[c];a.animateScroll(c.element.target[0],c.visible)});this.el.videoEl&&Object.keys(this.videoData).forEach(function(c){a.videoScroll(a.videoData[c].element.target[0])})};b.prototype.setVideoStatus=function(){this.el.videoEl&&
(this.el.videoEl.hasClass("video--loop")&&this.el.bgEl.addClass(this.classes.isLoop),this.el.bgEl.addClass(this.classes.isPlaying))};b.prototype.animateScroll=function(a,c){var f=window.scrollY+c;c=window.scrollY+window.innerHeight-c;var g=a.getBoundingClientRect().top+window.scrollY,h=a.getBoundingClientRect().bottom+window.scrollY,n=!a.classList.contains(this.classes.isAnimate);(c>g&&f<=g||f<h&&c>h||f<g&&c>h||f>g&&c<h)&&n&&a.classList.add(this.classes.isAnimate)};b.prototype.videoScroll=function(a){if(this.el.videoPlayer.target.length){var c=
window.scrollY,f=a.getBoundingClientRect().top-window.innerHeight+window.scrollY;a=a.getBoundingClientRect().bottom+window.scrollY;f<=c&&c<=a?this.el.bgEl.hasClass(this.classes.isPreviewImageShow)||"play"!==this.clickState||this.videoPlay():this.el.bgEl.hasClass(this.classes.isPreviewImageShow)||"play"!==this.clickState||this.videoPause();this.setControlTagging()}};b.prototype.setClickableStateHandler=function(){if(this.el.clickableState.target.length){var a=this.el.section.find(".url-to-kv, .cta--clickable-state").target;
a.length?(this.setTagging(this.el.section.target[0]),(a=a[0].getAttribute("aria-label"))&&this.el.clickableState.attr("aria-label",a),this.el.clickableState.off("click").on("click",this.handler.handleClickClickableState)):this.el.clickableState.remove()}};b.prototype.handleClickClickableState=function(){(this.el.section.find(".co76-feature-kv__cta-wrap-clone .url-to-kv").target[0]||this.el.section.find(".cta--clickable-state").target[0]).click()};b.prototype.setTagging=function(a){a.querySelector(".cta.url-to-kv")&&
(a=a.querySelector(".co76-feature-kv__cta-wrap-clone .cta.url-to-kv"),a.setAttribute("an-tr","co76_feature kv-"+m+"-banner click-homecontent_click"),a.setAttribute("an-la","feature kv:"+this.gbmTagging+":"+this.headlineTagging+":banner click"))};b.prototype.setCloneCtaWrap=function(){if(this.el.innerEl.find(".co76-feature-kv__cta-wrap").target.length){var a=this.el.innerEl.target[0].querySelector(".co76-feature-kv__cta-wrap").cloneNode(!0);a.classList.remove("co76-feature-kv__cta-wrap");a.classList.add("co76-feature-kv__cta-wrap-clone");
this.el.innerEl.target[0].querySelector(".co76-feature-kv__text-wrap").append(a)}};b.instances=new WeakMap;window.sg.components.FeatureKV={init:d,reInit:function(){e(l.section).target.forEach(function(a){b.instances.has(a)?b.instances.get(a).reInit():new b(a)})}};e.ready(d)})();